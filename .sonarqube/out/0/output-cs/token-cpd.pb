–Å
zC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\AdvancedTaskController.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
AdvancedTask' 3
{ 
[ 
ApiExplorerSettings 
( 
	IgnoreApi "
=# $
true% )
)) *
]* +
[ 
	Authorize 
( 
Policy 
= 
	Constants !
.! "

PolicyName" ,
), -
]- .
public 

class "
AdvancedTaskController '
:( )

Controller* 4
{ 
private   
readonly   
IApprovalRepository   ,
_approvalRepository  - @
;  @ A
private!! 
readonly!! 
	IUIHelper!! "
_helper!!# *
;!!* +
private"" 
readonly"" 
IContentRepository"" +
_contentRepository"", >
;""> ?
private## 
readonly## "
IContentTypeRepository## /"
_contentTypeRepository##0 F
;##F G
private$$ 
readonly$$  
INotificationHandler$$ - 
_notificationHandler$$. B
;$$B C
private%% 
readonly%% 
IApprovalEngine%% (
_approvalEngine%%) 8
;%%8 9
private&& 
readonly&& 
LocalizationService&& , 
_localizationService&&- A
;&&A B
private'' 
readonly'' 
IChangeTaskHelper'' *
_changeTaskHelper''+ <
;''< =
private)) 
readonly)) %
ILanguageBranchRepository)) 2%
_languageBranchRepository))3 L
;))L M
private** 
readonly** &
AdvancedTaskManagerOptions** 3
_configuration**4 B
;**B C
private,, 
readonly,, 
ILogger,,  
_logger,,! (
;,,( )
private-- 
const-- 
string-- /
#ContentApprovalDeadlinePropertyName-- @
=--A B
$str--C `
;--` a
public// "
AdvancedTaskController// %
(//% &
IApprovalRepository//& 9
approvalRepository//: L
,//L M
IContentRepository//N `
contentRepository//a r
,//r s#
IContentTypeRepository	//t ä#
contentTypeRepository
//ã †
,
//† °
IApprovalEngine
//¢ ±
approvalEngine
//≤ ¿
,
//¿ ¡!
LocalizationService
//¬ ’!
localizationService
//÷ È
,
//È Í
IChangeTaskHelper
//Î ¸
changeTaskHelper
//˝ ç
,
//ç é
	IUIHelper
//è ò
helper
//ô ü
,
//ü †'
ILanguageBranchRepository
//° ∫&
languageBranchRepository
//ª ”
,
//” ‘
IOptions
//’ ›
<
//› ﬁ(
AdvancedTaskManagerOptions
//ﬁ ¯
>
//¯ ˘
options
//˙ Å
,
//Å Ç"
INotificationHandler
//É ó!
notificationHandler
//ò ´
)
//´ ¨
{00 	
_approvalRepository11 
=11  !
approvalRepository11" 4
;114 5
_contentRepository22 
=22  
contentRepository22! 2
;222 3"
_contentTypeRepository33 "
=33# $!
contentTypeRepository33% :
;33: ;
_approvalEngine44 
=44 
approvalEngine44 ,
;44, - 
_localizationService55  
=55! "
localizationService55# 6
;556 7
_changeTaskHelper66 
=66 
changeTaskHelper66  0
;660 1
_helper77 
=77 
helper77 
;77 %
_languageBranchRepository99 %
=99& '$
languageBranchRepository99( @
;99@ A 
_notificationHandler::  
=::! "
notificationHandler::# 6
;::6 7
_configuration;; 
=;; 
options;; $
.;;$ %
Value;;% *
;;;* +
_logger<< 
=<< 

LogManager<<  
.<<  !
	GetLogger<<! *
(<<* +
typeof<<+ 1
(<<1 2"
AdvancedTaskController<<2 H
)<<H I
)<<I J
;<<J K
}== 	
public?? 
async?? 
Task?? 
<?? 
IActionResult?? '
>??' (
Index??) .
(??. /
int??/ 2
???2 3
page??4 8
,??8 9
string??: @
language??A I
)??I J
{@@ 	
varAA 

assembliesAA 
=AA 
	AppDomainAA &
.AA& '
CurrentDomainAA' 4
.AA4 5
GetAssembliesAA5 B
(AAB C
)AAC D
.AAD E
WhereAAE J
(AAJ K
aAAK L
=>AAM O
!AAP Q
stringAAQ W
.AAW X
IsNullOrEmptyAAX e
(AAe f
aAAf g
.AAg h
FullNameAAh p
)AAp q
&&AAr t
aAAu v
.AAv w
FullNameAAw 
.	AA Ä
Contains
AAÄ à
(
AAà â
$str
AAâ £
)
AA£ §
)
AA§ •
;
AA• ¶
ifCC 
(CC 

assembliesCC 
.CC 
AnyCC 
(CC 
)CC  
)CC  !
{DD 
ViewBagEE 
.EE 
ChangeApprovalEE &
=EE' (
trueEE) -
;EE- .
}FF 
varHH 
	viewModelHH 
=HH 
newHH %
AdvancedTaskIndexViewDataHH  9
(HH9 :
LanguageBranchesHH: J
(HHJ K
languageHHK S
)HHS T
,HHT U
_configurationHHV d
)HHd e
{II 
QueryStringJJ 
=JJ 
HttpContextJJ )
.JJ) *
RequestJJ* 1
.JJ1 2
QueryStringJJ2 =
.JJ= >
ToStringJJ> F
(JJF G
)JJG H
,JJH I

PageNumberKK 
=KK 
pageKK !
??KK" $
$numKK% &
}LL 
;LL 
awaitNN 
ChangeApprovalModelNN %
(NN% &
	viewModelNN& /
)NN/ 0
;NN0 1
returnPP 
ViewPP 
(PP 
	viewModelPP !
)PP! "
;PP" #
}QQ 	
privateTT 
asyncTT 
TaskTT 
ChangeApprovalModelTT .
(TT. /%
AdvancedTaskIndexViewDataTT/ H
	viewModelTTI R
)TTR S
{UU 	
ViewBagVV 
.VV 
PageVV 
=VV 
$strVV ,
;VV, -
varXX 
contentTaskListXX 
=XX  !
awaitXX" '
GetContentTasksXX( 7
(XX7 8
	viewModelXX8 A
)XXA B
;XXB C
	viewModelYY 
.YY 
ContentTaskListYY %
=YY& '
contentTaskListYY( 7
;YY7 8
var[[ 
count[[ 
=[[ 
contentTaskList[[ '
.[[' (
Count[[( -
([[- .
x[[. /
=>[[0 2
x[[3 4
.[[4 5
CanUserPublish[[5 C
)[[C D
;[[D E
if\\ 
(\\ 
count\\ 
!=\\ 
$num\\ 
)\\ 
{]] 
	viewModel^^ 
.^^ 
HasPublishAccess^^ *
=^^+ ,
true^^- 1
;^^1 2
}__ 
}`` 	
[bb 	
HttpGetbb	 
]bb 
publiccc 
asynccc 
Taskcc 
<cc 
IActionResultcc '
>cc' (
ChangeApprovalcc) 7
(cc7 8
intcc8 ;
?cc; <
pagecc= A
)ccA B
{dd 	
varee 
	viewModelee 
=ee 
newee %
AdvancedTaskIndexViewDataee  9
(ee9 :
LanguageBranchesee: J
(eeJ K
stringeeK Q
.eeQ R
EmptyeeR W
)eeW X
,eeX Y
_configurationeeZ h
)eeh i
{ff 
QueryStringgg 
=gg 
HttpContextgg )
.gg) *
Requestgg* 1
.gg1 2
QueryStringgg2 =
.gg= >
ToStringgg> F
(ggF G
)ggG H
,ggH I

PageNumberhh 
=hh 
pagehh !
??hh" $
$numhh% &
}ii 
;ii 
ViewBagkk 
.kk 
Pagekk 
=kk 
$strkk +
;kk+ ,
varmm 

assembliesmm 
=mm 
	AppDomainmm &
.mm& '
CurrentDomainmm' 4
.mm4 5
GetAssembliesmm5 B
(mmB C
)mmC D
.mmD E
WheremmE J
(mmJ K
ammK L
=>mmM O
!mmP Q
stringmmQ W
.mmW X
IsNullOrEmptymmX e
(mme f
ammf g
.mmg h
FullNamemmh p
)mmp q
&&mmr t
ammu v
.mmv w
FullNamemmw 
.	mm Ä
Contains
mmÄ à
(
mmà â
$str
mmâ £
)
mm£ §
)
mm§ •
;
mm• ¶
ifoo 
(oo 
!oo 

assembliesoo 
.oo 
Anyoo 
(oo  
)oo  !
)oo! "
{pp 
varrr %
deleteChangeApprovalTasksrr -
=rr. /
_configurationrr0 >
.rr> ?%
DeleteChangeApprovalTasksrr? X
;rrX Y
ifss 
(ss %
deleteChangeApprovalTasksss -
)ss- .
{tt 
varuu 
changeTasksuu #
=uu$ %
awaituu& +"
GetChangeApprovalTasksuu, B
(uuB C
	viewModeluuC L
)uuL M
;uuM N
varvv 
idsvv 
=vv 
changeTasksvv )
.vv) *
Selectvv* 0
(vv0 1
contentTaskvv1 <
=>vv= ?
contentTaskvv@ K
.vvK L

ApprovalIdvvL V
)vvV W
.vvW X
ToListvvX ^
(vv^ _
)vv_ `
;vv` a
awaitww 

AbortTasksww $
(ww$ %
idsww% (
)ww( )
;ww) *
}xx 
awaitzz 
ChangeApprovalModelzz )
(zz) *
	viewModelzz* 3
)zz3 4
;zz4 5
return{{ 
View{{ 
({{ 
$str{{ #
,{{# $
	viewModel{{% .
){{. /
;{{/ 0
}|| 
ViewBag~~ 
.~~ 
ChangeApproval~~ "
=~~# $
true~~% )
;~~) *
var 
approvalTasks 
= 
await  %"
GetChangeApprovalTasks& <
(< =
	viewModel= F
)F G
;G H
	viewModel
ÄÄ 
.
ÄÄ 
ContentTaskList
ÄÄ %
=
ÄÄ& '
approvalTasks
ÄÄ( 5
;
ÄÄ5 6
return
ÇÇ 
View
ÇÇ 
(
ÇÇ 
	viewModel
ÇÇ !
)
ÇÇ! "
;
ÇÇ" #
}
ÉÉ 	
[
ÖÖ 	
HttpPost
ÖÖ	 
]
ÖÖ 
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
<
ÜÜ 
IActionResult
ÜÜ '
>
ÜÜ' (!
ApproveContentTasks
ÜÜ) <
(
ÜÜ< =
[
ÜÜ= >
FromBody
ÜÜ> F
]
ÜÜF G
ApprovalData
ÜÜH T
approvalData
ÜÜU a
)
ÜÜa b
{
áá 	
ViewBag
àà 
.
àà 
Page
àà 
=
àà 
$str
àà ,
;
àà, -
if
ââ 
(
ââ 
approvalData
ââ 
!=
ââ 
null
ââ  $
&&
ââ% '
!
ââ( )
string
ââ) /
.
ââ/ 0
IsNullOrEmpty
ââ0 =
(
ââ= >
approvalData
ââ> J
.
ââJ K

TaskValues
ââK U
)
ââU V
)
ââV W
{
ää 
if
ãã 
(
ãã 
string
ãã 
.
ãã 
IsNullOrEmpty
ãã (
(
ãã( )
approvalData
ãã) 5
.
ãã5 6
ApprovalComment
ãã6 E
)
ããE F
)
ããF G
{
åå 
approvalData
çç  
.
çç  !
ApprovalComment
çç! 0
=
çç1 2
$str
çç3 [
;
çç[ \
}
éé 
await
êê 
ApproveContent
êê $
(
êê$ %
approvalData
êê% 1
.
êê1 2

TaskValues
êê2 <
,
êê< =
approvalData
êê> J
.
êêJ K
ApprovalComment
êêK Z
,
êêZ [
approvalData
êê\ h
.
êêh i
PublishContent
êêi w
)
êêw x
;
êêx y
}
ëë 
return
íí 
Json
íí 
(
íí 
$str
íí 
)
íí 
;
íí 
}
ìì 	
private
ïï 
async
ïï 
Task
ïï 
<
ïï 
List
ïï 
<
ïï  
ContentTask
ïï  +
>
ïï+ ,
>
ïï, -
GetContentTasks
ïï. =
(
ïï= >'
AdvancedTaskIndexViewData
ïï> W
model
ïïX ]
)
ïï] ^
{
ññ 	
var
óó 
selectedLanguage
óó  
=
óó! "
model
óó# (
.
óó( ) 
LanguageBranchList
óó) ;
.
óó; <
FirstOrDefault
óó< J
(
óóJ K
x
óóK L
=>
óóM O
x
óóP Q
.
óóQ R
Selected
óóR Z
)
óóZ [
;
óó[ \
if
ôô 
(
ôô 
selectedLanguage
ôô  
?
ôô  !
.
ôô! "
Language
ôô" *
!=
ôô+ -
null
ôô. 2
)
ôô2 3
{
öö 
var
õõ 
query
õõ 
=
õõ 
new
õõ 
ApprovalQuery
õõ  -
{
úú 
Status
ùù 
=
ùù 
ApprovalStatus
ùù +
.
ùù+ ,
InReview
ùù, 4
,
ùù4 5
Language
ûû 
=
ûû 
new
ûû "
CultureInfo
ûû# .
(
ûû. /
selectedLanguage
ûû/ ?
.
ûû? @
Language
ûû@ H
.
ûûH I

LanguageID
ûûI S
)
ûûS T
,
ûûT U
	Reference
üü 
=
üü 
new
üü  #
Uri
üü$ '
(
üü' (
$str
üü( 2
)
üü2 3
,
üü3 4
}
†† 
;
†† 
var
££ 
roles
££ 
=
££ 
await
££ !
_helper
££" )
.
££) *
GetUserRoles
££* 6
(
££6 7
)
££7 8
;
££8 9
if
§§ 
(
§§ 
!
§§ 
roles
§§ 
.
§§ 
Contains
§§ #
(
§§# $
Roles
§§$ )
.
§§) *
Administrators
§§* 8
)
§§8 9
&&
§§: <
!
§§= >
roles
§§> C
.
§§C D
Contains
§§D L
(
§§L M
Roles
§§M R
.
§§R S
	WebAdmins
§§S \
)
§§\ ]
&&
§§^ `
!
•• 
roles
•• 
.
•• 
Contains
•• #
(
••# $
Roles
••$ )
.
••) *
	CmsAdmins
••* 3
)
••3 4
)
••4 5
{
¶¶ 
query
ßß 
.
ßß 
Username
ßß "
=
ßß# $
PrincipalAccessor
ßß% 6
.
ßß6 7
Current
ßß7 >
.
ßß> ?
Identity
ßß? G
?
ßßG H
.
ßßH I
Name
ßßI M
;
ßßM N
}
®® 
var
™™ 
list
™™ 
=
™™ 
await
™™  !
_approvalRepository
™™! 4
.
™™4 5
	ListAsync
™™5 >
(
™™> ?
query
™™? D
,
™™D E
(
™™F G
model
™™G L
.
™™L M

PageNumber
™™M W
-
™™X Y
$num
™™Z [
)
™™[ \
*
™™] ^
model
™™_ d
.
™™d e
PageSize
™™e m
,
™™m n
model
™™o t
.
™™t u
PageSize
™™u }
)
™™} ~
;
™™~ 
model
´´ 
.
´´ 
TotalItemsCount
´´ %
=
´´& '
Convert
´´( /
.
´´/ 0
ToInt32
´´0 7
(
´´7 8
list
´´8 <
.
´´< =

TotalCount
´´= G
)
´´G H
;
´´H I
var
≠≠ 
taskList
≠≠ 
=
≠≠ 
new
≠≠ "
List
≠≠# '
<
≠≠' (
ContentTask
≠≠( 3
>
≠≠3 4
(
≠≠4 5
)
≠≠5 6
;
≠≠6 7
foreach
ØØ 
(
ØØ 
var
ØØ 
task
ØØ !
in
ØØ" $
list
ØØ% )
.
ØØ) *
PagedResult
ØØ* 5
)
ØØ5 6
{
∞∞ 
var
±± 
id
±± 
=
±± 
task
±± !
.
±±! "
ID
±±" $
.
±±$ %
ToString
±±% -
(
±±- .
)
±±. /
;
±±/ 0
var
≥≥ 

customTask
≥≥ "
=
≥≥# $
new
≥≥% (
ContentTask
≥≥) 4
{
¥¥ 

ApprovalId
µµ "
=
µµ# $
task
µµ% )
.
µµ) *
ID
µµ* ,
,
µµ, -
DateTime
∂∂  
=
∂∂! "
task
∂∂# '
.
∂∂' (
ActiveStepStarted
∂∂( 9
,
∂∂9 :
	StartedBy
∑∑ !
=
∑∑" #
task
∑∑$ (
.
∑∑( )
	StartedBy
∑∑) 2
}
∏∏ 
;
∏∏ 
if
∫∫ 
(
∫∫ 
task
∫∫ 
is
∫∫ 
ContentApproval
∫∫  /
approval
∫∫0 8
)
∫∫8 9
{
ªª  
_contentRepository
ºº *
.
ºº* +
TryGet
ºº+ 1
(
ºº1 2
approval
ºº2 :
.
ºº: ;
ContentLink
ºº; F
,
ººF G
out
ººH K
IContent
ººL T
content
ººU \
)
ºº\ ]
;
ºº] ^
if
ææ 
(
ææ 
content
ææ #
!=
ææ$ &
null
ææ' +
)
ææ+ ,
{
øø 

customTask
¿¿ &
.
¿¿& '
URL
¿¿' *
=
¿¿+ ,
approval
¿¿- 5
.
¿¿5 6
ContentLink
¿¿6 A
.
¿¿A B

GetEditUrl
¿¿B L
(
¿¿L M
selectedLanguage
¿¿M ]
.
¿¿] ^
Language
¿¿^ f
.
¿¿f g

LanguageID
¿¿g q
)
¿¿q r
;
¿¿r s
id
¡¡ 
=
¡¡  
content
¡¡! (
.
¡¡( )
ContentLink
¡¡) 4
.
¡¡4 5
ID
¡¡5 7
.
¡¡7 8
ToString
¡¡8 @
(
¡¡@ A
)
¡¡A B
;
¡¡B C
var
¬¬ 
canUserPublish
¬¬  .
=
¬¬/ 0
_helper
¬¬1 8
.
¬¬8 9
CanUserPublish
¬¬9 G
(
¬¬G H
content
¬¬H O
)
¬¬O P
;
¬¬P Q

customTask
ƒƒ &
.
ƒƒ& '
CanUserPublish
ƒƒ' 5
=
ƒƒ6 7
canUserPublish
ƒƒ8 F
;
ƒƒF G

customTask
≈≈ &
.
≈≈& '
ContentReference
≈≈' 7
=
≈≈8 9
content
≈≈: A
.
≈≈A B
ContentLink
≈≈B M
;
≈≈M N

customTask
∆∆ &
.
∆∆& '
ContentName
∆∆' 2
=
∆∆3 4
content
∆∆5 <
.
∆∆< =
Name
∆∆= A
;
∆∆A B

customTask
»» &
.
»»& '
ContentType
»»' 2
=
»»3 4
GetTypeContent
»»5 C
(
»»C D
content
»»D K
)
»»K L
;
»»L M
if
   
(
    
content
    '
is
  ( *
PageData
  + 3
)
  3 4
{
ÀÀ 

customTask
ÃÃ  *
.
ÃÃ* +
Type
ÃÃ+ /
=
ÃÃ0 1
$str
ÃÃ2 8
;
ÃÃ8 9

customTask
ÕÕ  *
.
ÕÕ* +
ContentIcon
ÕÕ+ 6
=
ÕÕ7 8
$str
ÕÕ9 D
;
ÕÕD E
}
ŒŒ 
else
œœ  
if
œœ! #
(
œœ$ %
content
œœ% ,
is
œœ- /
	BlockData
œœ0 9
)
œœ9 :
{
–– 

customTask
——  *
.
——* +
Type
——+ /
=
——0 1
$str
——2 9
;
——9 :

customTask
““  *
.
““* +
ContentIcon
““+ 6
=
““7 8
$str
““9 D
;
““D E
if
‘‘  "
(
‘‘# $
!
‘‘$ %
string
‘‘% +
.
‘‘+ , 
IsNullOrWhiteSpace
‘‘, >
(
‘‘> ?

customTask
‘‘? I
.
‘‘I J
ContentType
‘‘J U
)
‘‘U V
&&
‘‘W Y

customTask
‘‘Z d
.
‘‘d e
ContentType
‘‘e p
.
‘‘p q
Equals
‘‘q w
(
‘‘w x
$str‘‘x à
)‘‘à â
)‘‘â ä
{
’’  !

customTask
÷÷$ .
.
÷÷. /
Type
÷÷/ 3
=
÷÷4 5
$str
÷÷6 <
;
÷÷< =

customTask
◊◊$ .
.
◊◊. /
ContentIcon
◊◊/ :
=
◊◊; <
$str
◊◊= C
;
◊◊C D
}
ÿÿ  !
}
ŸŸ 
else
⁄⁄  
if
⁄⁄! #
(
⁄⁄$ %
content
⁄⁄% ,
is
⁄⁄- /
	ImageData
⁄⁄0 9
)
⁄⁄9 :
{
€€ 

customTask
‹‹  *
.
‹‹* +
Type
‹‹+ /
=
‹‹0 1
$str
‹‹2 9
;
‹‹9 :

customTask
››  *
.
››* +
ContentIcon
››+ 6
=
››7 8
$str
››9 @
;
››@ A
}
ﬁﬁ 
else
ﬂﬂ  
if
ﬂﬂ! #
(
ﬂﬂ$ %
content
ﬂﬂ% ,
is
ﬂﬂ- /
	MediaData
ﬂﬂ0 9
)
ﬂﬂ9 :
{
‡‡ 

customTask
··  *
.
··* +
Type
··+ /
=
··0 1
$str
··2 9
;
··9 :

customTask
‚‚  *
.
‚‚* +
ContentIcon
‚‚+ 6
=
‚‚7 8
$str
‚‚9 B
;
‚‚B C
if
‰‰  "
(
‰‰# $
!
‰‰$ %
string
‰‰% +
.
‰‰+ , 
IsNullOrWhiteSpace
‰‰, >
(
‰‰> ?

customTask
‰‰? I
.
‰‰I J
ContentType
‰‰J U
)
‰‰U V
&&
‰‰W Y

customTask
‰‰Z d
.
‰‰d e
ContentType
‰‰e p
.
‰‰p q
Equals
‰‰q w
(
‰‰w x
$str
‰‰x 
)‰‰ Ä
)‰‰Ä Å
{
ÂÂ  !

customTask
ÊÊ$ .
.
ÊÊ. /
Type
ÊÊ/ 3
=
ÊÊ4 5
$str
ÊÊ6 =
;
ÊÊ= >

customTask
ÁÁ$ .
.
ÁÁ. /
ContentIcon
ÁÁ/ :
=
ÁÁ; <
$str
ÁÁ= C
;
ÁÁC D
}
ËË  !
}
ÈÈ 
var
ÎÎ +
enableContentApprovalDeadline
ÎÎ  =
=
ÎÎ> ?
model
ÎÎ@ E
.
ÎÎE F0
"AddContentApprovalDeadlineProperty
ÎÎF h
;
ÎÎh i
var
ÏÏ 
warningDays
ÏÏ  +
=
ÏÏ, -
_configuration
ÏÏ. <
.
ÏÏ< =
WarningDays
ÏÏ= H
;
ÏÏH I
if
ÓÓ 
(
ÓÓ  +
enableContentApprovalDeadline
ÓÓ  =
)
ÓÓ= >
{
ÔÔ 
var
ÒÒ  #
propertyData
ÒÒ$ 0
=
ÒÒ1 2
content
ÒÒ3 :
.
ÒÒ: ;
Property
ÒÒ; C
.
ÒÒC D
Get
ÒÒD G
(
ÒÒG H1
#ContentApprovalDeadlinePropertyName
ÒÒH k
)
ÒÒk l
??
ÒÒm o
content
ÒÒp w
.
ÒÒw x
PropertyÒÒx Ä
[ÒÒÄ Å3
#ContentApprovalDeadlinePropertyNameÒÒÅ §
]ÒÒ§ •
;ÒÒ• ¶
if
ÚÚ  "
(
ÚÚ# $
propertyData
ÚÚ$ 0
!=
ÚÚ1 3
null
ÚÚ4 8
)
ÚÚ8 9
{
ÛÛ  !
DateTime
ÙÙ$ ,
.
ÙÙ, -
TryParse
ÙÙ- 5
(
ÙÙ5 6
propertyData
ÙÙ6 B
.
ÙÙB C
ToString
ÙÙC K
(
ÙÙK L
)
ÙÙL M
,
ÙÙM N
out
ÙÙO R
var
ÙÙS V
	dateValue
ÙÙW `
)
ÙÙ` a
;
ÙÙa b
if
ıı$ &
(
ıı' (
	dateValue
ıı( 1
!=
ıı2 4
DateTime
ıı5 =
.
ıı= >
MinValue
ıı> F
&&
ııG I
!
ııJ K
string
ııK Q
.
ııQ R
IsNullOrEmpty
ııR _
(
ıı_ `

customTask
ıı` j
.
ııj k
Type
ıık o
)
ııo p
)
ııp q
{
ˆˆ$ %

customTask
˜˜( 2
.
˜˜2 3
Deadline
˜˜3 ;
=
˜˜< =
	dateValue
˜˜> G
;
˜˜G H
var
¯¯( +
days
¯¯, 0
=
¯¯1 2
DateTime
¯¯3 ;
.
¯¯; <
Now
¯¯< ?
.
¯¯? @
CountDaysInRange
¯¯@ P
(
¯¯P Q
	dateValue
¯¯Q Z
)
¯¯Z [
;
¯¯[ \
if
˙˙( *
(
˙˙+ ,
days
˙˙, 0
==
˙˙1 3
$num
˙˙4 5
)
˙˙5 6
{
˚˚( )

customTask
¸¸, 6
.
¸¸6 7
WarningColor
¸¸7 C
=
¸¸D E
$str
¸¸F K
;
¸¸K L
}
˝˝( )
else
˛˛( ,
if
˛˛- /
(
˛˛0 1
days
˛˛1 5
>
˛˛6 7
$num
˛˛8 9
&&
˛˛: <
days
˛˛= A
<
˛˛B C
warningDays
˛˛D O
)
˛˛O P
{
ˇˇ( )

customTask
ÄÄ, 6
.
ÄÄ6 7
WarningColor
ÄÄ7 C
=
ÄÄD E
$str
ÄÄF M
;
ÄÄM N
}
ÅÅ( )
}
ÇÇ$ %
}
ÉÉ  !
}
ÑÑ 
}
ÖÖ 

customTask
àà "
=
àà# $
await
àà% *"
_notificationHandler
àà+ ?
.
àà? @
GetNotifications
àà@ P
(
ààP Q
id
ààQ S
,
ààS T

customTask
ààU _
,
àà_ `
true
ààa e
)
ààe f
;
ààf g
taskList
ää  
.
ää  !
Add
ää! $
(
ää$ %

customTask
ää% /
)
ää/ 0
;
ää0 1
}
ãã 
}
åå 
return
éé 
taskList
éé 
;
éé  
}
èè 
return
ëë 
new
ëë 
List
ëë 
<
ëë 
ContentTask
ëë '
>
ëë' (
(
ëë( )
)
ëë) *
;
ëë* +
}
íí 	
private
îî 
async
îî 
Task
îî 
ApproveContent
îî )
(
îî) *
string
îî* 0
values
îî1 7
,
îî7 8
string
îî9 ?
approvalComment
îî@ O
,
îîO P
bool
îîQ U
publishContent
îîV d
)
îîd e
{
ïï 	
if
ññ 
(
ññ 
!
ññ 
string
ññ 
.
ññ 
IsNullOrEmpty
ññ %
(
ññ% &
values
ññ& ,
)
ññ, -
)
ññ- .
{
óó 
var
òò 
ids
òò 
=
òò 
values
òò  
.
òò  !
Split
òò! &
(
òò& '
new
òò' *
[
òò* +
]
òò+ ,
{
òò- .
$str
òò/ 2
}
òò3 4
,
òò4 5 
StringSplitOptions
òò6 H
.
òòH I 
RemoveEmptyEntries
òòI [
)
òò[ \
.
òò\ ]
Distinct
òò] e
(
òòe f
)
òòf g
.
òòg h
ToList
òòh n
(
òòn o
)
òòo p
;
òòp q
foreach
öö 
(
öö 
var
öö 
id
öö 
in
öö  "
ids
öö# &
)
öö& '
{
õõ 
int
úú 
.
úú 
TryParse
úú  
(
úú  !
id
úú! #
,
úú# $
out
úú% (
var
úú) ,

approvalId
úú- 7
)
úú7 8
;
úú8 9
if
ùù 
(
ùù 

approvalId
ùù "
!=
ùù# %
$num
ùù& '
)
ùù' (
{
ûû 
try
üü 
{
†† 
var
°° 
approval
°°  (
=
°°) *
await
°°+ 0!
_approvalRepository
°°1 D
.
°°D E
GetAsync
°°E M
(
°°M N

approvalId
°°N X
)
°°X Y
;
°°Y Z
await
¢¢ !
_approvalEngine
¢¢" 1
.
¢¢1 2
ForceApproveAsync
¢¢2 C
(
¢¢C D

approvalId
¢¢D N
,
¢¢N O
PrincipalAccessor
¢¢P a
.
¢¢a b
Current
¢¢b i
.
¢¢i j
Identity
¢¢j r
?
¢¢r s
.
¢¢s t
Name
¢¢t x
,
¢¢x y
approvalComment¢¢z â
)¢¢â ä
;¢¢ä ã
if
§§ 
(
§§  
approval
§§  (
is
§§) +
ContentApproval
§§, ;
contentApproval
§§< K
)
§§K L
{
••  
_contentRepository
¶¶  2
.
¶¶2 3
TryGet
¶¶3 9
(
¶¶9 :
contentApproval
¶¶: I
.
¶¶I J
ContentLink
¶¶J U
,
¶¶U V
out
¶¶W Z
IContent
¶¶[ c
content
¶¶d k
)
¶¶k l
;
¶¶l m
var
ßß  #
canUserPublish
ßß$ 2
=
ßß3 4
publishContent
ßß5 C
&&
ßßD F
_helper
ßßG N
.
ßßN O
CanUserPublish
ßßO ]
(
ßß] ^
content
ßß^ e
)
ßße f
;
ßßf g
if
®®  "
(
®®# $
content
®®$ +
!=
®®, .
null
®®/ 3
&&
®®4 6
canUserPublish
®®7 E
)
®®E F
{
©©  !
try
™™$ '
{
´´$ %
switch
≠≠( .
(
≠≠/ 0
content
≠≠0 7
)
≠≠7 8
{
ÆÆ( )
case
ØØ, 0
PageData
ØØ1 9
page
ØØ: >
:
ØØ> ?
{
∞∞0 1
var
±±4 7
clone
±±8 =
=
±±> ?
page
±±@ D
.
±±D E!
CreateWritableClone
±±E X
(
±±X Y
)
±±Y Z
;
±±Z [ 
_contentRepository
≤≤4 F
.
≤≤F G
Save
≤≤G K
(
≤≤K L
clone
≤≤L Q
,
≤≤Q R

SaveAction
≤≤S ]
.
≤≤] ^
Publish
≤≤^ e
,
≤≤e f
AccessLevel
≤≤g r
.
≤≤r s
Publish
≤≤s z
)
≤≤z {
;
≤≤{ |
break
≥≥4 9
;
≥≥9 :
}
¥¥0 1
case
µµ, 0
	BlockData
µµ1 :
block
µµ; @
:
µµ@ A
{
∂∂0 1
var
∑∑4 7
clone
∑∑8 =
=
∑∑> ?
block
∑∑@ E
.
∑∑E F!
CreateWritableClone
∑∑F Y
(
∑∑Y Z
)
∑∑Z [
as
∑∑\ ^
IContent
∑∑_ g
;
∑∑g h 
_contentRepository
∏∏4 F
.
∏∏F G
Save
∏∏G K
(
∏∏K L
clone
∏∏L Q
,
∏∏Q R

SaveAction
∏∏S ]
.
∏∏] ^
Publish
∏∏^ e
,
∏∏e f
AccessLevel
∏∏g r
.
∏∏r s
Publish
∏∏s z
)
∏∏z {
;
∏∏{ |
break
ππ4 9
;
ππ9 :
}
∫∫0 1
case
ªª, 0
	ImageData
ªª1 :
image
ªª; @
:
ªª@ A
{
ºº0 1
var
ΩΩ4 7
clone
ΩΩ8 =
=
ΩΩ> ?
image
ΩΩ@ E
.
ΩΩE F!
CreateWritableClone
ΩΩF Y
(
ΩΩY Z
)
ΩΩZ [
as
ΩΩ\ ^
IContent
ΩΩ_ g
;
ΩΩg h 
_contentRepository
ææ4 F
.
ææF G
Save
ææG K
(
ææK L
clone
ææL Q
,
ææQ R

SaveAction
ææS ]
.
ææ] ^
Publish
ææ^ e
,
ææe f
AccessLevel
ææg r
.
æær s
Publish
ææs z
)
ææz {
;
ææ{ |
break
øø4 9
;
øø9 :
}
¿¿0 1
case
¡¡, 0
	MediaData
¡¡1 :
media
¡¡; @
:
¡¡@ A
{
¬¬0 1
var
√√4 7
clone
√√8 =
=
√√> ?
media
√√@ E
.
√√E F!
CreateWritableClone
√√F Y
(
√√Y Z
)
√√Z [
as
√√\ ^
IContent
√√_ g
;
√√g h 
_contentRepository
ƒƒ4 F
.
ƒƒF G
Save
ƒƒG K
(
ƒƒK L
clone
ƒƒL Q
,
ƒƒQ R

SaveAction
ƒƒS ]
.
ƒƒ] ^
Publish
ƒƒ^ e
,
ƒƒe f
AccessLevel
ƒƒg r
.
ƒƒr s
Publish
ƒƒs z
)
ƒƒz {
;
ƒƒ{ |
break
≈≈4 9
;
≈≈9 :
}
∆∆0 1
}
««( )
}
»»$ %
catch
……$ )
(
……* +
	Exception
……+ 4
ex
……5 7
)
……7 8
{
  $ %
_logger
ÀÀ( /
.
ÀÀ/ 0
Error
ÀÀ0 5
(
ÀÀ5 6
$str
ÀÀ6 y
+
ÀÀz {

approvalIdÀÀ| Ü
+ÀÀá à
$strÀÀâ ô
+ÀÀö õ
contentApprovalÀÀú ´
.ÀÀ´ ¨
ContentLinkÀÀ¨ ∑
.ÀÀ∑ ∏
IDÀÀ∏ ∫
,ÀÀ∫ ª
exÀÀº æ
)ÀÀæ ø
;ÀÀø ¿
}
ÃÃ$ %
}
ÕÕ  !
}
ŒŒ 
}
œœ 
catch
–– 
(
–– 
	Exception
–– (
ex
––) +
)
––+ ,
{
—— 
_logger
““ #
.
““# $
Error
““$ )
(
““) *
$str
““* ^
+
““_ `

approvalId
““a k
,
““k l
ex
““m o
)
““o p
;
““p q
}
”” 
}
‘‘ 
}
’’ 
}
÷÷ 
}
◊◊ 	
private
ŸŸ 
async
ŸŸ 
Task
ŸŸ 
<
ŸŸ 
List
ŸŸ 
<
ŸŸ  
ContentTask
ŸŸ  +
>
ŸŸ+ ,
>
ŸŸ, -$
GetChangeApprovalTasks
ŸŸ. D
(
ŸŸD E'
AdvancedTaskIndexViewData
ŸŸE ^
model
ŸŸ_ d
)
ŸŸd e
{
⁄⁄ 	
var
€€ 
query
€€ 
=
€€ 
new
€€ 
ApprovalQuery
€€ )
{
‹‹ 
Status
›› 
=
›› 
ApprovalStatus
›› '
.
››' (
InReview
››( 0
,
››0 1
	Reference
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
Uri
ﬁﬁ  #
(
ﬁﬁ# $
$str
ﬁﬁ$ 5
)
ﬁﬁ5 6
}
ﬂﬂ 
;
ﬂﬂ 
var
·· 
roles
·· 
=
·· 
await
·· 
_helper
·· %
.
··% &
GetUserRoles
··& 2
(
··2 3
)
··3 4
;
··4 5
if
‚‚ 
(
‚‚ 
!
‚‚ 
roles
‚‚ 
.
‚‚ 
Contains
‚‚ 
(
‚‚  
Roles
‚‚  %
.
‚‚% &
Administrators
‚‚& 4
)
‚‚4 5
&&
‚‚6 8
!
‚‚9 :
roles
‚‚: ?
.
‚‚? @
Contains
‚‚@ H
(
‚‚H I
Roles
‚‚I N
.
‚‚N O
	WebAdmins
‚‚O X
)
‚‚X Y
&&
‚‚Z \
!
„„ 
roles
„„ 
.
„„ 
Contains
„„ 
(
„„  
Roles
„„  %
.
„„% &
	CmsAdmins
„„& /
)
„„/ 0
)
„„0 1
{
‰‰ 
query
ÂÂ 
.
ÂÂ 
Username
ÂÂ 
=
ÂÂ  
PrincipalAccessor
ÂÂ! 2
.
ÂÂ2 3
Current
ÂÂ3 :
.
ÂÂ: ;
Identity
ÂÂ; C
?
ÂÂC D
.
ÂÂD E
Name
ÂÂE I
;
ÂÂI J
}
ÊÊ 
var
ËË 
list
ËË 
=
ËË 
await
ËË !
_approvalRepository
ËË 0
.
ËË0 1
	ListAsync
ËË1 :
(
ËË: ;
query
ËË; @
,
ËË@ A
(
ËËB C
model
ËËC H
.
ËËH I

PageNumber
ËËI S
-
ËËT U
$num
ËËV W
)
ËËW X
*
ËËY Z
model
ËË[ `
.
ËË` a
PageSize
ËËa i
,
ËËi j
model
ËËk p
.
ËËp q
PageSize
ËËq y
)
ËËy z
;
ËËz {
model
ÈÈ 
.
ÈÈ 
TotalItemsCount
ÈÈ !
=
ÈÈ" #
Convert
ÈÈ$ +
.
ÈÈ+ ,
ToInt32
ÈÈ, 3
(
ÈÈ3 4
list
ÈÈ4 8
.
ÈÈ8 9

TotalCount
ÈÈ9 C
)
ÈÈC D
;
ÈÈD E
var
ÎÎ 
taskList
ÎÎ 
=
ÎÎ 
new
ÎÎ 
List
ÎÎ #
<
ÎÎ# $
ContentTask
ÎÎ$ /
>
ÎÎ/ 0
(
ÎÎ0 1
)
ÎÎ1 2
;
ÎÎ2 3
foreach
ÌÌ 
(
ÌÌ 
var
ÌÌ 
task
ÌÌ 
in
ÌÌ  
list
ÌÌ! %
.
ÌÌ% &
PagedResult
ÌÌ& 1
)
ÌÌ1 2
{
ÓÓ 
IContent
ÔÔ 
content
ÔÔ  
=
ÔÔ! "
null
ÔÔ# '
;
ÔÔ' (
var
 
id
 
=
 
task
 
.
 
ID
  
.
  !
ToString
! )
(
) *
)
* +
;
+ ,
var
ÚÚ 

customTask
ÚÚ 
=
ÚÚ  
new
ÚÚ! $
ContentTask
ÚÚ% 0
{
ÛÛ 

ApprovalId
ÙÙ 
=
ÙÙ  
task
ÙÙ! %
.
ÙÙ% &
ID
ÙÙ& (
,
ÙÙ( )
DateTime
ıı 
=
ıı 
task
ıı #
.
ıı# $
ActiveStepStarted
ıı$ 5
,
ıı5 6
	StartedBy
ˆˆ 
=
ˆˆ 
task
ˆˆ  $
.
ˆˆ$ %
	StartedBy
ˆˆ% .
,
ˆˆ. /
URL
˜˜ 
=
˜˜ 
new
˜˜ 
ContentReference
˜˜ .
(
˜˜. /
task
˜˜/ 3
.
˜˜3 4
ID
˜˜4 6
)
˜˜6 7
.
˜˜7 8

GetEditUrl
˜˜8 B
(
˜˜B C
)
˜˜C D
.
˜˜D E
Replace
˜˜E L
(
˜˜L M
$str
˜˜M \
,
˜˜\ ]
$str
˜˜^ p
)
˜˜p q
}
¯¯ 
;
¯¯ 
if
˙˙ 
(
˙˙ 
!
˙˙ 
(
˙˙ 
task
˙˙ 
is
˙˙ 
ContentApproval
˙˙ -
)
˙˙- .
)
˙˙. /
{
˚˚ 
var
˝˝ 
taskDetails
˝˝ #
=
˝˝$ %
_changeTaskHelper
˝˝& 7
.
˝˝7 8
GetData
˝˝8 ?
(
˝˝? @
task
˝˝@ D
.
˝˝D E
ID
˝˝E G
)
˝˝G H
;
˝˝H I
if
ˇˇ 
(
ˇˇ 
taskDetails
ˇˇ #
!=
ˇˇ$ &
null
ˇˇ' +
)
ˇˇ+ ,
{
ÄÄ 

customTask
ÅÅ "
.
ÅÅ" #
Type
ÅÅ# '
=
ÅÅ( )
taskDetails
ÅÅ* 5
.
ÅÅ5 6
Type
ÅÅ6 :
;
ÅÅ: ;

customTask
ÇÇ "
.
ÇÇ" #
ContentName
ÇÇ# .
=
ÇÇ/ 0
taskDetails
ÇÇ1 <
.
ÇÇ< =
Name
ÇÇ= A
;
ÇÇA B

customTask
ÉÉ "
.
ÉÉ" #
Details
ÉÉ# *
=
ÉÉ+ ,
taskDetails
ÉÉ- 8
.
ÉÉ8 9
Details
ÉÉ9 @
;
ÉÉ@ A
}
ÑÑ 
if
ÜÜ 
(
ÜÜ 
task
ÜÜ 
.
ÜÜ 
	Reference
ÜÜ &
!=
ÜÜ' )
null
ÜÜ* .
&&
ÜÜ/ 1
!
ÜÜ2 3
string
ÜÜ3 9
.
ÜÜ9 :
IsNullOrEmpty
ÜÜ: G
(
ÜÜG H
task
ÜÜH L
.
ÜÜL M
	Reference
ÜÜM V
.
ÜÜV W
AbsolutePath
ÜÜW c
)
ÜÜc d
)
ÜÜd e
{
áá 
var
àà 
pageId
àà "
=
àà# $
task
àà% )
.
àà) *
	Reference
àà* 3
.
àà3 4
AbsolutePath
àà4 @
.
àà@ A
Replace
ààA H
(
ààH I
$str
ààI L
,
ààL M
$str
ààN P
)
ààP Q
;
ààQ R
int
ää 
.
ää 
TryParse
ää $
(
ää$ %
pageId
ää% +
,
ää+ ,
out
ää- 0
var
ää1 4
	contentId
ää5 >
)
ää> ?
;
ää? @
if
ãã 
(
ãã 
	contentId
ãã %
!=
ãã& (
$num
ãã) *
)
ãã* +
{
åå  
_contentRepository
çç .
.
çç. /
TryGet
çç/ 5
(
çç5 6
new
çç6 9
ContentReference
çç: J
(
ççJ K
	contentId
ççK T
)
ççT U
,
ççU V
out
ççW Z
content
çç[ b
)
ççb c
;
ççc d
}
éé 
}
èè 
if
ëë 
(
ëë 
content
ëë 
!=
ëë  "
null
ëë# '
)
ëë' (
{
íí 

customTask
ìì "
.
ìì" #
ContentReference
ìì# 3
=
ìì4 5
content
ìì6 =
.
ìì= >
ContentLink
ìì> I
;
ììI J

customTask
îî "
.
îî" #
ContentType
îî# .
=
îî/ 0
GetTypeContent
îî1 ?
(
îî? @
content
îî@ G
)
îîG H
;
îîH I
}
ïï 

customTask
óó 
=
óó  
await
óó! &"
_notificationHandler
óó' ;
.
óó; <
GetNotifications
óó< L
(
óóL M
id
óóM O
,
óóO P

customTask
óóQ [
,
óó[ \
false
óó] b
)
óób c
;
óóc d
taskList
ôô 
.
ôô 
Add
ôô  
(
ôô  !

customTask
ôô! +
)
ôô+ ,
;
ôô, -
}
öö 
}
õõ 
return
ùù 
taskList
ùù 
;
ùù 
}
ûû 	
private
†† 
async
†† 
Task
†† 

AbortTasks
†† %
(
††% &
List
††& *
<
††* +
int
††+ .
>
††. /
ids
††0 3
)
††3 4
{
°° 	
await
¢¢ 
_approvalEngine
¢¢ !
.
¢¢! "

AbortAsync
¢¢" ,
(
¢¢, -
ids
¢¢- 0
,
¢¢0 1
PrincipalAccessor
¢¢2 C
.
¢¢C D
Current
¢¢D K
.
¢¢K L
Identity
¢¢L T
?
¢¢T U
.
¢¢U V
Name
¢¢V Z
)
¢¢Z [
;
¢¢[ \
}
££ 	
private
•• 
string
•• 
GetTypeContent
•• %
(
••% &
IContent
••& .
content
••/ 6
)
••6 7
{
¶¶ 	
var
ßß 
contentName
ßß 
=
ßß 
$str
ßß  
;
ßß  !
var
©© 
contentType
©© 
=
©© $
_contentTypeRepository
©© 4
.
©©4 5
Load
©©5 9
(
©©9 :
content
©©: A
.
©©A B
GetType
©©B I
(
©©I J
)
©©J K
.
©©K L
BaseType
©©L T
)
©©T U
;
©©U V
if
´´ 
(
´´ 
contentType
´´ 
!=
´´ 
null
´´ #
)
´´# $
{
¨¨ 
contentName
≠≠ 
=
≠≠ 
contentType
≠≠ )
.
≠≠) *
DisplayName
≠≠* 5
;
≠≠5 6
}
ÆÆ 
else
ØØ 
{
∞∞ 
contentType
±± 
=
±± $
_contentTypeRepository
±± 4
.
±±4 5
Load
±±5 9
(
±±9 :
content
±±: A
.
±±A B
GetType
±±B I
(
±±I J
)
±±J K
)
±±K L
;
±±L M
if
≥≥ 
(
≥≥ 
contentType
≥≥ 
!=
≥≥  "
null
≥≥# '
)
≥≥' (
{
¥¥ 
if
µµ 
(
µµ 
!
µµ 
string
µµ 
.
µµ  
IsNullOrEmpty
µµ  -
(
µµ- .
contentType
µµ. 9
.
µµ9 :
DisplayName
µµ: E
)
µµE F
)
µµF G
contentName
∂∂ #
=
∂∂$ %
contentType
∂∂& 1
.
∂∂1 2
DisplayName
∂∂2 =
;
∂∂= >
else
∑∑ 
if
∑∑ 
(
∑∑ 
!
∑∑ 
string
∑∑ $
.
∑∑$ %
IsNullOrEmpty
∑∑% 2
(
∑∑2 3
contentType
∑∑3 >
.
∑∑> ?
Name
∑∑? C
)
∑∑C D
)
∑∑D E
contentName
∏∏ #
=
∏∏$ %
contentType
∏∏& 1
.
∏∏1 2
Name
∏∏2 6
;
∏∏6 7
}
ππ 
}
∫∫ 
if
ºº 
(
ºº 
string
ºº 
.
ºº  
IsNullOrWhiteSpace
ºº )
(
ºº) *
contentName
ºº* 5
)
ºº5 6
)
ºº6 7
{
ΩΩ 
var
ææ 

memberInfo
ææ 
=
ææ  
content
ææ! (
.
ææ( )
GetType
ææ) 0
(
ææ0 1
)
ææ1 2
.
ææ2 3
BaseType
ææ3 ;
;
ææ; <
if
øø 
(
øø 

memberInfo
øø 
!=
øø !
null
øø" &
)
øø& '
{
¿¿ 
contentName
¡¡ 
=
¡¡  !"
_localizationService
¡¡" 6
.
¡¡6 7
	GetString
¡¡7 @
(
¡¡@ A
$str
¡¡A Q
+
¡¡R S

memberInfo
¡¡T ^
.
¡¡^ _
Name
¡¡_ c
.
¡¡c d
ToLower
¡¡d k
(
¡¡k l
)
¡¡l m
+
¡¡n o
$str
¡¡p w
,
¡¡w x 
FallbackBehaviors¡¡y ä
.¡¡ä ã
FallbackCulture¡¡ã ö
)¡¡ö õ
;¡¡õ ú
}
¬¬ 
}
√√ 
if
≈≈ 
(
≈≈ 
!
≈≈ 
string
≈≈ 
.
≈≈  
IsNullOrWhiteSpace
≈≈ *
(
≈≈* +
contentName
≈≈+ 6
)
≈≈6 7
&&
≈≈8 :
contentName
≈≈; F
.
≈≈F G
Contains
≈≈G O
(
≈≈O P
$str
≈≈P _
)
≈≈_ `
)
≈≈` a
{
∆∆ 
contentName
«« 
=
«« 
$str
««  
;
««  !
}
»» 
return
   
contentName
   
;
   
}
ÀÀ 	
private
ÕÕ 
List
ÕÕ 
<
ÕÕ "
LanguageBranchOption
ÕÕ )
>
ÕÕ) *
LanguageBranches
ÕÕ+ ;
(
ÕÕ; <
string
ÕÕ< B
language
ÕÕC K
)
ÕÕK L
{
ŒŒ 	
var
œœ 
toReturn
œœ 
=
œœ 
new
œœ 
List
œœ #
<
œœ# $"
LanguageBranchOption
œœ$ 8
>
œœ8 9
(
œœ9 :
)
œœ: ;
;
œœ; <
var
–– 
enabledLanguages
––  
=
––! "'
_languageBranchRepository
––# <
.
––< =
ListEnabled
––= H
(
––H I
)
––I J
;
––J K
var
—— 
firstEnabled
—— 
=
—— '
_languageBranchRepository
—— 8
.
——8 9$
LoadFirstEnabledBranch
——9 O
(
——O P
)
——P Q
;
——Q R
foreach
”” 
(
”” 
var
”” 
languageBranch
”” '
in
””( *
enabledLanguages
””+ ;
)
””; <
{
‘‘ 
var
’’ "
languageBranchOption
’’ (
=
’’) *
new
’’+ ."
LanguageBranchOption
’’/ C
{
÷÷ 
Language
◊◊ 
=
◊◊ 
languageBranch
◊◊ -
,
◊◊- .
Selected
ÿÿ 
=
ÿÿ 
false
ÿÿ $
}
ŸŸ 
;
ŸŸ 
if
€€ 
(
€€ 
!
€€ 
string
€€ 
.
€€ 
IsNullOrEmpty
€€ )
(
€€) *
language
€€* 2
)
€€2 3
)
€€3 4
{
‹‹ "
languageBranchOption
›› (
.
››( )
Selected
››) 1
=
››2 3
languageBranch
››4 B
.
››B C

LanguageID
››C M
.
››M N
Equals
››N T
(
››T U
language
››U ]
,
››] ^
StringComparison
››_ o
.
››o p 
OrdinalIgnoreCase››p Å
)››Å Ç
;››Ç É
}
ﬁﬁ 
else
ﬂﬂ 
if
ﬂﬂ 
(
ﬂﬂ 
!
ﬂﬂ 
ContentReference
ﬂﬂ *
.
ﬂﬂ* +
IsNullOrEmpty
ﬂﬂ+ 8
(
ﬂﬂ8 9
ContentReference
ﬂﬂ9 I
.
ﬂﬂI J
	StartPage
ﬂﬂJ S
)
ﬂﬂS T
)
ﬂﬂT U
{
‡‡  
_contentRepository
·· &
.
··& '
TryGet
··' -
<
··- .
IContent
··. 6
>
··6 7
(
··7 8
ContentReference
··8 H
.
··H I
	StartPage
··I R
,
··R S
languageBranch
··T b
.
··b c
Culture
··c j
,
··j k
out
··l o
var
··p s
	startPage
··t }
)
··} ~
;
··~ 
if
„„ 
(
„„ 
	startPage
„„ !
!=
„„" $
null
„„% )
&&
„„* ,
	startPage
„„- 6
.
„„6 7$
IsMasterLanguageBranch
„„7 M
(
„„M N
)
„„N O
)
„„O P
{
‰‰ "
languageBranchOption
ÂÂ ,
.
ÂÂ, -
Selected
ÂÂ- 5
=
ÂÂ6 7
true
ÂÂ8 <
;
ÂÂ< =
}
ÊÊ 
else
ÁÁ 
if
ÁÁ 
(
ÁÁ 
firstEnabled
ÁÁ )
.
ÁÁ) *

LanguageID
ÁÁ* 4
==
ÁÁ5 7
languageBranch
ÁÁ8 F
.
ÁÁF G

LanguageID
ÁÁG Q
)
ÁÁQ R
{
ËË "
languageBranchOption
ÈÈ ,
.
ÈÈ, -
Selected
ÈÈ- 5
=
ÈÈ6 7
true
ÈÈ8 <
;
ÈÈ< =
}
ÎÎ 
}
ÏÏ 
else
ÌÌ 
if
ÌÌ 
(
ÌÌ 
firstEnabled
ÌÌ %
.
ÌÌ% &

LanguageID
ÌÌ& 0
==
ÌÌ1 3
languageBranch
ÌÌ4 B
.
ÌÌB C

LanguageID
ÌÌC M
)
ÌÌM N
{
ÓÓ "
languageBranchOption
ÔÔ (
.
ÔÔ( )
Selected
ÔÔ) 1
=
ÔÔ2 3
true
ÔÔ4 8
;
ÔÔ8 9
}
 
toReturn
ÚÚ 
.
ÚÚ 
Add
ÚÚ 
(
ÚÚ "
languageBranchOption
ÚÚ 1
)
ÚÚ1 2
;
ÚÚ2 3
}
ÛÛ 
return
ıı 
toReturn
ıı 
;
ıı 
}
ˆˆ 	
}
˜˜ 
}¯¯ √]
}C:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\AdvancedTaskIndexViewData.cs
	namespace		 	
AdvancedTaskManager		
 
.		 
Features		 &
.		& '
AdvancedTask		' 3
{

 
public 

class %
AdvancedTaskIndexViewData *
{ 
public %
AdvancedTaskIndexViewData (
(( )
List) -
<- . 
LanguageBranchOption. B
>B C
languageBranchListD V
,V W&
AdvancedTaskManagerOptionsX r
configuration	s Ä
)
Ä Å
{ 	
LanguageBranchList 
=  
languageBranchList! 3
;3 4 
SelectedLanguageText  
=! "
$str# +
;+ ,
if 
( 
languageBranchList "
!=# %
null& *
&&+ -
languageBranchList. @
.@ A
AnyA D
(D E
)E F
)F G
{ 
var 
selectedLanguage $
=% &
languageBranchList' 9
.9 :
FirstOrDefault: H
(H I
xI J
=>K M
xN O
.O P
SelectedP X
)X Y
;Y Z
if 
( 
selectedLanguage $
?$ %
.% &
Language& .
!=/ 1
null2 6
)6 7
{  
SelectedLanguageText (
=) *
selectedLanguage+ ;
.; <
Language< D
.D E
NameE I
;I J
} 
} 
HasPublishAccess 
= 
false $
;$ %
ContentTaskList 
= 
new !
List" &
<& '
ContentTask' 2
>2 3
(3 4
)4 5
;5 6

PageNumber 
= 
$num 
; .
"AddContentApprovalDeadlineProperty   .
=  / 0
!  1 2
configuration  2 ?
.  ? @1
%DeleteContentApprovalDeadlineProperty  @ e
&&  f h
configuration  i v
.  v w/
"AddContentApprovalDeadlineProperty	  w ô
;
  ô ö
PageSize"" 
="" 
configuration"" $
.""$ %
PageSize""% -
is"". 0
>""1 2
$num""3 4
and""5 8
<=""9 ;
$num""< ?
?""@ A
configuration""B O
.""O P
PageSize""P X
:""Y Z
$num""[ ]
;""] ^
DateTimeFormat$$ 
=$$  
!$$! "
string$$" (
.$$( )
IsNullOrEmpty$$) 6
($$6 7
configuration$$7 D
.$$D E
DateTimeFormat$$E S
)$$S T
&&$$U W
DateTime$$X `
.$$` a
TryParseExact$$a n
($$n o
DateTime%% 
.%% 
UtcNow%% 
.%%  
ToString%%  (
(%%( )
CultureInfo%%) 4
.%%4 5
InvariantCulture%%5 E
)%%E F
,%%F G
configuration%%H U
.%%U V
DateTimeFormat%%V d
,%%d e
CultureInfo&& 
.&& 
InvariantCulture&& ,
,&&, -
DateTimeStyles&&. <
.&&< =
None&&= A
,&&A B
out&&C F
_&&G H
)&&H I
?'' 
configuration'' 
.''  
DateTimeFormat''  .
:(( 
$str(( $
;(($ %&
DateTimeFormatUserFriendly** &
=**' (
!**) *
string*** 0
.**0 1
IsNullOrEmpty**1 >
(**> ?
configuration**? L
.**L M&
DateTimeFormatUserFriendly**M g
)**g h
&&**i k
DateTime++) 1
.++1 2
TryParseExact++2 ?
(++? @
DateTime++@ H
.++H I
UtcNow++I O
.++O P
ToString++P X
(++X Y
CultureInfo++Y d
.++d e
InvariantCulture++e u
)++u v
,++v w
configuration,,- :
.,,: ;&
DateTimeFormatUserFriendly,,; U
,,,U V
CultureInfo,,W b
.,,b c
InvariantCulture,,c s
,,,s t
DateTimeStyles--- ;
.--; <
None--< @
,--@ A
out--B E
_--F G
)--G H
?.. 
configuration.. 
...  &
DateTimeFormatUserFriendly..  :
:// 
$str// ,
;//, -
}00 	
public22 
string22 
DateTimeFormat22 $
{22% &
get22' *
;22* +
set22, /
;22/ 0
}221 2
public44 
string44 &
DateTimeFormatUserFriendly44 0
{441 2
get443 6
;446 7
set448 ;
;44; <
}44= >
public66 
IEnumerable66 
<66 
int66 
>66 
Pages66  %
{77 	
get88 
{99 
var:: 
list2:: 
=:: 
new:: 
List::  $
<::$ %
int::% (
>::( )
{::* +
$num::, -
}::. /
;::/ 0
var;; 
list;; 
=;; 
list2;;  
;;;  !
if<< 
(<< 

PageNumber<< 
-<<  
PageSize<<! )
-<<* +
$num<<, -
><<. /
$num<<0 1
)<<1 2
{== 
list>> 
.>> 
Add>> 
(>> 
$num>> 
)>> 
;>>  
}?? 
for@@ 
(@@ 
var@@ 
i@@ 
=@@ 

PageNumber@@ '
-@@( )
PageSize@@* 2
;@@2 3
i@@4 5
<=@@6 8

PageNumber@@9 C
+@@D E
PageSize@@F N
;@@N O
i@@P Q
++@@Q S
)@@S T
{AA 
ifBB 
(BB 
iBB 
>BB 
$numBB 
&&BB  
iBB! "
<BB# $
TotalPagesCountBB% 4
)BB4 5
{CC 
listDD 
.DD 
AddDD  
(DD  !
iDD! "
)DD" #
;DD# $
}EE 
}FF 
ifGG 
(GG 

PageNumberGG 
+GG  
PageSizeGG! )
+GG* +
$numGG, -
<GG. /
TotalPagesCountGG0 ?
)GG? @
{HH 
listII 
.II 
AddII 
(II 
$numII 
)II 
;II  
}JJ 
ifKK 
(KK 
TotalPagesCountKK #
>KK$ %
$numKK& '
)KK' (
{LL 
listMM 
.MM 
AddMM 
(MM 
TotalPagesCountMM ,
)MM, -
;MM- .
}NN 
returnOO 
listOO 
;OO 
}PP 
}QQ 	
publicSS 
intSS 
TotalPagesCountSS "
=>SS# %
(SS& '
TotalItemsCountSS' 6
-SS7 8
$numSS9 :
)SS: ;
/SS< =
PageSizeSS> F
+SSG H
$numSSI J
;SSJ K
publicUU 
intUU 
MaxIndexOfItemUU !
{VV 	
getWW 
{XX 
ifYY 
(YY 

PageNumberYY 
*YY  
PageSizeYY! )
<=YY* ,
TotalItemsCountYY- <
)YY< =
{ZZ 
return[[ 

PageNumber[[ %
*[[& '
PageSize[[( 0
;[[0 1
}\\ 
return^^ 
TotalItemsCount^^ &
;^^& '
}__ 
}`` 	
publicbb 
intbb 
MinIndexOfItembb !
{cc 	
getdd 
{ee 
ifff 
(ff 
TotalItemsCountff #
<=ff$ &
$numff' (
)ff( )
{gg 
returnhh 
$numhh 
;hh 
}ii 
returnkk 
(kk 

PageNumberkk "
-kk# $
$numkk% &
)kk& '
*kk( )
PageSizekk* 2
+kk3 4
$numkk5 6
;kk6 7
}ll 
}mm 	
publicoo 
intoo 
PageSizeoo 
{oo 
getoo !
;oo! "
setoo# &
;oo& '
}oo( )
publicqq 
intqq 

PageNumberqq 
{qq 
getqq  #
;qq# $
setqq% (
;qq( )
}qq* +
publicss 
Listss 
<ss 
ContentTaskss 
>ss  
ContentTaskListss! 0
{ss1 2
getss3 6
;ss6 7
setss8 ;
;ss; <
}ss= >
publicuu 
intuu 
TotalItemsCountuu "
{uu# $
getuu% (
;uu( )
setuu* -
;uu- .
}uu/ 0
publicww 
boolww 
HasPublishAccessww $
{ww% &
getww' *
;ww* +
setww, /
;ww/ 0
}ww1 2
publicyy 
stringyy 

TaskValuesyy  
{yy! "
getyy# &
;yy& '
setyy( +
;yy+ ,
}yy- .
public{{ 
string{{ 
QueryString{{ !
{{{" #
get{{$ '
;{{' (
set{{) ,
;{{, -
}{{. /
public}} 
string}} 
PageUrl}} 
(}} 
int}} !
page}}" &
)}}& '
{~~ 	
var 
qs 
= 
HttpUtility  
.  !
ParseQueryString! 1
(1 2
QueryString2 =
)= >
;> ?
qs
ÄÄ 
[
ÄÄ 
$str
ÄÄ 
]
ÄÄ 
=
ÄÄ 
page
ÄÄ 
.
ÄÄ 
ToString
ÄÄ &
(
ÄÄ& '
)
ÄÄ' (
;
ÄÄ( )
return
ÅÅ 
$"
ÅÅ 
$str
ÅÅ 
{
ÅÅ 
qs
ÅÅ 
}
ÅÅ 
"
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
string
ÑÑ 
LanguageUrl
ÑÑ !
(
ÑÑ! "
string
ÑÑ" (
language
ÑÑ) 1
)
ÑÑ1 2
{
ÖÖ 	
var
ÜÜ 
qs
ÜÜ 
=
ÜÜ 
HttpUtility
ÜÜ  
.
ÜÜ  !
ParseQueryString
ÜÜ! 1
(
ÜÜ1 2
QueryString
ÜÜ2 =
)
ÜÜ= >
;
ÜÜ> ?
qs
áá 
[
áá 
$str
áá 
]
áá 
=
áá 
language
áá %
;
áá% &
return
àà 
$"
àà 
$str
àà 
{
àà 
qs
àà 
}
àà 
"
àà 
;
àà 
}
ââ 	
public
ãã 
bool
ãã 0
"AddContentApprovalDeadlineProperty
ãã 6
{
ãã7 8
get
ãã9 <
;
ãã< =
set
ãã> A
;
ããA B
}
ããC D
public
çç 
List
çç 
<
çç "
LanguageBranchOption
çç (
>
çç( ) 
LanguageBranchList
çç* <
{
çç= >
get
çç? B
;
ççB C
set
ççD G
;
ççG H
}
ççI J
public
èè 
string
èè "
SelectedLanguageText
èè *
{
èè+ ,
get
èè- 0
;
èè0 1
set
èè2 5
;
èè5 6
}
èè7 8
}
êê 
public
íí 

class
íí "
LanguageBranchOption
íí %
{
ìì 
public
îî 
LanguageBranch
îî 
Language
îî &
{
îî' (
get
îî) ,
;
îî, -
set
îî. 1
;
îî1 2
}
îî3 4
public
ïï 
bool
ïï 
Selected
ïï 
{
ïï 
get
ïï "
;
ïï" #
set
ïï$ '
;
ïï' (
}
ïï) *
}
ññ 
}óó –
pC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\ApprovalData.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
AdvancedTask' 3
{ 
public 

class 
ApprovalData 
{ 
public 
string 

TaskValues  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
ApprovalComment %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
bool 
PublishContent "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
}		 ´	
tC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\ChangeTaskDetail.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
AdvancedTask' 3
{ 
public 

class 
ChangeTaskDetail !
{ 
public 
ChangeTaskDetail 
(  
)  !
{		 	
Details

 
=

 
new

 
List

 
<

 !
IContentChangeDetails

 4
>

4 5
(

5 6
)

6 7
;

7 8
} 	
public 
IEnumerable 
< !
IContentChangeDetails 0
>0 1
Details2 9
{: ;
get< ?
;? @
setA D
;D E
}F G
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
} 
} À
wC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\ChangeTaskViewModel.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
AdvancedTask' 3
{ 
public 

class 
ChangeTaskViewModel $
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
int 

ApprovalID 
{ 
get  #
;# $
set% (
;( )
}* +
public 
ContentReference  
AppliedOnContentLink  4
{ 	
get 
=> 
ContentReference #
.# $
TryParse$ ,
(, -
AppliedOnContent- =
,= >
out? B
varC F
resultG M
)M N
?O P
resultQ W
:X Y
ContentReferenceZ j
.j k
EmptyReferencek y
;y z
set 
=> 
AppliedOnContent #
=$ %
ContentReference& 6
.6 7
IsNullOrEmpty7 D
(D E
valueE J
)J K
?L M
stringN T
.T U
EmptyU Z
:[ \
value] b
.b c%
ToReferenceWithoutVersionc |
(| }
)} ~
.~ 
ToString	 á
(
á à
)
à â
;
â ä
} 	
public 
string 
AppliedOnContent &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
CurrentSettingsJson )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
NewSettingsJson %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
	CreatedBy 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	ChangedBy 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
Saved 
{ 
get  #
;# $
set% (
;( )
}* +
public   
bool   

CanExecute   
{    
get  ! $
;  $ %
set  & )
;  ) *
}  + ,
public"" 
string"" #
AppliedOnLanguageBranch"" -
{"". /
get""0 3
;""3 4
set""5 8
;""8 9
}"": ;
public$$ 
int$$ 
Status$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public&& 
string&& 
TypeIdentifier&& $
{&&% &
get&&' *
;&&* +
set&&, /
;&&/ 0
}&&1 2
public(( 
bool(( 1
%IsCurrentUserInActiveStepReviewerList(( 9
{((: ;
get((< ?
;((? @
set((A D
;((D E
}((F G
public** 
bool** 
IsCommandDataValid** &
{**' (
get**) ,
;**, -
set**. 1
;**1 2
}**3 4
public,, 
bool,, %
CanUserActOnHisOwnChanges,, -
{,,. /
get,,0 3
;,,3 4
set,,5 8
;,,8 9
},,: ;
}-- 
}.. ”
oC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\ContentTask.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
AdvancedTask' 3
{ 
public 

class 
ContentTask 
{		 
public

 
ContentTask

 
(

 
)

 
{ 	
ContentReference 
= 
ContentReference /
./ 0
EmptyReference0 >
;> ?
ContentName 
= 
$str 
; 
ContentType 
= 
$str 
; 
Type 
= 
$str 
; 
DateTime 
= 
null 
; 
Deadline 
= 
null 
; 
	StartedBy 
= 
$str 
; 
WarningColor 
= 
$str 
; 
Details 
= 
new 
List 
< !
IContentChangeDetails 4
>4 5
(5 6
)6 7
;7 8
URL 
= 
$str 
; 
} 	
public 
int 

ApprovalId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
ContentReference 
ContentReference  0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
string 
ContentName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
ContentIcon !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
ContentType !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
? 
DateTime !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
Deadline !
{" #
get$ '
;' (
set) ,
;, -
}. /
public   
string   
	StartedBy   
{    !
get  " %
;  % &
set  ' *
;  * +
}  , -
public!! 
string!! 
WarningColor!! "
{!!# $
get!!% (
;!!( )
set!!* -
;!!- .
}!!/ 0
public"" 
bool"" 
NotificationUnread"" &
{""' (
get"") ,
;"", -
set"". 1
;""1 2
}""3 4
public## 
bool## 
CanUserPublish## "
{### $
get##% (
;##( )
set##* -
;##- .
}##/ 0
public$$ 
string$$ 
URL$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public%% 
IEnumerable%% 
<%% !
IContentChangeDetails%% 0
>%%0 1
Details%%2 9
{%%: ;
get%%< ?
;%%? @
set%%A D
;%%D E
}%%F G
}&& 
}'' æ
qC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\AdvancedTask\MovingPayLoad.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
AdvancedTask' 3
{ 
public 

class 
MovingPayLoad 
{ 
public 
ContentReference 
Source  &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public		 
ContentReference		 
Destination		  +
{		, -
get		. 1
;		1 2
set		3 6
;		6 7
}		8 9
}

 
} ÷
tC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Features\Container\ContainerController.cs
	namespace 	
AdvancedTaskManager
 
. 
Features &
.& '
	Container' 0
{ 
public 

class 
ContainerController $
:% &

Controller' 1
{ 
[		 	
	Authorize			 
(		 
Policy		 
=		 
	Constants		 %
.		% &

PolicyName		& 0
)		0 1
]		1 2
[

 	
HttpGet

	 
]

 
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
} 
} ‘"
ÉC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ApprovalCommandBase.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public		 

abstract		 
class		 
ApprovalCommandBase		 -
:		. /
IDynamicData		0 <
{

 
private 
bool 
_isReadOnly  
;  !
public 
virtual 
Identity 
Id  "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 

ApprovalID 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int !
LastApprovalStepIndex (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	
Ignore	 
] 
public 
ContentReference  
AppliedOnContentLink  4
{ 	
get 
=> 
ContentReference #
.# $
TryParse$ ,
(, -
AppliedOnContent- =
,= >
out? B
varC F
resultG M
)M N
?O P
resultQ W
:X Y
ContentReferenceZ j
.j k
EmptyReferencek y
;y z
set 
=> 
AppliedOnContent #
=$ %
ContentReference& 6
.6 7
IsNullOrEmpty7 D
(D E
valueE J
)J K
?L M
stringN T
.T U
EmptyU Z
:[ \
value] b
.b c%
ToReferenceWithoutVersionc |
(| }
)} ~
.~ 
ToString	 á
(
á à
)
à â
;
â ä
} 	
public 
string 
AppliedOnContent &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
CurrentSettingsJson )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
NewSettingsJson %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public   
CommandMetaData   
.   $
ChangeTaskApprovalStatus   7
CommandStatus  8 E
{  F G
get  H K
;  K L
set  M P
;  P Q
}  R S
public"" 
string"" 
	CreatedBy"" 
{""  !
get""" %
;""% &
set""' *
;""* +
}"", -
public$$ 
string$$ 
	ChangedBy$$ 
{$$  !
get$$" %
;$$% &
set$$' *
;$$* +
}$$, -
public&& 
DateTime&& 
CreatedTime&& #
{&&$ %
get&&& )
;&&) *
set&&+ .
;&&. /
}&&0 1
public(( 
DateTime(( 
Saved(( 
{(( 
get((  #
;((# $
set((% (
;((( )
}((* +
public** 
bool** 

IsReadOnly** 
{++ 	
get,, 
=>,, 
_isReadOnly,, 
;,, 
	protected-- 
set-- 
=>-- 
_isReadOnly-- (
=--) *
value--+ 0
;--0 1
}.. 	
public00 
virtual00 
bool00 
IsValid00 #
(00# $
)00$ %
{11 	
return22 
true22 
;22 
}33 	
public55 
object55 
CreateWritableClone55 )
(55) *
)55* +
{66 	
var77 
approvalCommandBase77 #
=77$ %
(77& '
ApprovalCommandBase77' :
)77: ;
MemberwiseClone77; J
(77J K
)77K L
;77L M
approvalCommandBase88 
.88  
_isReadOnly88  +
=88, -
false88. 3
;883 4
return99 
approvalCommandBase99 &
;99& '
}:: 	
}<< 
}== À
çC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ApprovalCommandRepositoryBase.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

	interface *
IApprovalCommandRepositoryBase 3
{ 
ApprovalCommandBase 
GetByCommandId *
<* +
T+ ,
>, -
(- .
Guid. 2
id3 5
,5 6
string7 =
type> B
)B C
whereD I
TJ K
:L M
ApprovalCommandBaseN a
;a b
}		 
public 

class )
ApprovalCommandRepositoryBase .
:/ 0*
IApprovalCommandRepositoryBase1 O
{ 
private 
readonly 1
%ChangeApprovalDynamicDataStoreFactory >2
&_changeApprovalDynamicDataStoreFactory? e
;e f
public )
ApprovalCommandRepositoryBase ,
(, -1
%ChangeApprovalDynamicDataStoreFactory- R1
%changeApprovalDynamicDataStoreFactoryS x
)x y
{ 	2
&_changeApprovalDynamicDataStoreFactory 2
=3 41
%changeApprovalDynamicDataStoreFactory5 Z
;Z [
} 	
public 
ApprovalCommandBase "
GetByCommandId# 1
<1 2
T2 3
>3 4
(4 5
Guid5 9
id: <
,< =
string> D
typeE I
)I J
whereK P
TQ R
:S T
ApprovalCommandBaseU h
{ 	
var 
store 
= 2
&_changeApprovalDynamicDataStoreFactory >
.> ?
GetStore? G
(G H
typeH L
)L M
;M N
var 
obj 
= 
store 
? 
. 
Items "
<" #
T# $
>$ %
(% &
)& '
.' (
FirstOrDefault( 6
(6 7
x7 8
=>9 ;
x< =
.= >
Id> @
.@ A

ExternalIdA K
==L N
idO Q
)Q R
;R S
return 
obj 
; 
} 	
} 
} Ω
~C:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ChangeApproval.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

class 
ChangeApproval 
:  !
Approval" *
{		 
private

 
ContentReference

  
_contentLink

! -
;

- .
public 
override 
Uri 
	Reference %
=>& ()
ChangeApprovalReferenceHelper) F
.F G
GetUriG M
(M N
_contentLinkN Z
,Z [
false\ a
)a b
;b c
public 
ContentReference 
ContentLink  +
{ 	
get 
=> 
_contentLink 
;  
set 
{ 
ThrowIfReadOnly 
(  
)  !
;! "
_contentLink 
= 
value $
;$ %
} 
} 	
public 
override 
Approval  
CreateWritableClone! 4
(4 5
)5 6
{ 	
var 
writableClone 
= 
base  $
.$ %
CreateWritableClone% 8
(8 9
)9 :
as; =
ChangeApproval> L
;L M
var 
contentLink 
= 
_contentLink *
;* +
if 
( 
writableClone 
!=  
null! %
)% &
{ 
writableClone 
. 
_contentLink *
=+ ,
contentLink- 8
!=9 ;
null< @
?   
contentLink   !
.  ! "
CreateWritableClone  " 5
(  5 6
)  6 7
:!! 
null!! 
;!! 
return"" 
writableClone"" $
;""$ %
}## 
return%% 
null%% 
;%% 
}&& 	
}'' 
}(( é
ïC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ChangeApprovalDynamicDataStoreFactory.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
[  
ServiceConfiguration 
( 
	Lifecycle #
=$ % 
ServiceInstanceScope& :
.: ;
	Singleton; D
)D E
]E F
public 

class 1
%ChangeApprovalDynamicDataStoreFactory 6
{ 
public		 
DynamicDataStore		 
GetStore		  (
(		( )
string		) /
name		0 4
)		4 5
{

 	
return #
DynamicDataStoreFactory *
.* +
Instance+ 3
.3 4
GetStore4 <
(< =
name= A
)A B
;B C
} 	
} 
} ∑
âC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ChangeApprovalTypeFactory.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

class %
ChangeApprovalTypeFactory *
:+ , 
IApprovalTypeFactory- A
{ 
public		 
static		 
readonly		 
string		 %
ChangeApprovalType		& 8
=		9 :
$str		; K
;		K L
private

 
readonly

 0
$IApprovalDefinitionReferenceResolver

 =&
_approvalReferenceResolver

> X
;

X Y
public %
ChangeApprovalTypeFactory (
(( )0
$IApprovalDefinitionReferenceResolver) M%
approvalReferenceResolverN g
)g h
{ 	&
_approvalReferenceResolver &
=' (%
approvalReferenceResolver) B
;B C
} 	
public 
string 
ApprovalType "
=># %
ChangeApprovalType& 8
;8 9
public 0
$IApprovalDefinitionReferenceResolver 3'
DefinitionReferenceResolver4 O
=>P R&
_approvalReferenceResolverS m
;m n
public %
IApprovalLanguageResolver (
LanguageResolver) 9
=>: <
null= A
;A B
public 
Approval 
CreateApproval &
(& '
Uri' *
	reference+ 4
)4 5
{ 	
return 
new 
ChangeApproval %
{ 
ContentLink 
= )
ChangeApprovalReferenceHelper ;
.; <
GetContentReference< O
(O P
	referenceP Y
)Y Z
} 
; 
} 	
public 
ApprovalDefinition !$
CreateApprovalDefinition" :
(: ;
Uri; >
	reference? H
)H I
{   	
throw!! 
new!! !
NotSupportedException!! +
(!!+ ,
$str!!, o
)!!o p
;!!p q
}"" 	
}## 
}$$ “
C:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\CommandMetaData.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
[ 
EPiServerDataStore 
( #
AutomaticallyRemapStore /
=0 1
true2 6
)6 7
]7 8
public		 

class		 
CommandMetaData		  
:		! "
IDynamicData		# /
{

 
private 
bool 
_isReadOnly  
;  !
public 
Identity 
Id 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
EPiServerDataIndex	 
] 
public 
int 

ApprovalId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
EPiServerDataIndex	 
] 
public 
Guid 
	CommandId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
EPiServerDataIndex	 
] 
public 
ContentReference 
AppliedOnContent  0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public $
ChangeTaskApprovalStatus '
CommandStatus( 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
public 
enum $
ChangeTaskApprovalStatus ,
{ 	
InReview 
, 
Approved   
}!! 	
public## 
bool## 

IsReadOnly## 
{$$ 	
get%% 
=>%% 
_isReadOnly%% 
;%% 
	protected&& 
set&& 
=>&& 
_isReadOnly&& (
=&&) *
value&&+ 0
;&&0 1
}'' 	
public)) 
void)) 
MakeReadOnly))  
())  !
)))! "
{** 	
_isReadOnly++ 
=++ 
true++ 
;++ 
},, 	
public.. 
object.. 
CreateWritableClone.. )
(..) *
)..* +
{// 	
var00 
commandMetaData00 
=00  !
(00" #
CommandMetaData00# 2
)002 3
MemberwiseClone003 B
(00B C
)00C D
;00D E
commandMetaData11 
.11 
_isReadOnly11 '
=11( )
false11* /
;11/ 0
return22 
commandMetaData22 "
;22" #
}33 	
}44 
}55 ö
zC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ContentACL.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

class 

ContentACL 
{ 
public 
IEnumerable 
< 
AccessControlEntry -
>- .
Entries/ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
public

 
bool

 
IsInherited

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
} 
} ∂
ÑC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ContentChangeDetails.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

class  
ContentChangeDetails %
:& '!
IContentChangeDetails( =
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
object 
OldValue 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
object		 
NewValue		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
}

 
} õ(
êC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\DefaultCommandMetaDataRepository.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
[  
ServiceConfiguration 
( 
ServiceType %
=& '
typeof( .
(. /&
ICommandMetaDataRepository/ I
)I J
)J K
]K L
public		 

class		 ,
 DefaultCommandMetaDataRepository		 1
:		2 3&
ICommandMetaDataRepository		4 N
{

 
private 
static 
readonly 
object  &
Lock' +
=, -
new. 1
(1 2
)2 3
;3 4
private 
readonly 1
%ChangeApprovalDynamicDataStoreFactory >2
&_changeApprovalDynamicDataStoreFactory? e
;e f
public ,
 DefaultCommandMetaDataRepository /
(/ 01
%ChangeApprovalDynamicDataStoreFactory
 /1
%changeApprovalDynamicDataStoreFactory0 U
)U V
{ 	2
&_changeApprovalDynamicDataStoreFactory 2
=3 41
%changeApprovalDynamicDataStoreFactory5 Z
;Z [
} 	
public 
CommandMetaData 
GetByApprovalId .
(. /
int/ 2

approvalId3 =
)= >
{ 	
var 
store 
= 2
&_changeApprovalDynamicDataStoreFactory >
.> ?
GetStore? G
(G H
$str	H Ä
)
Ä Å
;
Å Ç
if 
( 
store 
== 
null 
) 
return 
null 
; 
lock 
( 
Lock 
) 
{ 
return 
store 
. 
Items "
<" #
CommandMetaData# 2
>2 3
(3 4
)4 5
.5 6
SingleOrDefault6 E
(E F
(F G

ExpressionG Q
<Q R
FuncR V
<V W
CommandMetaDataW f
,f g
boolh l
>l m
>m n
)n o
(o p
commandp w
=>x z
command	{ Ç
.
Ç É

ApprovalId
É ç
==
é ê

approvalId
ë õ
)
õ ú
)
ú ù
;
ù û
} 
} 	
public   
CommandMetaData   
GetByCommandId   -
(  - .
Guid  . 2
	commandId  3 <
)  < =
{!! 	
var"" 
store"" 
="" 2
&_changeApprovalDynamicDataStoreFactory"" >
.""> ?
GetStore""? G
(""G H
$str	""H Ä
)
""Ä Å
;
""Å Ç
if## 
(## 
store## 
==## 
null## 
)## 
return$$ 
null$$ 
;$$ 
lock%% 
(%% 
Lock%% 
)%% 
{&& 
var'' 
commandMetaData'' #
=''$ %
store''& +
.''+ ,
Items'', 1
<''1 2
CommandMetaData''2 A
>''A B
(''B C
)''C D
.''D E
SingleOrDefault''E T
(''T U
(''U V

Expression''V `
<''` a
Func''a e
<''e f
CommandMetaData''f u
,''u v
bool''w {
>''{ |
>''| }
)''} ~
(''~ 
command	'' Ü
=>
''á â
command
''ä ë
.
''ë í
	CommandId
''í õ
==
''ú û
	commandId
''ü ®
)
''® ©
)
''© ™
;
''™ ´
return(( 
commandMetaData(( &
;((& '
})) 
}** 	
public-- 
Guid-- 
Save-- 
(-- 
CommandMetaData-- (
commandMetaData--) 8
)--8 9
{.. 	
var// 
store// 
=// 2
&_changeApprovalDynamicDataStoreFactory// >
.//> ?
GetStore//? G
(//G H
$str	//H Ä
)
//Ä Å
;
//Å Ç
if00 
(00 
store00 
==00 
null00 
)00 
return11 
Guid11 
.11 
Empty11 !
;11! "
lock22 
(22 
Lock22 
)22 
{33 
var44 
identity44 
=44 
store44 $
.44$ %
Save44% )
(44) *
commandMetaData44* 9
)449 :
;44: ;
return55 
identity55 
==55  "
null55# '
?55( )
Guid55* .
.55. /
Empty55/ 4
:555 6
identity557 ?
.55? @

ExternalId55@ J
;55J K
}66 
}77 	
}88 
}99 Ã,
áC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ExpirationChangeDetails.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public		 

	interface		 $
IExpirationChangeDetails		 -
{

 
IEnumerable 
< !
IContentChangeDetails )
>) *-
!GetExpirationCommandChangeDetails+ L
(L M
ChangeTaskViewModelM `
modela f
)f g
;g h
} 
public 

class #
ExpirationChangeDetails (
:) *$
IExpirationChangeDetails+ C
{ 
private 
readonly 
ILogger  
_logger! (
;( )
public #
ExpirationChangeDetails &
(& '
)' (
{ 	
_logger 
= 

LogManager  
.  !
	GetLogger! *
(* +
typeof+ 1
(1 2#
ExpirationChangeDetails2 I
)I J
)J K
;K L
} 	
public 
IEnumerable 
< !
IContentChangeDetails 0
>0 1-
!GetExpirationCommandChangeDetails2 S
(S T
ChangeTaskViewModelT g
modelh m
)m n
{ 	
var !
interceptPropertyList %
=& '
new( +
List, 0
<0 1
string1 7
>7 8
(8 9
)9 :
{; <
$str= N
,N O
$strP a
}b c
;c d
var $
contentChangeDetailsList (
=) *
new+ .
List/ 3
<3 4!
IContentChangeDetails4 I
>I J
(J K
)K L
;L M
try 
{ 
var 
dictionary1 
=  !
JsonConvert" -
.- .
DeserializeObject. ?
<? @
IDictionary@ K
<K L
stringL R
,R S
objectT Z
>Z [
>[ \
(\ ]
model] b
.b c
CurrentSettingsJsonc v
)v w
;w x
var 
dictionary2 
=  !
JsonConvert" -
.- .
DeserializeObject. ?
<? @
IDictionary@ K
<K L
stringL R
,R S
objectT Z
>Z [
>[ \
(\ ]
model] b
.b c
NewSettingsJsonc r
)r s
;s t
foreach   
(   
var   
interceptProperty   .
in  / 1!
interceptPropertyList  2 G
)  G H
{!! 
if"" 
("" 
dictionary1"" #
.""# $
ContainsKey""$ /
(""/ 0
interceptProperty""0 A
)""A B
)""B C
{## 
var$$ 
oldValue$$ $
=$$% &
dictionary1$$' 2
[$$2 3
interceptProperty$$3 D
]$$D E
;$$E F
var%% 
newValue%% $
=%%% &
dictionary2%%' 2
[%%2 3
interceptProperty%%3 D
]%%D E
;%%E F
var'' 
item''  
=''! "
new''# & 
ContentChangeDetails''' ;
{(( 
Name))  
=))! "+
GetExpirationDateSettingCommand))# B
())B C
interceptProperty))C T
.))T U
ToLowerInvariant))U e
())e f
)))f g
)))g h
,))h i
OldValue** $
=**% &
oldValue**' /
is**0 2
DateTime**3 ;
oldValueDateTime**< L
?++  !
oldValueDateTime++" 2
.++2 3
ToString++3 ;
(++; <
$str++< V
)++V W
:,,  !
oldValue,," *
,,,* +
NewValue-- $
=--% &
newValue--' /
is--0 2
DateTime--3 ;
newValueDateTime--< L
?..  !
newValueDateTime.." 2
...2 3
ToString..3 ;
(..; <
$str..< V
)..V W
://  !
newValue//" *
}00 
;00 $
contentChangeDetailsList22 0
.220 1
Add221 4
(224 5
item225 9
)229 :
;22: ;
}33 
}44 
}55 
catch66 
(66 
	Exception66 
ex66 
)66  
{77 
_logger88 
.88 
Error88 
(88 
ex88  
.88  !
Message88! (
,88( )
ex88* ,
)88, -
;88- .
}99 
return:: $
contentChangeDetailsList:: +
;::+ ,
};; 	
static== 
string== +
GetExpirationDateSettingCommand== 5
(==5 6
string==6 <
interceptProperty=== N
)==N O
{>> 	
switch?? 
(?? 
interceptProperty?? %
.??% &
ToLowerInvariant??& 6
(??6 7
)??7 8
)??8 9
{@@ 
caseAA 
$strAA &
:AA& '
returnBB 
$strBB '
;BB' (
caseCC 
$strCC &
:CC& '
returnDD 
$strDD ,
;DD, -
defaultEE 
:EE 
returnFF 
$strFF >
;FF> ?
}GG 
}HH 	
}II 
}JJ §$
åC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ExpirationDateSettingCommand.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
[ 
EPiServerDataStore 
( #
AutomaticallyRemapStore /
=0 1
true2 6
)6 7
]7 8
public 

class (
ExpirationDateSettingCommand -
:. /
ApprovalCommandBase0 C
,C D+
ICultureSpecificApprovalCommandE d
{ 
private 
Injected 
< 
IContentLoader '
>' (
_contentLoader) 7
;7 8
public 
string #
AppliedOnLanguageBranch -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
private 
static 
readonly 
ILogger  '
Logger( .
=/ 0

LogManager1 ;
.; <
	GetLogger< E
(E F
typeofF L
(L M(
ExpirationDateSettingCommandM i
)i j
)j k
;k l
public 
override 
bool 
IsValid $
($ %
)% &
{ 	
try 
{ 
var 

dictionary 
=  
JsonConvert! ,
., -
DeserializeObject- >
<> ?
IDictionary? J
<J K
stringK Q
,Q R
objectS Y
>Y Z
>Z [
([ \
NewSettingsJson\ k
)k l
;l m
var 
versionable 
=  !
(" #
string# )
.) *
IsNullOrEmpty* 7
(7 8#
AppliedOnLanguageBranch8 O
)O P
?Q R
_contentLoaderS a
.a b
Serviceb i
.i j
Getj m
<m n
IContentn v
>v w
(w x!
AppliedOnContentLink	x å
)
å ç
:
é è
_contentLoader
ê û
.
û ü
Service
ü ¶
.
¶ ß
Get
ß ™
<
™ ´
IContent
´ ≥
>
≥ ¥
(
¥ µ"
AppliedOnContentLink
µ …
,
…  
new
À Œ
CultureInfo
œ ⁄
(
⁄ €%
AppliedOnLanguageBranch
€ Ú
)
Ú Û
)
Û Ù
)
Ù ı
as
ˆ ¯
IVersionable
˘ Ö
;
Ö Ü
if 
( 

dictionary 
. 
TryGetValue *
(* +
$str+ <
,< =
out> A
varB E
objF I
)I J
&&K M
objN Q
isR T
DateTimeU ]
nullable^ f
&&g i
versionablej u
!=v x
nully }
)} ~
{ 
var 
startPublish $
=% &
versionable' 2
.2 3
StartPublish3 ?
;? @
if 
( 
startPublish $
.$ %
HasValue% -
)- .
{ 
ref 
var 
local2  &
=' (
ref) ,
nullable- 5
;5 6
startPublish   $
=  % &
versionable  ' 2
.  2 3
StartPublish  3 ?
;  ? @
if!! 
(!! 
startPublish!! (
!=!!) +
null!!, 0
)!!0 1
{"" 
var## 
	dateTime2##  )
=##* +
startPublish##, 8
.##8 9
Value##9 >
;##> ?
if$$ 
($$  
local2$$  &
.$$& '
	CompareTo$$' 0
($$0 1
	dateTime2$$1 :
)$$: ;
<$$< =
$num$$> ?
)$$? @
return%%  &
false%%' ,
;%%, -
}&& 
}'' 
}(( 
return)) 
true)) 
;)) 
}** 
catch++ 
(++ 
	Exception++ 
ex++ 
)++  
{,, 
Logger-- 
.-- 
Error-- 
(-- 
ex-- 
.--  
Message--  '
,--' (
ex--) +
)--+ ,
;--, -
return.. 
false.. 
;.. 
}// 
}00 	
}11 
}22 Ó
äC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ICommandMetaDataRepository.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

	interface &
ICommandMetaDataRepository /
{ 
CommandMetaData 
GetByApprovalId '
(' (
int( +

approvalId, 6
)6 7
;7 8
CommandMetaData 
GetByCommandId &
(& '
Guid' +
	commandId, 5
)5 6
;6 7
Guid		 
Save		 
(		 
CommandMetaData		 !
commandMetaData		" 1
)		1 2
;		2 3
}

 
} Œ
ÖC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\IContentChangeDetails.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

	interface !
IContentChangeDetails *
{ 
string 
Name 
{ 
get 
; 
set 
; 
}  !
object 
OldValue 
{ 
get 
; 
set "
;" #
}$ %
object		 
NewValue		 
{		 
get		 
;		 
set		 "
;		" #
}		$ %
}

 
} Â
èC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\ICultureSpecificApprovalCommand.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

	interface +
ICultureSpecificApprovalCommand 4
{ 
string #
AppliedOnLanguageBranch &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} À’
ÖC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\LanguageChangeDetails.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

	interface "
ILanguageChangeDetails +
{ 
IEnumerable 
< !
IContentChangeDetails )
>) *$
GetLanguageChangeDetails+ C
(C D
ChangeTaskViewModelD W
commandX _
)_ `
;` a
} 
public 

class !
LanguageChangeDetails &
:' ("
ILanguageChangeDetails) ?
{ 
private 
const 
string 
ArrowSeparator +
=, -
$str. 3
;3 4
private 
const 
string 
CommaSeparator +
=, -
$str. 2
;2 3
private 
readonly %
ILanguageBranchRepository 2%
_languageBranchRepository3 L
;L M
private 
readonly +
IContentLanguageSettingsHandler 8+
_contentLanguageSettingsHandler9 X
;X Y
private 
readonly 
IContentRepository +
_contentRepository, >
;> ?
public !
LanguageChangeDetails $
($ %%
ILanguageBranchRepository% >$
languageBranchRepository? W
,W X+
IContentLanguageSettingsHandlerY x+
contentLanguageSettingsHandler	y ó
,
ó ò 
IContentRepository
ô ´
contentRepository
¨ Ω
)
Ω æ
{ 	%
_languageBranchRepository %
=& '$
languageBranchRepository( @
;@ A+
_contentLanguageSettingsHandler +
=, -*
contentLanguageSettingsHandler. L
;L M
_contentRepository   
=    
contentRepository  ! 2
;  2 3
}!! 	
public%% 
IEnumerable%% 
<%% !
IContentChangeDetails%% 0
>%%0 1$
GetLanguageChangeDetails%%2 J
(%%J K
ChangeTaskViewModel%%K ^
command%%_ f
)%%f g
{&& 	
var'' $
contentChangeDetailsList'' (
='') *
new''+ .
List''/ 3
<''3 4!
IContentChangeDetails''4 I
>''I J
(''J K
)''K L
;''L M
var(( 
parent(( 
=(( 
	GetParent(( "
(((" #
command((# *
.((* + 
AppliedOnContentLink((+ ?
)((? @
;((@ A
var)) 
settingsFromJson1)) !
=))" #.
"GetContentLanguageSettingsFromJson))$ F
())F G
command))G N
.))N O
CurrentSettingsJson))O b
)))b c
;))c d
var** 
settingsFromJson2** !
=**" #.
"GetContentLanguageSettingsFromJson**$ F
(**F G
command**G N
.**N O
NewSettingsJson**O ^
)**^ _
;**_ `
var++ 
flag++ 
=++ 
!++ 
ContentReference++ (
.++( )
IsNullOrEmpty++) 6
(++6 7
parent++7 =
)++= >
;++> ?
var,, 

dictionary,, 
=,, 
(,, 
(,, 
settingsFromJson2,, 0
==,,1 3
null,,4 8
?,,9 :
$num,,; <
:,,= >
settingsFromJson2,,? P
.,,P Q
Count,,Q V
==,,W Y
$num,,Z [
?,,\ ]
$num,,^ _
:,,` a
$num,,b c
),,c d
&,,e f
(,,g h
flag,,h l
?,,m n
$num,,o p
:,,q r
$num,,s t
),,t u
),,u v
!=,,w y
$num,,z {
?,,| } 
GetLanguageSettings	,,~ ë
(
,,ë í
parent
,,í ò
)
,,ò ô
:
,,ö õ
settingsFromJson2
,,ú ≠
;
,,≠ Æ
if-- 
(-- 
flag-- 
)-- 
{.. 
var// 
str1// 
=// 
$str//  
;//  !
var00 
str200 
=00 
$str00 
;00  $
contentChangeDetailsList11 (
.11( )
Add11) ,
(11, -
new11- 0 
ContentChangeDetails111 E
(11E F
)11F G
{22 
Name33 
=33 
$str33 B
,33B C
OldValue44 
=44 
settingsFromJson144 0
.440 1
Values441 7
.447 8
Any448 ;
(44; <
st44< >
=>44? A
st44B D
.44D E
DefinedOnContent44E U
.44U V!
CompareToIgnoreWorkID44V k
(44k l
command44l s
.44s t!
AppliedOnContentLink	44t à
)
44à â
)
44â ä
?
44ã å
str2
44ç ë
:
44í ì
str1
44î ò
,
44ò ô
NewValue55 
=55 

dictionary55 )
!=55* ,
null55- 1
&&552 4

dictionary555 ?
.55? @
Values55@ F
.55F G
Any55G J
(55J K
st55K M
=>55N P
st55Q S
.55S T
DefinedOnContent55T d
.55d e!
CompareToIgnoreWorkID55e z
(55z {
command	55{ Ç
.
55Ç É"
AppliedOnContentLink
55É ó
)
55ó ò
)
55ò ô
?
55ö õ
str2
55ú †
:
55° ¢
str1
55£ ß
}66 
)66 
;66 
}77 
var88 
currentLanguages88  
=88! "
settingsFromJson188# 4
.884 5
Where885 :
(88: ;
s88; <
=>88= ?
s88@ A
.88A B
Value88B G
.88G H
IsActive88H P
)88P Q
.88Q R
Select88R X
(88X Y
s88Y Z
=>88[ ]
s88^ _
.88_ `
Value88` e
.88e f
LanguageBranch88f t
)88t u
.88u v
ToList88v |
(88| }
)88} ~
;88~ 
if99 
(99 

dictionary99 
!=99 
null99 "
)99" #
{:: 
var;; 
newLanguages;;  
=;;! "

dictionary;;# -
.;;- .
Where;;. 3
(;;3 4
s;;4 5
=>;;6 8
s;;9 :
.;;: ;
Value;;; @
.;;@ A
IsActive;;A I
);;I J
.;;J K
Select;;K Q
(;;Q R
s;;R S
=>;;T V
s;;W X
.;;X Y
Value;;Y ^
.;;^ _
LanguageBranch;;_ m
);;m n
.;;n o
ToList;;o u
(;;u v
);;v w
;;;w x$
contentChangeDetailsList<< (
.<<( )
Add<<) ,
(<<, -
new<<- 0 
ContentChangeDetails<<1 E
(<<E F
)<<F G
{== 
Name>> 
=>> 
$str>> 0
,>>0 1
OldValue?? 
=?? (
FormatLanguageSettingsChange?? ;
(??; <
currentLanguages??< L
,??L M
newLanguages??N Z
,??Z [
true??\ `
)??` a
,??a b
NewValue@@ 
=@@ (
FormatLanguageSettingsChange@@ ;
(@@; <
currentLanguages@@< L
,@@L M
newLanguages@@N Z
,@@Z [
false@@\ a
)@@a b
}AA 
)AA 
;AA 
}BB 
varDD 
str3DD 
=DD (
OldFallbackLanguagesToStringDD 3
(DD3 4
settingsFromJson1DD4 E
,DDE F

dictionaryDDG Q
)DDQ R
;DDR S
varEE 
str4EE 
=EE (
NewFallbackLanguagesToStringEE 3
(EE3 4
settingsFromJson1EE4 E
,EEE F

dictionaryEEG Q
)EEQ R
;EER S$
contentChangeDetailsListFF $
.FF$ %
AddFF% (
(FF( )
newFF) , 
ContentChangeDetailsFF- A
(FFA B
)FFB C
{GG 
NameHH 
=HH 
$strHH +
,HH+ ,
OldValueII 
=II 
str3II 
,II  
NewValueJJ 
=JJ 
str4JJ 
}KK 
)KK 
;KK 
varLL 
str5LL 
=LL +
OldReplacementLanguagesToStringLL 6
(LL6 7
settingsFromJson1LL7 H
,LLH I

dictionaryLLJ T
)LLT U
;LLU V
varMM 
str6MM 
=MM +
NewReplacementLanguagesToStringMM 6
(MM6 7
settingsFromJson1MM7 H
,MMH I

dictionaryMMJ T
)MMT U
;MMU V$
contentChangeDetailsListNN $
.NN$ %
AddNN% (
(NN( )
newNN) , 
ContentChangeDetailsNN- A
(NNA B
)NNB C
{OO 
NamePP 
=PP 
$strPP .
,PP. /
OldValueQQ 
=QQ 
str5QQ 
,QQ  
NewValueRR 
=RR 
str6RR 
}SS 
)SS 
;SS 
returnTT $
contentChangeDetailsListTT +
;TT+ ,
}UU 	
privateWW 
ContentReferenceWW  
	GetParentWW! *
(WW* +
ContentReferenceWW+ ;
contentLinkWW< G
)WWG H
{XX 	
varYY 
contentYY 
=YY 
_contentRepositoryYY ,
.YY, -
GetYY- 0
<YY0 1
IContentYY1 9
>YY9 :
(YY: ;
contentLinkYY; F
,YYF G
LanguageSelectorYYH X
.YYX Y

AutoDetectYYY c
(YYc d
trueYYd h
)YYh i
)YYi j
;YYj k
ifZZ 
(ZZ 
contentZZ 
==ZZ 
nullZZ 
)ZZ  
return[[ 
null[[ 
;[[ 
var\\ 
source\\ 
=\\ +
_contentLanguageSettingsHandler\\ 8
.\\8 9
Get\\9 <
(\\< =
content\\= D
.\\D E

ParentLink\\E O
)\\O P
;\\P Q
return]] 
source]] 
?]] 
.]] 
FirstOrDefault]] )
(]]) *
)]]* +
?]]+ ,
.]], -
DefinedOnContent]]- =
;]]= >
}^^ 	
private`` 
string`` 
GetLanguageName`` &
(``& '
string``' -
languageCode``. :
)``: ;
{aa 	
ifbb 
(bb 
stringbb 
.bb 
IsNullOrEmptybb $
(bb$ %
languageCodebb% 1
)bb1 2
)bb2 3
returncc 
stringcc 
.cc 
Emptycc #
;cc# $
vardd 
languageBranchdd 
=dd  %
_languageBranchRepositorydd! :
.dd: ;
Loaddd; ?
(dd? @
languageCodedd@ L
)ddL M
;ddM N
returnee 
languageBranchee !
==ee" $
nullee% )
?ee* +
stringee, 2
.ee2 3
Emptyee3 8
:ee9 :
languageBranchee; I
.eeI J
NameeeJ N
;eeN O
}ff 	
privatehh 
stringhh 
StringifyLanguageshh )
(hh) *
IEnumerablehh* 5
<hh5 6
stringhh6 <
>hh< =
	languageshh> G
,hhG H
stringhhI O
	separatorhhP Y
)hhY Z
{ii 	
returnjj 
	languagesjj 
.jj 
	Aggregatejj &
(jj& '
stringjj' -
.jj- .
Emptyjj. 3
,jj3 4
(jj5 6

workingStrjj6 @
,jj@ A
nextjjB F
)jjF G
=>jjH J
$"jjK M
{jjM N

workingStrjjN X
}jjX Y
{jjY Z
	separatorjjZ c
}jjc d
{jjd e
GetLanguageNamejje t
(jjt u
nextjju y
)jjy z
}jjz {
"jj{ |
)jj| }
.jj} ~
	TrimStart	jj~ á
(
jjá à
	separator
jjà ë
.
jjë í
ToCharArray
jjí ù
(
jjù û
)
jjû ü
)
jjü †
;
jj† °
}kk 	
privatemm 
stringmm (
FormatLanguageSettingsChangemm 3
(mm3 4
Listmm4 8
<mm8 9
stringmm9 ?
>mm? @
currentLanguagesmmA Q
,mmQ R
ListmmS W
<mmW X
stringmmX ^
>mm^ _
newLanguagesmm` l
,mml m
boolmmn r
originalmms {
)mm{ |
{nn 	
varoo 
stroo 
=oo 
stringoo 
.oo 
Emptyoo "
;oo" #
ifpp 
(pp 
!pp 
currentLanguagespp !
.pp! "
Exceptpp" (
(pp( )
newLanguagespp) 5
)pp5 6
.pp6 7
Anypp7 :
(pp: ;
)pp; <
&&pp= ?
!pp@ A
newLanguagesppA M
.ppM N
ExceptppN T
(ppT U
currentLanguagesppU e
)ppe f
.ppf g
Anyppg j
(ppj k
)ppk l
)ppl m
strqq 
=qq 
StringifyLanguagesqq (
(qq( )
currentLanguagesqq) 9
,qq9 :
CommaSeparatorqq; I
)qqI J
.qqJ K
FadeqqK O
(qqO P
)qqP Q
;qqQ R
elserr 
ifrr 
(rr 
originalrr 
)rr 
{ss 
strtt 
=tt 
StringifyLanguagestt (
(tt( )
currentLanguagestt) 9
,tt9 :
CommaSeparatortt; I
)ttI J
;ttJ K
}uu 
elsevv 
{ww 
foreachxx 
(xx 
varxx 
currentLangxx (
inxx) +
currentLanguagesxx, <
)xx< =
{yy 
varzz 
itemzz 
=zz 
currentLangzz *
;zz* +
var{{ 
languageName{{ $
={{% &
GetLanguageName{{' 6
({{6 7
item{{7 ;
){{; <
;{{< =
str|| 
=|| 
newLanguages|| &
.||& '
Any||' *
(||* +
lang||+ /
=>||0 2
lang||3 7
.||7 8
Equals||8 >
(||> ?
item||? C
,||C D
StringComparison||E U
.||U V&
InvariantCultureIgnoreCase||V p
)||p q
)||q r
?||s t
str||u x
+||y z
$"}} 
{}} 
languageName}} '
}}}' (
{}}( )
CommaSeparator}}) 7
}}}7 8
"}}8 9
:~~ 
str~~ 
+~~ 
$"~~  "
{~~" #
languageName~~# /
.~~/ 0
Strikethrough~~0 =
(~~= >
)~~> ?
}~~? @
{~~@ A
CommaSeparator~~A O
}~~O P
"~~P Q
;~~Q R
} 
foreach
ÅÅ 
(
ÅÅ 
var
ÅÅ 
newLang
ÅÅ $
in
ÅÅ% '
newLanguages
ÅÅ( 4
)
ÅÅ4 5
{
ÇÇ 
var
ÉÉ 
item
ÉÉ 
=
ÉÉ 
newLang
ÉÉ &
;
ÉÉ& '
var
ÑÑ 
languageName
ÑÑ $
=
ÑÑ% &
GetLanguageName
ÑÑ' 6
(
ÑÑ6 7
item
ÑÑ7 ;
)
ÑÑ; <
;
ÑÑ< =
if
ÖÖ 
(
ÖÖ 
!
ÖÖ 
string
ÖÖ 
.
ÖÖ   
IsNullOrWhiteSpace
ÖÖ  2
(
ÖÖ2 3
languageName
ÖÖ3 ?
)
ÖÖ? @
&&
ÖÖA C
!
ÖÖD E
currentLanguages
ÖÖE U
.
ÖÖU V
Any
ÖÖV Y
(
ÖÖY Z
lang
ÖÖZ ^
=>
ÖÖ_ a
lang
ÖÖb f
.
ÖÖf g
Equals
ÖÖg m
(
ÖÖm n
item
ÖÖn r
,
ÖÖr s
StringComparisonÖÖt Ñ
.ÖÖÑ Ö*
InvariantCultureIgnoreCaseÖÖÖ ü
)ÖÖü †
)ÖÖ† °
)ÖÖ° ¢
str
ÜÜ 
+=
ÜÜ 
$"
ÜÜ !
{
ÜÜ! "
languageName
ÜÜ" .
.
ÜÜ. /
Bold
ÜÜ/ 3
(
ÜÜ3 4
)
ÜÜ4 5
}
ÜÜ5 6
{
ÜÜ6 7
CommaSeparator
ÜÜ7 E
}
ÜÜE F
"
ÜÜF G
;
ÜÜG H
}
áá 
}
àà 
return
ââ 
str
ââ 
.
ââ 
TrimEnd
ââ 
(
ââ 
CommaSeparator
ââ -
)
ââ- .
;
ââ. /
}
ää 	
private
åå 
static
åå 
List
åå 
<
åå 
string
åå "
>
åå" #"
GetFallbackLanguages
åå$ 8
(
åå8 9
string
åå9 ?
visitorLanguage
åå@ O
,
ååO P
IDictionary
ååQ \
<
åå\ ]
string
åå] c
,
ååc d$
ContentLanguageSetting
ååe {
>
åå{ |
settingsåå} Ö
)ååÖ Ü
{
çç 	
return
éé 
settings
éé 
==
éé 
null
éé #
||
éé$ &
!
éé' (
settings
éé( 0
.
éé0 1
ContainsKey
éé1 <
(
éé< =
visitorLanguage
éé= L
)
ééL M
||
ééN P
settings
ééQ Y
[
ééY Z
visitorLanguage
ééZ i
]
ééi j
.
ééj k%
LanguageBranchFallbackéék Å
==ééÇ Ñ
nullééÖ â
?ééä ã
Arrayééå ë
.ééë í
Emptyééí ó
<ééó ò
stringééò û
>ééû ü
(ééü †
)éé† °
.éé° ¢
ToListéé¢ ®
(éé® ©
)éé© ™
:éé´ ¨
settingséé≠ µ
[ééµ ∂
visitorLanguageéé∂ ≈
]éé≈ ∆
.éé∆ «&
LanguageBranchFallbackéé« ›
.éé› ﬁ
ToListééﬁ ‰
(éé‰ Â
)ééÂ Ê
;ééÊ Á
}
èè 	
private
ëë 
string
ëë *
OldFallbackLanguagesToString
ëë 3
(
ëë3 4
IDictionary
ëë4 ?
<
ëë? @
string
ëë@ F
,
ëëF G$
ContentLanguageSetting
ëëH ^
>
ëë^ _
oldSettings
ëë` k
,
ëëk l
IDictionary
ëëm x
<
ëëx y
string
ëëy 
,ëë Ä&
ContentLanguageSettingëëÅ ó
>ëëó ò
newSettingsëëô §
)ëë§ •
{
íí 	
var
ìì 
stringBuilder
ìì 
=
ìì 
new
ìì  #
StringBuilder
ìì$ 1
(
ìì1 2
)
ìì2 3
;
ìì3 4
foreach
îî 
(
îî 
var
îî 
key
îî 
in
îî 
oldSettings
îî  +
.
îî+ ,
Keys
îî, 0
)
îî0 1
{
ïï 
var
ññ  
fallbackLanguages1
ññ &
=
ññ' ("
GetFallbackLanguages
ññ) =
(
ññ= >
key
ññ> A
,
ññA B
oldSettings
ññC N
)
ññN O
;
ññO P
var
óó  
fallbackLanguages2
óó &
=
óó' ("
GetFallbackLanguages
óó) =
(
óó= >
key
óó> A
,
óóA B
newSettings
óóC N
)
óóN O
;
óóO P
if
òò 
(
òò 
(
òò  
fallbackLanguages1
òò '
.
òò' (
Count
òò( -
!=
òò. 0
$num
òò1 2
||
òò3 5 
fallbackLanguages2
òò6 H
.
òòH I
Count
òòI N
!=
òòO Q
$num
òòR S
)
òòS T
&&
òòU W
(
òòX Y 
fallbackLanguages1
òòY k
.
òòk l
Any
òòl o
(
òòo p
item
òòp t
=>
òòu w
!
òòx y
string
òòy 
.òò Ä"
IsNullOrWhiteSpaceòòÄ í
(òòí ì
GetLanguageNameòòì ¢
(òò¢ £
itemòò£ ß
)òòß ®
)òò® ©
)òò© ™
||òò´ ≠"
fallbackLanguages2òòÆ ¿
.òò¿ ¡
Anyòò¡ ƒ
(òòƒ ≈
itemòò≈ …
=>òò  Ã
!òòÕ Œ
stringòòŒ ‘
.òò‘ ’"
IsNullOrWhiteSpaceòò’ Á
(òòÁ Ë
GetLanguageNameòòË ˜
(òò˜ ¯
itemòò¯ ¸
)òò¸ ˝
)òò˝ ˛
)òò˛ ˇ
)òòˇ Ä
)òòÄ Å
{
ôô 
var
öö 
languageName
öö $
=
öö% &
GetLanguageName
öö' 6
(
öö6 7
key
öö7 :
)
öö: ;
;
öö; <
if
õõ 
(
õõ  
fallbackLanguages1
õõ *
.
õõ* +
Count
õõ+ 0
>
õõ1 2
$num
õõ3 4
)
õõ4 5
{
úú 
var
ùù 
str1
ùù  
=
ùù! " 
StringifyLanguages
ùù# 5
(
ùù5 6 
fallbackLanguages1
ùù6 H
,
ùùH I
ArrowSeparator
ùùJ X
)
ùùX Y
;
ùùY Z
var
ûû 
str2
ûû  
=
ûû! " 
fallbackLanguages1
ûû# 5
.
ûû5 6
SequenceEqual
ûû6 C
(
ûûC D 
fallbackLanguages2
ûûD V
)
ûûV W
?
ûûX Y
$"
ûûZ \
{
ûû\ ]
languageName
ûû] i
}
ûûi j
{
ûûj k
ArrowSeparator
ûûk y
}
ûûy z
{
ûûz {
str1
ûû{ 
}ûû Ä
"ûûÄ Å
.
üü 
Fade
üü !
(
üü! "
)
üü" #
:
üü$ %
$"
üü& (
{
üü( )
languageName
üü) 5
}
üü5 6
{
üü6 7
ArrowSeparator
üü7 E
}
üüE F
{
üüF G
str1
üüG K
}
üüK L
"
üüL M
;
üüM N
stringBuilder
†† %
.
††% &
Append
††& ,
(
††, -
str2
††- 1
)
††1 2
;
††2 3
}
°° 
else
¢¢ 
stringBuilder
££ %
.
££% &
Append
££& ,
(
££, -
$"
££- /
{
££/ 0
languageName
££0 <
}
££< =
{
££= >
ArrowSeparator
££> L
}
££L M
$str
££M Q
"
££Q R
)
££R S
;
££S T
stringBuilder
§§ !
.
§§! "
Append
§§" (
(
§§( )
$str
§§) 0
)
§§0 1
;
§§1 2
}
•• 
}
¶¶ 
return
ßß 
stringBuilder
ßß  
.
ßß  !
ToString
ßß! )
(
ßß) *
)
ßß* +
.
ßß+ ,
TrimEnd
ßß, 3
(
ßß3 4
$str
ßß4 ;
)
ßß; <
;
ßß< =
}
®® 	
private
™™ 
string
™™ *
NewFallbackLanguagesToString
™™ 3
(
™™3 4
IDictionary
™™4 ?
<
™™? @
string
™™@ F
,
™™F G$
ContentLanguageSetting
™™H ^
>
™™^ _
oldSettings
™™` k
,
™™k l
IDictionary
™™m x
<
™™x y
string
™™y 
,™™ Ä&
ContentLanguageSetting™™Å ó
>™™ó ò
newSettings™™ô §
)™™§ •
{
´´ 	
var
¨¨ 
stringBuilder
¨¨ 
=
¨¨ 
new
¨¨  #
StringBuilder
¨¨$ 1
(
¨¨1 2
)
¨¨2 3
;
¨¨3 4
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
key
≠≠ 
in
≠≠ 
newSettings
≠≠  +
.
≠≠+ ,
Keys
≠≠, 0
)
≠≠0 1
{
ÆÆ 
var
ØØ  
fallbackLanguages1
ØØ &
=
ØØ' ("
GetFallbackLanguages
ØØ) =
(
ØØ= >
key
ØØ> A
,
ØØA B
newSettings
ØØC N
)
ØØN O
;
ØØO P
var
∞∞  
fallbackLanguages2
∞∞ &
=
∞∞' ("
GetFallbackLanguages
∞∞) =
(
∞∞= >
key
∞∞> A
,
∞∞A B
oldSettings
∞∞C N
)
∞∞N O
;
∞∞O P
if
±± 
(
±±  
fallbackLanguages2
±± &
.
±±& '
Count
±±' ,
>
±±- .
$num
±±/ 0
||
±±1 3 
fallbackLanguages1
±±4 F
.
±±F G
Count
±±G L
>
±±M N
$num
±±O P
)
±±P Q
{
≤≤ 
var
≥≥ 
languageName1
≥≥ %
=
≥≥& '
GetLanguageName
≥≥( 7
(
≥≥7 8
key
≥≥8 ;
)
≥≥; <
;
≥≥< =
if
¥¥ 
(
¥¥ 
!
¥¥ 
string
¥¥ 
.
¥¥   
IsNullOrWhiteSpace
¥¥  2
(
¥¥2 3
languageName1
¥¥3 @
)
¥¥@ A
)
¥¥A B
{
µµ 
if
∂∂ 
(
∂∂  
fallbackLanguages1
∂∂ .
.
∂∂. /
SequenceEqual
∂∂/ <
(
∂∂< = 
fallbackLanguages2
∂∂= O
)
∂∂O P
)
∂∂P Q
{
∑∑ 
var
∏∏ 
str
∏∏  #
=
∏∏$ % 
StringifyLanguages
∏∏& 8
(
∏∏8 9 
fallbackLanguages1
∏∏9 K
,
∏∏K L
ArrowSeparator
∏∏M [
)
∏∏[ \
;
∏∏\ ]
stringBuilder
ππ )
.
ππ) *
Append
ππ* 0
(
ππ0 1
$"
ππ1 3
{
ππ3 4
languageName1
ππ4 A
}
ππA B
{
ππB C
ArrowSeparator
ππC Q
}
ππQ R
{
ππR S
str
ππS V
}
ππV W
"
ππW X
.
ππX Y
Fade
ππY ]
(
ππ] ^
)
ππ^ _
)
ππ_ `
;
ππ` a
}
∫∫ 
else
ªª 
if
ªª 
(
ªª  ! 
fallbackLanguages1
ªª! 3
.
ªª3 4
Count
ªª4 9
==
ªª: <
$num
ªª= >
&&
ªª? A 
fallbackLanguages2
ªªB T
.
ªªT U
Count
ªªU Z
>
ªª[ \
$num
ªª] ^
)
ªª^ _
{
ºº 
var
ΩΩ 
str
ΩΩ  #
=
ΩΩ$ % 
StringifyLanguages
ΩΩ& 8
(
ΩΩ8 9 
fallbackLanguages2
ΩΩ9 K
,
ΩΩK L
ArrowSeparator
ΩΩM [
)
ΩΩ[ \
;
ΩΩ\ ]
stringBuilder
ææ )
.
ææ) *
Append
ææ* 0
(
ææ0 1
$"
ææ1 3
{
ææ3 4
languageName1
ææ4 A
}
ææA B
{
ææB C
ArrowSeparator
ææC Q
}
ææQ R
{
ææR S
str
ææS V
}
ææV W
"
ææW X
.
ææX Y
Strikethrough
ææY f
(
ææf g
)
ææg h
)
ææh i
;
ææi j
}
øø 
else
¿¿ 
if
¿¿ 
(
¿¿  ! 
fallbackLanguages1
¿¿! 3
.
¿¿3 4
Count
¿¿4 9
>
¿¿: ;
$num
¿¿< =
)
¿¿= >
{
¡¡ 
if
¬¬ 
(
¬¬  
(
¬¬  ! 
fallbackLanguages2
¬¬! 3
.
¬¬3 4
Count
¬¬4 9
!=
¬¬: <
$num
¬¬= >
||
¬¬? A 
fallbackLanguages1
¬¬B T
.
¬¬T U
Count
¬¬U Z
!=
¬¬[ ]
$num
¬¬^ _
)
¬¬_ `
&&
¬¬a c
(
¬¬d e 
fallbackLanguages2
¬¬e w
.
¬¬w x
Any
¬¬x {
(
¬¬{ |
item¬¬| Ä
=>¬¬Å É
!¬¬Ñ Ö
string¬¬Ö ã
.¬¬ã å"
IsNullOrWhiteSpace¬¬å û
(¬¬û ü
GetLanguageName¬¬ü Æ
(¬¬Æ Ø
item¬¬Ø ≥
)¬¬≥ ¥
)¬¬¥ µ
)¬¬µ ∂
||¬¬∑ π"
fallbackLanguages1¬¬∫ Ã
.¬¬Ã Õ
Any¬¬Õ –
(¬¬– —
item¬¬— ’
=>¬¬÷ ÿ
!¬¬Ÿ ⁄
string¬¬⁄ ‡
.¬¬‡ ·"
IsNullOrWhiteSpace¬¬· Û
(¬¬Û Ù
GetLanguageName¬¬Ù É
(¬¬É Ñ
item¬¬Ñ à
)¬¬à â
)¬¬â ä
)¬¬ä ã
)¬¬ã å
)¬¬å ç
{
√√ 
stringBuilder
ƒƒ  -
.
ƒƒ- .
Append
ƒƒ. 4
(
ƒƒ4 5
languageName1
ƒƒ5 B
)
ƒƒB C
;
ƒƒC D
foreach
≈≈  '
(
≈≈( )
var
≈≈) ,
languageCode
≈≈- 9
in
≈≈: < 
fallbackLanguages2
≈≈= O
)
≈≈O P
{
∆∆  !
var
««$ '
str
««( +
=
««, - 
fallbackLanguages1
««. @
.
««@ A
Contains
««A I
(
««I J
languageCode
««J V
)
««V W
?
««X Y
$"
««Z \
{
««\ ]
ArrowSeparator
««] k
}
««k l
{
««l m
GetLanguageName
««m |
(
««| }
languageCode««} â
)««â ä
}««ä ã
"««ã å
:
»»( )
$"
»»* ,
{
»», -
ArrowSeparator
»»- ;
}
»»; <
{
»»< =
GetLanguageName
»»= L
(
»»L M
languageCode
»»M Y
)
»»Y Z
.
»»Z [
Strikethrough
»»[ h
(
»»h i
)
»»i j
}
»»j k
"
»»k l
;
»»l m
stringBuilder
……$ 1
.
……1 2
Append
……2 8
(
……8 9
str
……9 <
)
……< =
;
……= >
}
    !
foreach
ÀÀ  '
(
ÀÀ( )
var
ÀÀ) ,
languageCode
ÀÀ- 9
in
ÀÀ: < 
fallbackLanguages1
ÀÀ= O
)
ÀÀO P
{
ÃÃ  !
var
ÕÕ$ '
languageName2
ÕÕ( 5
=
ÕÕ6 7
GetLanguageName
ÕÕ8 G
(
ÕÕG H
languageCode
ÕÕH T
)
ÕÕT U
;
ÕÕU V
if
ŒŒ$ &
(
ŒŒ' (
!
ŒŒ( )
string
ŒŒ) /
.
ŒŒ/ 0 
IsNullOrWhiteSpace
ŒŒ0 B
(
ŒŒB C
languageName2
ŒŒC P
)
ŒŒP Q
&&
ŒŒR T
!
ŒŒU V 
fallbackLanguages2
ŒŒV h
.
ŒŒh i
Contains
ŒŒi q
(
ŒŒq r
languageCode
ŒŒr ~
)
ŒŒ~ 
)ŒŒ Ä
stringBuilder
œœ( 5
.
œœ5 6
Append
œœ6 <
(
œœ< =
$"
œœ= ?
{
œœ? @
ArrowSeparator
œœ@ N
}
œœN O
{
œœO P
languageName2
œœP ]
.
œœ] ^
Bold
œœ^ b
(
œœb c
)
œœc d
}
œœd e
"
œœe f
)
œœf g
;
œœg h
}
––  !
}
—— 
else
““  
continue
””  (
;
””( )
}
‘‘ 
stringBuilder
’’ %
.
’’% &
Append
’’& ,
(
’’, -
$str
’’- 4
)
’’4 5
;
’’5 6
}
÷÷ 
}
◊◊ 
}
ÿÿ 
return
ŸŸ 
stringBuilder
ŸŸ  
.
ŸŸ  !
ToString
ŸŸ! )
(
ŸŸ) *
)
ŸŸ* +
.
ŸŸ+ ,
TrimEnd
ŸŸ, 3
(
ŸŸ3 4
$str
ŸŸ4 ;
)
ŸŸ; <
;
ŸŸ< =
}
⁄⁄ 	
private
‹‹ 
string
‹‹ $
GetReplacementLanguage
‹‹ -
(
‹‹- .
string
‹‹. 4
visitorLanguage
‹‹5 D
,
‹‹D E
IDictionary
‹‹F Q
<
‹‹Q R
string
‹‹R X
,
‹‹X Y$
ContentLanguageSetting
‹‹Z p
>
‹‹p q
settings
‹‹r z
)
‹‹z {
{
›› 	
return
ﬁﬁ 
settings
ﬁﬁ 
==
ﬁﬁ 
null
ﬁﬁ #
||
ﬁﬁ$ &
!
ﬁﬁ' (
settings
ﬁﬁ( 0
.
ﬁﬁ0 1
ContainsKey
ﬁﬁ1 <
(
ﬁﬁ< =
visitorLanguage
ﬁﬁ= L
)
ﬁﬁL M
||
ﬁﬁN P
settings
ﬁﬁQ Y
[
ﬁﬁY Z
visitorLanguage
ﬁﬁZ i
]
ﬁﬁi j
.
ﬁﬁj k(
ReplacementLanguageBranchﬁﬁk Ñ
==ﬁﬁÖ á
nullﬁﬁà å
?ﬁﬁç é
stringﬁﬁè ï
.ﬁﬁï ñ
Emptyﬁﬁñ õ
:ﬁﬁú ù
GetLanguageNameﬁﬁû ≠
(ﬁﬁ≠ Æ
settingsﬁﬁÆ ∂
[ﬁﬁ∂ ∑
visitorLanguageﬁﬁ∑ ∆
]ﬁﬁ∆ «
.ﬁﬁ« »)
ReplacementLanguageBranchﬁﬁ» ·
)ﬁﬁ· ‚
;ﬁﬁ‚ „
}
ﬂﬂ 	
private
·· 
string
·· -
OldReplacementLanguagesToString
·· 6
(
··6 7
IDictionary
··7 B
<
··B C
string
··C I
,
··I J$
ContentLanguageSetting
··K a
>
··a b
oldSettings
··c n
,
··n o
IDictionary
··p {
<
··{ |
string··| Ç
,··Ç É&
ContentLanguageSetting··Ñ ö
>··ö õ
newSettings··ú ß
)··ß ®
{
‚‚ 	
var
„„ 
stringBuilder
„„ 
=
„„ 
new
„„  #
StringBuilder
„„$ 1
(
„„1 2
)
„„2 3
;
„„3 4
foreach
‰‰ 
(
‰‰ 
var
‰‰ 
key
‰‰ 
in
‰‰ 
oldSettings
‰‰  +
.
‰‰+ ,
Keys
‰‰, 0
)
‰‰0 1
{
ÂÂ 
var
ÊÊ "
replacementLanguage1
ÊÊ (
=
ÊÊ) *$
GetReplacementLanguage
ÊÊ+ A
(
ÊÊA B
key
ÊÊB E
,
ÊÊE F
oldSettings
ÊÊG R
)
ÊÊR S
;
ÊÊS T
var
ÁÁ "
replacementLanguage2
ÁÁ (
=
ÁÁ) *$
GetReplacementLanguage
ÁÁ+ A
(
ÁÁA B
key
ÁÁB E
,
ÁÁE F
newSettings
ÁÁG R
)
ÁÁR S
;
ÁÁS T
if
ËË 
(
ËË 
!
ËË 
string
ËË 
.
ËË 
IsNullOrEmpty
ËË )
(
ËË) *"
replacementLanguage1
ËË* >
)
ËË> ?
||
ËË@ B
!
ËËC D
string
ËËD J
.
ËËJ K
IsNullOrEmpty
ËËK X
(
ËËX Y"
replacementLanguage2
ËËY m
)
ËËm n
)
ËËn o
{
ÈÈ 
var
ÍÍ 
languageName
ÍÍ $
=
ÍÍ% &
GetLanguageName
ÍÍ' 6
(
ÍÍ6 7
key
ÍÍ7 :
)
ÍÍ: ;
;
ÍÍ; <
var
ÎÎ 
str
ÎÎ 
=
ÎÎ "
replacementLanguage1
ÎÎ 2
!=
ÎÎ3 5
null
ÎÎ6 :
&&
ÎÎ; ="
replacementLanguage1
ÎÎ> R
.
ÎÎR S
Equals
ÎÎS Y
(
ÎÎY Z"
replacementLanguage2
ÎÎZ n
)
ÎÎn o
?
ÎÎp q
$"
ÎÎr t
{
ÎÎt u
languageNameÎÎu Å
}ÎÎÅ Ç
{ÎÎÇ É
ArrowSeparatorÎÎÉ ë
}ÎÎë í
{ÎÎí ì$
replacementLanguage1ÎÎì ß
}ÎÎß ®
"ÎÎ® ©
.
ÏÏ 
Fade
ÏÏ 
(
ÏÏ 
)
ÏÏ 
:
ÏÏ  !
$"
ÏÏ" $
{
ÏÏ$ %
languageName
ÏÏ% 1
}
ÏÏ1 2
{
ÏÏ2 3
ArrowSeparator
ÏÏ3 A
}
ÏÏA B
{
ÏÏB C
(
ÏÏC D
!
ÏÏD E
string
ÏÏE K
.
ÏÏK L
IsNullOrEmpty
ÏÏL Y
(
ÏÏY Z"
replacementLanguage1
ÏÏZ n
)
ÏÏn o
?
ÏÏp q#
replacementLanguage1ÏÏr Ü
:ÏÏá à
$strÏÏâ è
)ÏÏè ê
}ÏÏê ë
"ÏÏë í
;ÏÏí ì
stringBuilder
ÌÌ !
.
ÌÌ! "
Append
ÌÌ" (
(
ÌÌ( )
str
ÌÌ) ,
)
ÌÌ, -
;
ÌÌ- .
stringBuilder
ÓÓ !
.
ÓÓ! "
Append
ÓÓ" (
(
ÓÓ( )
$str
ÓÓ) 0
)
ÓÓ0 1
;
ÓÓ1 2
}
ÔÔ 
}
 
return
ÒÒ 
stringBuilder
ÒÒ  
.
ÒÒ  !
ToString
ÒÒ! )
(
ÒÒ) *
)
ÒÒ* +
.
ÒÒ+ ,
TrimEnd
ÒÒ, 3
(
ÒÒ3 4
$str
ÒÒ4 ;
)
ÒÒ; <
;
ÒÒ< =
}
ÚÚ 	
private
ÙÙ 
string
ÙÙ -
NewReplacementLanguagesToString
ÙÙ 6
(
ÙÙ6 7
IDictionary
ÙÙ7 B
<
ÙÙB C
string
ÙÙC I
,
ÙÙI J$
ContentLanguageSetting
ÙÙK a
>
ÙÙa b
oldSettings
ÙÙc n
,
ÙÙn o
IDictionary
ÙÙp {
<
ÙÙ{ |
stringÙÙ| Ç
,ÙÙÇ É&
ContentLanguageSettingÙÙÑ ö
>ÙÙö õ
newSettingsÙÙú ß
)ÙÙß ®
{
ıı 	
var
ˆˆ 
stringBuilder
ˆˆ 
=
ˆˆ 
new
ˆˆ  #
StringBuilder
ˆˆ$ 1
(
ˆˆ1 2
)
ˆˆ2 3
;
ˆˆ3 4
foreach
˜˜ 
(
˜˜ 
var
˜˜ 
key
˜˜ 
in
˜˜ 
newSettings
˜˜  +
.
˜˜+ ,
Keys
˜˜, 0
)
˜˜0 1
{
¯¯ 
var
˘˘ "
replacementLanguage1
˘˘ (
=
˘˘) *$
GetReplacementLanguage
˘˘+ A
(
˘˘A B
key
˘˘B E
,
˘˘E F
newSettings
˘˘G R
)
˘˘R S
;
˘˘S T
var
˙˙ "
replacementLanguage2
˙˙ (
=
˙˙) *$
GetReplacementLanguage
˙˙+ A
(
˙˙A B
key
˙˙B E
,
˙˙E F
oldSettings
˙˙G R
)
˙˙R S
;
˙˙S T
if
˚˚ 
(
˚˚ 
!
˚˚ 
string
˚˚ 
.
˚˚ 
IsNullOrEmpty
˚˚ )
(
˚˚) *"
replacementLanguage1
˚˚* >
)
˚˚> ?
||
˚˚@ B
!
˚˚C D
string
˚˚D J
.
˚˚J K
IsNullOrEmpty
˚˚K X
(
˚˚X Y"
replacementLanguage2
˚˚Y m
)
˚˚m n
)
˚˚n o
{
¸¸ 
var
˝˝ 
languageName
˝˝ $
=
˝˝% &
GetLanguageName
˝˝' 6
(
˝˝6 7
key
˝˝7 :
)
˝˝: ;
;
˝˝; <
if
˛˛ 
(
˛˛ 
!
˛˛ 
string
˛˛ 
.
˛˛   
IsNullOrWhiteSpace
˛˛  2
(
˛˛2 3
languageName
˛˛3 ?
)
˛˛? @
)
˛˛@ A
{
ˇˇ 
if
ÄÄ 
(
ÄÄ "
replacementLanguage1
ÄÄ 0
!=
ÄÄ1 3
null
ÄÄ4 8
&&
ÄÄ9 ;"
replacementLanguage1
ÄÄ< P
.
ÄÄP Q
Equals
ÄÄQ W
(
ÄÄW X"
replacementLanguage2
ÄÄX l
)
ÄÄl m
)
ÄÄm n
stringBuilder
ÅÅ )
.
ÅÅ) *
Append
ÅÅ* 0
(
ÅÅ0 1
$"
ÅÅ1 3
{
ÅÅ3 4
languageName
ÅÅ4 @
}
ÅÅ@ A
{
ÅÅA B
ArrowSeparator
ÅÅB P
}
ÅÅP Q
{
ÅÅQ R"
replacementLanguage1
ÅÅR f
}
ÅÅf g
"
ÅÅg h
.
ÅÅh i
Fade
ÅÅi m
(
ÅÅm n
)
ÅÅn o
)
ÅÅo p
;
ÅÅp q
else
ÇÇ 
if
ÇÇ 
(
ÇÇ  !
string
ÇÇ! '
.
ÇÇ' (
IsNullOrEmpty
ÇÇ( 5
(
ÇÇ5 6"
replacementLanguage1
ÇÇ6 J
)
ÇÇJ K
)
ÇÇK L
stringBuilder
ÉÉ )
.
ÉÉ) *
Append
ÉÉ* 0
(
ÉÉ0 1
$"
ÉÉ1 3
{
ÉÉ3 4
languageName
ÉÉ4 @
}
ÉÉ@ A
{
ÉÉA B
ArrowSeparator
ÉÉB P
}
ÉÉP Q
{
ÉÉQ R"
replacementLanguage2
ÉÉR f
}
ÉÉf g
"
ÉÉg h
.
ÉÉh i
Strikethrough
ÉÉi v
(
ÉÉv w
)
ÉÉw x
)
ÉÉx y
;
ÉÉy z
else
ÑÑ 
stringBuilder
ÖÖ )
.
ÖÖ) *
Append
ÖÖ* 0
(
ÖÖ0 1
$"
ÖÖ1 3
{
ÖÖ3 4
languageName
ÖÖ4 @
}
ÖÖ@ A
{
ÖÖA B
ArrowSeparator
ÖÖB P
}
ÖÖP Q
{
ÖÖQ R"
replacementLanguage1
ÖÖR f
.
ÖÖf g
Bold
ÖÖg k
(
ÖÖk l
)
ÖÖl m
}
ÖÖm n
"
ÖÖn o
)
ÖÖo p
;
ÖÖp q
}
ÜÜ 
stringBuilder
áá !
.
áá! "
Append
áá" (
(
áá( )
$str
áá) 0
)
áá0 1
;
áá1 2
}
àà 
}
ââ 
return
ää 
stringBuilder
ää  
.
ää  !
ToString
ää! )
(
ää) *
)
ää* +
.
ää+ ,
TrimEnd
ää, 3
(
ää3 4
$str
ää4 ;
)
ää; <
;
ää< =
}
ãã 	
private
çç 
IDictionary
çç 
<
çç 
string
çç "
,
çç" #$
ContentLanguageSetting
çç$ :
>
çç: ;0
"GetContentLanguageSettingsFromJson
çç< ^
(
çç^ _
string
çç_ e
json
ççf j
)
ççj k
{
éé 	
return
èè 
string
èè 
.
èè 
IsNullOrEmpty
èè '
(
èè' (
json
èè( ,
)
èè, -
?
èè. /
new
èè0 3

Dictionary
èè4 >
<
èè> ?
string
èè? E
,
èèE F$
ContentLanguageSetting
èèG ]
>
èè] ^
(
èè^ _
)
èè_ `
:
èèa b
json
èèc g
.
èèg h
ToObject
èèh p
<
èèp q
IDictionary
èèq |
<
èè| }
stringèè} É
,èèÉ Ñ&
ContentLanguageSettingèèÖ õ
>èèõ ú
>èèú ù
(èèù û
)èèû ü
;èèü †
}
êê 	
private
íí 
IDictionary
íí 
<
íí 
string
íí "
,
íí" #$
ContentLanguageSetting
íí$ :
>
íí: ;!
GetLanguageSettings
íí< O
(
ííO P
ContentReference
ííP `
contentLink
íía l
)
ííl m
{
ìì 	
var
îî 

dictionary
îî 
=
îî 
new
îî  

Dictionary
îî! +
<
îî+ ,
string
îî, 2
,
îî2 3$
ContentLanguageSetting
îî4 J
>
îîJ K
(
îîK L
)
îîL M
;
îîM N
var
ïï  
languageBranchList
ïï "
=
ïï# $'
_languageBranchRepository
ïï% >
.
ïï> ?
ListEnabled
ïï? J
(
ïïJ K
)
ïïK L
;
ïïL M
var
ññ 
source
ññ 
=
ññ -
_contentLanguageSettingsHandler
ññ 8
.
ññ8 9
Get
ññ9 <
(
ññ< =
contentLink
ññ= H
)
ññH I
.
ññI J
ToList
ññJ P
(
ññP Q
)
ññQ R
;
ññR S
if
óó 
(
óó 
source
óó 
.
óó 
Any
óó 
(
óó 
)
óó 
)
óó 
{
òò 
foreach
ôô 
(
ôô 
var
ôô $
contentLanguageSetting
ôô 3
in
ôô4 6
source
ôô7 =
)
ôô= >
{
öö 
foreach
õõ 
(
õõ 
var
õõ  
languageBranch
õõ! /
in
õõ0 2 
languageBranchList
õõ3 E
)
õõE F
{
úú 
if
ùù 
(
ùù 
string
ùù "
.
ùù" #
Compare
ùù# *
(
ùù* +$
contentLanguageSetting
ùù+ A
.
ùùA B
LanguageBranch
ùùB P
,
ùùP Q
languageBranch
ùùR `
.
ùù` a

LanguageID
ùùa k
,
ùùk l
StringComparison
ùùm }
.
ùù} ~ 
OrdinalIgnoreCaseùù~ è
)ùùè ê
==ùùë ì
$numùùî ï
)ùùï ñ
{
ûû 

dictionary
üü &
.
üü& '
Add
üü' *
(
üü* +
languageBranch
üü+ 9
.
üü9 :

LanguageID
üü: D
,
üüD E$
contentLanguageSetting
üüF \
)
üü\ ]
;
üü] ^
break
†† !
;
††! "
}
°° 
}
¢¢ 
}
££ 
}
§§ 
return
•• 

dictionary
•• 
;
•• 
}
¶¶ 	
}
®® 
}©© ä
ÜC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\LanguageSettingCommand.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
[ 
EPiServerDataStore 
( #
AutomaticallyRemapStore /
=0 1
true2 6
)6 7
]7 8
public 

class "
LanguageSettingCommand '
:( )
ApprovalCommandBase* =
{ 
} 
}		 Ä/
ÇC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\MovingChangeDetail.cs
	namespace		 	
AdvancedTaskManager		
 
.		 
Infrastructure		 ,
.		, -
Cms		- 0
.		0 1
ChangeApproval		1 ?
{

 
public 

	interface 
IMovingChangeDetail (
{ 
IEnumerable 
< !
IContentChangeDetails )
>) *"
GetMovingChangeDetails+ A
(A B
ChangeTaskViewModelB U
byCommandIdV a
)a b
;b c
} 
public 

class 
MovingChangeDetail #
:$ %
IMovingChangeDetail& 9
{ 
private 
readonly 
ILogger  
_logger! (
;( )
private 
readonly 
IContentLoader '
_contentLoader( 6
;6 7
public 
MovingChangeDetail !
(! "
IContentLoader" 0
contentLoader1 >
)> ?
{ 	
_contentLoader 
= 
contentLoader *
;* +
_logger 
= 

LogManager  
.  !
	GetLogger! *
(* +
typeof+ 1
(1 2
MovingChangeDetail2 D
)D E
)E F
;F G
} 	
public 
IEnumerable 
< !
IContentChangeDetails 0
>0 1"
GetMovingChangeDetails2 H
(H I
ChangeTaskViewModelI \
byCommandId] h
)h i
{   	
if"" 
("" 
byCommandId"" 
=="" 
null"" #
)""# $
return## 
null## 
;## 
var$$ $
contentChangeDetailsList$$ (
=$$) *
new$$+ .
List$$/ 3
<$$3 4!
IContentChangeDetails$$4 I
>$$I J
($$J K
)$$K L
;$$L M
try%% 
{&& 
var'' 
movingPayLoad1'' "
=''# $
JsonConvert''% 0
.''0 1
DeserializeObject''1 B
<''B C
MovingPayLoad''C P
>''P Q
(''Q R
byCommandId''R ]
.''] ^
CurrentSettingsJson''^ q
)''q r
;''r s
var(( 
movingPayLoad2(( "
=((# $
JsonConvert((% 0
.((0 1
DeserializeObject((1 B
<((B C
MovingPayLoad((C P
>((P Q
(((Q R
byCommandId((R ]
.((] ^
NewSettingsJson((^ m
)((m n
;((n o
var** 
content1** 
=**  
GetContentPathString** 3
(**3 4
movingPayLoad1**4 B
.**B C
Destination**C N
)**N O
;**O P
var++ 
content2++ 
=++  
GetContentPathString++ 3
(++3 4
movingPayLoad2++4 B
.++B C
Destination++C N
)++N O
;++O P$
contentChangeDetailsList,, (
.,,( )
Add,,) ,
(,,, -
new,,- 0 
ContentChangeDetails,,1 E
(,,E F
),,F G
{-- 
Name.. 
=.. 
$str.. !
,..! "
OldValue// 
=// 
content1// '
,//' (
NewValue00 
=00 
content200 '
}11 
)11 
;11 
}22 
catch33 
(33 
	Exception33 
ex33 
)33  
{44 
_logger55 
.55 
Error55 
(55 
ex55  
.55  !
Message55! (
,55( )
ex55* ,
)55, -
;55- .
}66 
return77 $
contentChangeDetailsList77 +
;77+ ,
}88 	
private:: 
string::  
GetContentPathString:: +
(::+ ,
ContentReference::, <
contentReference::= M
)::M N
{;; 	
var== 
content== 
=== 
_contentLoader== (
.==( )
Get==) ,
<==, -
IContent==- 5
>==5 6
(==6 7
contentReference==7 G
)==G H
;==H I
var@@ 
contentPath@@ 
=@@ 
GetContentPath@@ ,
(@@, -
content@@- 4
)@@4 5
;@@5 6
returnBB 
contentPathBB 
;BB 
}CC 	
privateEE 
stringEE 
GetContentPathEE %
(EE% &
IContentEE& .
contentEE/ 6
)EE6 7
{FF 	
varHH 
parentReferenceHH 
=HH  !
contentHH" )
.HH) *

ParentLinkHH* 4
;HH4 5
varJJ 
pathJJ 
=JJ 
contentJJ 
.JJ 
NameJJ #
;JJ# $
whileLL 
(LL 
parentReferenceLL "
.LL" #
IDLL# %
!=LL& (
ContentReferenceLL) 9
.LL9 :
RootPageLL: B
.LLB C
IDLLC E
)LLE F
{MM 
varNN 
parentContentNN !
=NN" #
_contentLoaderNN$ 2
.NN2 3
GetNN3 6
<NN6 7
IContentNN7 ?
>NN? @
(NN@ A
parentReferenceNNA P
)NNP Q
;NNQ R
pathPP 
=PP 
$"PP 
{PP 
parentContentPP '
.PP' (
NamePP( ,
}PP, -
$strPP- 0
{PP0 1
pathPP1 5
}PP5 6
"PP6 7
;PP7 8
parentReferenceSS 
=SS  !
parentContentSS" /
.SS/ 0

ParentLinkSS0 :
;SS: ;
}TT 
returnVV 
pathVV 
+VV 
$strVV 
;VV 
}WW 	
}ZZ 
}[[ Æ
ÑC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\MovingContentCommand.cs
	namespace

 	
AdvancedTaskManager


 
.

 
Infrastructure

 ,
.

, -
Cms

- 0
.

0 1
ChangeApproval

1 ?
{ 
[ 
EPiServerDataStore 
( #
AutomaticallyRemapStore /
=0 1
true2 6
)6 7
]7 8
public 

class  
MovingContentCommand %
:& '
ApprovalCommandBase( ;
{ 
private 
static 
readonly 
ILogger  '
Logger( .
=/ 0

LogManager1 ;
.; <
	GetLogger< E
(E F
typeofF L
(L M 
MovingContentCommandM a
)a b
)b c
;c d
private 
Injected 
< 
IContentLoader '
>' (
_contentLoader) 7
;7 8
public 
override 
bool 
IsValid $
($ %
)% &
{ 	
try 
{ 
return 
_contentLoader %
.% &
Service& -
.- .
Get. 1
<1 2
IContent2 :
>: ;
(; <
JsonConvert< G
.G H
DeserializeObjectH Y
<Y Z
MovingPayLoadZ g
>g h
(h i
NewSettingsJsoni x
)x y
.y z
Destination	z Ö
)
Ö Ü
!=
á â
null
ä é
;
é è
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
Error 
( 
ex 
.  
Message  '
)' (
;( )
return 
false 
; 
} 
} 	
} 
} ¨¿
ÑC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\SecurityChangeDetail.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
public 

	interface !
ISecurityChangeDetail *
{ 
IEnumerable 
< !
IContentChangeDetails )
>) *$
GetSecurityChangeDetails+ C
(C D
GuidD H
commandI P
)P Q
;Q R
} 
public 

class  
SecurityChangeDetail %
:& '!
ISecurityChangeDetail( =
{ 
private 
readonly #
IApprovalCommandService 0"
_generalCommandService1 G
;G H
private 
readonly 
ILogger  
_logger! (
;( )
private 
static 
readonly 
List  $
<$ %
AccessLevel% 0
>0 1
KnownAccessLevels2 C
=D E
newF I
(I J
)J K
{ 	
AccessLevel 
. 
Read 
, 
AccessLevel 
. 
Create 
, 
AccessLevel 
. 
Edit 
, 
AccessLevel 
. 
Delete 
, 
AccessLevel 
. 
Publish 
,  
AccessLevel 
. 

Administer "
}   	
;  	 

public""  
SecurityChangeDetail"" #
(""# $#
IApprovalCommandService""$ ;!
generalCommandService""< Q
)""Q R
{## 	"
_generalCommandService$$ "
=$$# $!
generalCommandService$$% :
;$$: ;
_logger%% 
=%% 

LogManager%%  
.%%  !
	GetLogger%%! *
(%%* +
typeof%%+ 1
(%%1 2 
SecurityChangeDetail%%2 F
)%%F G
)%%G H
;%%H I
}&& 	
public++ 
IEnumerable++ 
<++ !
IContentChangeDetails++ 0
>++0 1$
GetSecurityChangeDetails++2 J
(++J K
Guid++K O
command++P W
)++W X
{,, 	
var-- 
byCommandId-- 
=-- "
_generalCommandService-- 4
.--4 5
GetCommandById--5 C
(--C D
command--D K
)--K L
;--L M
var.. $
contentChangeDetailsList.. (
=..) *
new..+ .
List../ 3
<..3 4!
IContentChangeDetails..4 I
>..I J
(..J K
)..K L
;..L M
var// 
str1// 
=// 
$str// 
;// 
var00 
str200 
=00 
$str00 
;00 
if11 
(11 
byCommandId11 
==11 
null11 #
)11# $
return22 
null22 
;22 
var33 
accessControlList133 "
=33# $'
GetContentAccessControlList33% @
(33@ A
byCommandId33A L
.33L M
CurrentSettingsJson33M `
)33` a
;33a b
var44 
accessControlList244 "
=44# $'
GetContentAccessControlList44% @
(44@ A
byCommandId44A L
.44L M
NewSettingsJson44M \
)44\ ]
;44] ^
if55 
(55 
accessControlList155 "
==55# %
null55& *
||55+ -
accessControlList255. @
==55A C
null55D H
)55H I
return66 
null66 
;66 
if77 
(77 
accessControlList177 "
.77" #
IsInherited77# .
!=77/ 1
accessControlList2772 D
.77D E
IsInherited77E P
)77P Q
{88 
var99  
contentChangeDetails99 (
=99) *
(99+ ,!
IContentChangeDetails99, A
)99A B
new99B E 
ContentChangeDetails99F Z
(99Z [
)99[ \
;99\ ] 
contentChangeDetails:: $
.::$ %
Name::% )
=::* +
$str::, >
;::> ? 
contentChangeDetails;; $
.;;$ %
OldValue;;% -
=;;. /
accessControlList1;;0 B
.;;B C
IsInherited;;C N
?;;O P
str1;;Q U
:;;V W
str2;;X \
;;;\ ] 
contentChangeDetails<< $
.<<$ %
NewValue<<% -
=<<. /
accessControlList2<<0 B
.<<B C
IsInherited<<C N
?<<O P
str1<<Q U
:<<V W
str2<<X \
;<<\ ]$
contentChangeDetailsList== (
.==( )
Add==) ,
(==, - 
contentChangeDetails==- A
)==A B
;==B C
}>> 
if@@ 
(@@ 
byCommandId@@ 
is@@ "
SecuritySettingCommand@@ 5

secCommand@@6 @
&&@@A C
(@@D E

secCommand@@E O
.@@O P
SecuritySaveType@@P `
==@@a c
SecuritySaveType@@d t
.@@t u"
MergeChildPermissions	@@u ä
||
@@ã ç

secCommand
@@é ò
.
@@ò ô
SecuritySaveType
@@ô ©
==
@@™ ¨
SecuritySaveType
@@≠ Ω
.
@@Ω æ%
ReplaceChildPermissions
@@æ ’
)
@@’ ÷
)
@@÷ ◊
{AA 
varBB  
contentChangeDetailsBB (
=BB) *
(BB+ ,!
IContentChangeDetailsBB, A
)BBA B
newBBB E 
ContentChangeDetailsBBF Z
(BBZ [
)BB[ \
;BB\ ] 
contentChangeDetailsCC $
.CC$ %
NameCC% )
=CC* +
$strCC, F
;CCF G 
contentChangeDetailsDD $
.DD$ %
OldValueDD% -
=DD. /
stringDD0 6
.DD6 7
EmptyDD7 <
;DD< = 
contentChangeDetailsEE $
.EE$ %
NewValueEE% -
=EE. /
str1EE0 4
;EE4 5$
contentChangeDetailsListFF (
.FF( )
AddFF) ,
(FF, - 
contentChangeDetailsFF- A
)FFA B
;FFB C
}GG 
varHH !
contentChangeDetails1HH %
=HH& '
(HH( )!
IContentChangeDetailsHH) >
)HH> ?
newHH? B 
ContentChangeDetailsHHC W
(HHW X
)HHX Y
;HHY Z!
contentChangeDetails1II !
.II! "
NewValueII" *
=II+ ,
$strII- /
;II/ 0!
contentChangeDetails1JJ !
.JJ! "
OldValueJJ" *
=JJ+ ,
$strJJ- /
;JJ/ 0!
contentChangeDetails1LL !
.LL! "
NameLL" &
=LL' (
$strLL) >
;LL> ?
varMM 
source1MM 
=MM 
accessControlList1MM ,
.MM, -
EntriesMM- 4
.MM4 5
OrderByMM5 <
(MM< =
eMM= >
=>MM? A
eMMB C
.MMC D
NameMMD H
)MMH I
.MMI J
ToListMMJ P
(MMP Q
)MMQ R
;MMR S
varNN 
source2NN 
=NN 
accessControlList2NN ,
.NN, -
EntriesNN- 4
.NN4 5
OrderByNN5 <
(NN< =
eNN= >
=>NN? A
eNNB C
.NNC D
NameNND H
)NNH I
.NNI J
ToListNNJ P
(NNP Q
)NNQ R
;NNR S
foreachPP 
(PP 
varPP 
accessControlEntry1PP ,
inPP- /
source1PP0 7
)PP7 8
{QQ 
varRR $
currentAccessControlItemRR ,
=RR- .
accessControlEntry1RR/ B
;RRB C
varSS 
accessControlEntry2SS '
=SS( )
source2SS* 1
.SS1 2
FirstOrDefaultSS2 @
(SS@ A
eSSA B
=>SSC E
eSSF G
.SSG H
NameSSH L
.SSL M
EqualsSSM S
(SSS T$
currentAccessControlItemSST l
.SSl m
NameSSm q
,SSq r
StringComparison	SSs É
.
SSÉ Ñ
OrdinalIgnoreCase
SSÑ ï
)
SSï ñ
)
SSñ ó
??
SSò ö
new
SSõ û 
AccessControlEntry
SSü ±
(
SS± ≤&
currentAccessControlItem
SS≤  
.
SS  À
Name
SSÀ œ
,
SSœ –
AccessLevel
SS— ‹
.
SS‹ ›
	Undefined
SS› Ê
)
SSÊ Á
;
SSÁ Ë!
contentChangeDetails1TT %
.TT% &
OldValueTT& .
=TT/ 0!
contentChangeDetails1TT1 F
.TTF G
OldValueTTG O
+TTP Q&
LocalizeCurrentAccessLevelTTR l
(TTl m

WebUtilityTTm w
.TTw x

HtmlEncode	TTx Ç
(
TTÇ É&
currentAccessControlItem
TTÉ õ
.
TTõ ú
Name
TTú †
)
TT† °
,
TT° ¢&
currentAccessControlItem
TT£ ª
.
TTª º
Access
TTº ¬
,
TT¬ √!
accessControlEntry2
TTƒ ◊
.
TT◊ ÿ
Access
TTÿ ﬁ
)
TTﬁ ﬂ
+
TT‡ ·
$str
TT‚ È
;
TTÈ Í
}UU 
foreachWW 
(WW 
varWW 
accessControlEntry1WW ,
inWW- /
source2WW0 7
)WW7 8
{XX 
varYY  
newAccessControlItemYY (
=YY) *
accessControlEntry1YY+ >
;YY> ?
varZZ 
accessControlEntry2ZZ '
=ZZ( )
source1ZZ* 1
.ZZ1 2
FirstOrDefaultZZ2 @
(ZZ@ A
eZZA B
=>ZZC E
eZZF G
.ZZG H
NameZZH L
.ZZL M
EqualsZZM S
(ZZS T 
newAccessControlItemZZT h
.ZZh i
NameZZi m
,ZZm n
StringComparisonZZo 
.	ZZ Ä
OrdinalIgnoreCase
ZZÄ ë
)
ZZë í
)
ZZí ì
??
ZZî ñ
new
ZZó ö 
AccessControlEntry
ZZõ ≠
(
ZZ≠ Æ"
newAccessControlItem
ZZÆ ¬
.
ZZ¬ √
Name
ZZ√ «
,
ZZ« »
AccessLevel
ZZ… ‘
.
ZZ‘ ’
	Undefined
ZZ’ ﬁ
)
ZZﬁ ﬂ
;
ZZﬂ ‡!
contentChangeDetails1[[ %
.[[% &
NewValue[[& .
=[[/ 0!
contentChangeDetails1[[1 F
.[[F G
NewValue[[G O
+[[P Q"
LocalizeNewAccessLevel[[R h
([[h i

WebUtility[[i s
.[[s t

HtmlEncode[[t ~
([[~ !
newAccessControlItem	[[ ì
.
[[ì î
Name
[[î ò
)
[[ò ô
,
[[ô ö!
accessControlEntry2
[[õ Æ
.
[[Æ Ø
Access
[[Ø µ
,
[[µ ∂"
newAccessControlItem
[[∑ À
.
[[À Ã
Access
[[Ã “
)
[[“ ”
+
[[‘ ’
$str
[[÷ ›
;
[[› ﬁ
}\\ !
contentChangeDetails1]] !
.]]! "
OldValue]]" *
=]]+ ,!
contentChangeDetails1]]- B
.]]B C
OldValue]]C K
==]]L N
null]]O S
?]]T U
string]]V \
.]]\ ]
Empty]]] b
:]]c d!
contentChangeDetails1]]e z
.]]z {
OldValue	]]{ É
.
]]É Ñ
ToString
]]Ñ å
(
]]å ç
)
]]ç é
.
]]é è
TrimEnd
]]è ñ
(
]]ñ ó
$str
]]ó û
)
]]û ü
;
]]ü †!
contentChangeDetails1^^ !
.^^! "
NewValue^^" *
=^^+ ,!
contentChangeDetails1^^- B
.^^B C
NewValue^^C K
==^^L N
null^^O S
?^^T U
string^^V \
.^^\ ]
Empty^^] b
:^^c d!
contentChangeDetails1^^e z
.^^z {
NewValue	^^{ É
.
^^É Ñ
ToString
^^Ñ å
(
^^å ç
)
^^ç é
.
^^é è
TrimEnd
^^è ñ
(
^^ñ ó
$str
^^ó û
)
^^û ü
;
^^ü †$
contentChangeDetailsList__ $
.__$ %
Add__% (
(__( )!
contentChangeDetails1__) >
)__> ?
;__? @
return`` $
contentChangeDetailsList`` +
;``+ ,
}aa 	
privatecc 
stringcc &
LocalizeCurrentAccessLevelcc 1
(cc1 2
stringcc2 8
accessLevelNamecc9 H
,ccH I
AccessLevelccJ U
currentAccessLevelccV h
,cch i
AccessLevelccj u
newAccessLevel	ccv Ñ
)
ccÑ Ö
{dd 	
varee 
stree 
=ee 
$"ee 
{ee 
accessLevelNameee (
}ee( )
$stree) +
"ee+ ,
;ee, -
stringff 
textff 
;ff 
ifgg 
(gg 
currentAccessLevelgg "
==gg# %
AccessLevelgg& 1
.gg1 2
NoAccessgg2 :
||gg; =
currentAccessLevelgg> P
==ggQ S
AccessLevelggT _
.gg_ `
	Undefinedgg` i
)ggi j
{hh 
textii 
=ii %
GetAccessLevelDescriptionii 0
(ii0 1
currentAccessLevelii1 C
)iiC D
;iiD E
}jj 
elsekk 
{ll 
foreachmm 
(mm 
varmm 
knownAccessLevelmm -
inmm. 0
KnownAccessLevelsmm1 B
)mmB C
{nn 
ifoo 
(oo 
currentAccessLeveloo *
.oo* +
HasFlagoo+ 2
(oo2 3
knownAccessLeveloo3 C
)ooC D
)ooD E
strpp 
=pp 
strpp !
+pp" #%
GetAccessLevelDescriptionpp$ =
(pp= >
knownAccessLevelpp> N
)ppN O
+ppP Q
$strppR V
;ppV W
}qq 
textrr 
=rr 
strrr 
.rr 
TrimEndrr "
(rr" #
$strrr# '
)rr' (
;rr( )
}ss 
iftt 
(tt 
currentAccessLeveltt "
==tt# %
newAccessLeveltt& 4
)tt4 5
textuu 
=uu 
textuu 
.uu 
Fadeuu  
(uu  !
)uu! "
;uu" #
returnvv 
textvv 
;vv 
}ww 	
privateyy 
staticyy 
stringyy "
LocalizeNewAccessLevelyy 4
(yy4 5
stringyy5 ;
accessLevelNameyy< K
,yyK L
AccessLevelyyM X
currentAccessLevelyyY k
,yyk l
AccessLevelyym x
newAccessLevel	yyy á
)
yyá à
{zz 	
var{{ 
str{{ 
={{ 
$"{{ 
{{{ 
accessLevelName{{ (
}{{( )
$str{{) +
"{{+ ,
;{{, -
string|| 
text1|| 
;|| 
if}} 
(}} 
(}} 
newAccessLevel}} 
==}}  "
AccessLevel}}# .
.}}. /
NoAccess}}/ 7
||}}8 :
newAccessLevel}}; I
==}}J L
AccessLevel}}M X
.}}X Y
	Undefined}}Y b
)}}b c
&&}}d f
newAccessLevel}}g u
==}}v x
currentAccessLevel	}}y ã
)
}}ã å
{~~ 
text1 
= %
GetAccessLevelDescription 1
(1 2
newAccessLevel2 @
)@ A
;A B
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 
foreach
ÉÉ 
(
ÉÉ 
var
ÉÉ 
knownAccessLevel
ÉÉ -
in
ÉÉ. 0
KnownAccessLevels
ÉÉ1 B
)
ÉÉB C
{
ÑÑ 
if
ÖÖ 
(
ÖÖ  
currentAccessLevel
ÖÖ *
.
ÖÖ* +
HasFlag
ÖÖ+ 2
(
ÖÖ2 3
knownAccessLevel
ÖÖ3 C
)
ÖÖC D
||
ÖÖE G
newAccessLevel
ÖÖH V
.
ÖÖV W
HasFlag
ÖÖW ^
(
ÖÖ^ _
knownAccessLevel
ÖÖ_ o
)
ÖÖo p
)
ÖÖp q
{
ÜÜ 
var
áá 
text2
áá !
=
áá" #'
GetAccessLevelDescription
áá$ =
(
áá= >
knownAccessLevel
áá> N
)
ááN O
;
ááO P
if
àà 
(
àà  
currentAccessLevel
àà .
.
àà. /
HasFlag
àà/ 6
(
àà6 7
knownAccessLevel
àà7 G
)
ààG H
&&
ààI K
!
ààL M
newAccessLevel
ààM [
.
àà[ \
HasFlag
àà\ c
(
ààc d
knownAccessLevel
ààd t
)
ààt u
)
ààu v
{
ââ 
text2
ää !
=
ää" #
text2
ää$ )
.
ää) *
Strikethrough
ää* 7
(
ää7 8
)
ää8 9
;
ää9 :
}
ãã 
else
åå 
if
åå 
(
åå  !
!
åå! " 
currentAccessLevel
åå" 4
.
åå4 5
HasFlag
åå5 <
(
åå< =
knownAccessLevel
åå= M
)
ååM N
&&
ååO Q
newAccessLevel
ååR `
.
åå` a
HasFlag
ååa h
(
ååh i
knownAccessLevel
ååi y
)
ååy z
)
ååz {
{
çç 
text2
éé !
=
éé" #
text2
éé$ )
.
éé) *
Bold
éé* .
(
éé. /
)
éé/ 0
;
éé0 1
}
èè 
str
ëë 
=
ëë 
str
ëë !
+
ëë" #
text2
ëë$ )
+
ëë* +
$str
ëë, 0
;
ëë0 1
}
íí 
}
ìì 
text1
îî 
=
îî 
str
îî 
.
îî 
TrimEnd
îî #
(
îî# $
$str
îî$ (
)
îî( )
;
îî) *
}
ïï 
if
ññ 
(
ññ  
currentAccessLevel
ññ "
==
ññ# %
newAccessLevel
ññ& 4
)
ññ4 5
text1
óó 
=
óó 
text1
óó 
.
óó 
Fade
óó "
(
óó" #
)
óó# $
;
óó$ %
return
òò 
text1
òò 
;
òò 
}
ôô 	
private
öö 

ContentACL
öö )
GetContentAccessControlList
öö 6
(
öö6 7
string
öö7 =
json
öö> B
)
ööB C
{
õõ 	
if
úú 
(
úú 
string
úú 
.
úú 
IsNullOrEmpty
úú $
(
úú$ %
json
úú% )
)
úú) *
)
úú* +
return
ùù 
null
ùù 
;
ùù 
var
ûû 
jObject
ûû 
=
ûû 
JsonConvert
ûû %
.
ûû% &
DeserializeObject
ûû& 7
<
ûû7 8
JObject
ûû8 ?
>
ûû? @
(
ûû@ A
json
ûûA E
)
ûûE F
;
ûûF G
var
†† 
isInherited
†† 
=
†† 
jObject
†† %
[
††% &
$str
††& 3
]
††3 4
?
††4 5
.
††5 6
ToString
††6 >
(
††> ?
)
††? @
??
††A C
$str
††D F
;
††F G
return
¢¢ 
new
¢¢ 

ContentACL
¢¢ !
{
££ 
IsInherited
§§ 
=
§§ 
isInherited
§§ )
.
§§) *
Equals
§§* 0
(
§§0 1
bool
§§1 5
.
§§5 6

TrueString
§§6 @
,
§§@ A
StringComparison
§§B R
.
§§R S
OrdinalIgnoreCase
§§S d
)
§§d e
,
§§e f
Entries
•• 
=
•• /
!GetAccessControlListFromJsonArray
•• ;
(
••; <
jObject
••< C
[
••C D
$str
••D M
]
••M N
)
••N O
}
¶¶ 
;
¶¶ 
}
ßß 	
private
®® 
List
®® 
<
®®  
AccessControlEntry
®® '
>
®®' (/
!GetAccessControlListFromJsonArray
®®) J
(
®®J K
JToken
®®K Q
entriesArray
®®R ^
)
®®^ _
{
©© 	
var
™™ $
accessControlEntryList
™™ &
=
™™' (
new
™™) ,
List
™™- 1
<
™™1 2 
AccessControlEntry
™™2 D
>
™™D E
(
™™E F
)
™™F G
;
™™G H
try
´´ 
{
¨¨ 
if
≠≠ 
(
≠≠ 
entriesArray
≠≠  
!=
≠≠! #
null
≠≠$ (
)
≠≠( )
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ  
entries
ÆÆ! (
in
ÆÆ) +
entriesArray
ÆÆ, 8
)
ÆÆ8 9
{
ØØ 
var
∞∞ 
name
∞∞  
=
∞∞! "
entries
∞∞# *
[
∞∞* +
$str
∞∞+ 1
]
∞∞1 2
?
∞∞2 3
.
∞∞3 4
ToString
∞∞4 <
(
∞∞< =
)
∞∞= >
??
∞∞? A
$str
∞∞B D
;
∞∞D E
int
±± 
.
±± 
TryParse
±± $
(
±±$ %
entries
±±% ,
[
±±, -
$str
±±- 5
]
±±5 6
?
±±6 7
.
±±7 8
ToString
±±8 @
(
±±@ A
)
±±A B
,
±±B C
out
±±D G
var
±±H K
access
±±L R
)
±±R S
;
±±S T
int
≤≤ 
.
≤≤ 
TryParse
≤≤ $
(
≤≤$ %
entries
≤≤% ,
[
≤≤, -
$str
≤≤- 9
]
≤≤9 :
?
≤≤: ;
.
≤≤; <
ToString
≤≤< D
(
≤≤D E
)
≤≤E F
,
≤≤F G
out
≤≤H K
var
≤≤L O
entry
≤≤P U
)
≤≤U V
;
≤≤V W
var
¥¥  
accessControlEntry
¥¥ .
=
¥¥/ 0
new
µµ  
AccessControlEntry
µµ  2
(
µµ2 3
name
µµ3 7
,
µµ7 8
(
µµ9 :
AccessLevel
µµ: E
)
µµE F
access
µµF L
,
µµL M
(
µµN O 
SecurityEntityType
µµO a
)
µµa b
entry
µµb g
)
µµg h
;
µµh i$
accessControlEntryList
∂∂ .
.
∂∂. /
Add
∂∂/ 2
(
∂∂2 3 
accessControlEntry
∂∂3 E
)
∂∂E F
;
∂∂F G
}
∑∑ 
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ 
ex
ππ 
)
ππ  
{
∫∫ 
_logger
ªª 
.
ªª 
Error
ªª 
(
ªª 
ex
ªª  
.
ªª  !
Message
ªª! (
,
ªª( )
ex
ªª* ,
)
ªª, -
;
ªª- .
}
ºº 
return
ΩΩ $
accessControlEntryList
ΩΩ )
;
ΩΩ) *
}
ææ 	
static
¿¿ 
string
¿¿ '
GetAccessLevelDescription
¿¿ /
(
¿¿/ 0
AccessLevel
¿¿0 ;
accessLevel
¿¿< G
)
¿¿G H
{
¡¡ 	
switch
¬¬ 
(
¬¬ 
accessLevel
¬¬ 
)
¬¬  
{
√√ 
case
ƒƒ 
AccessLevel
ƒƒ  
.
ƒƒ  !
NoAccess
ƒƒ! )
:
ƒƒ) *
return
≈≈ 
$str
≈≈ &
;
≈≈& '
case
∆∆ 
AccessLevel
∆∆  
.
∆∆  !
Read
∆∆! %
:
∆∆% &
return
«« 
$str
«« !
;
««! "
case
»» 
AccessLevel
»»  
.
»»  !
Create
»»! '
:
»»' (
return
…… 
$str
…… #
;
……# $
case
   
AccessLevel
    
.
    !
Edit
  ! %
:
  % &
return
ÀÀ 
$str
ÀÀ #
;
ÀÀ# $
case
ÃÃ 
AccessLevel
ÃÃ  
.
ÃÃ  !
Delete
ÃÃ! '
:
ÃÃ' (
return
ÕÕ 
$str
ÕÕ #
;
ÕÕ# $
case
ŒŒ 
AccessLevel
ŒŒ  
.
ŒŒ  !
Publish
ŒŒ! (
:
ŒŒ( )
return
œœ 
$str
œœ $
;
œœ$ %
case
–– 
AccessLevel
––  
.
––  !

Administer
––! +
:
––+ ,
return
—— 
$str
—— '
;
——' (
case
““ 
AccessLevel
““  
.
““  !

FullAccess
““! +
:
““+ ,
return
”” 
$str
”” (
;
””( )
case
‘‘ 
AccessLevel
‘‘  
.
‘‘  !
	Undefined
‘‘! *
:
‘‘* +
return
’’ 
$str
’’ &
;
’’& '
default
÷÷ 
:
÷÷ 
return
◊◊ 
$str
◊◊ &
;
◊◊& '
}
ÿÿ 
}
ŸŸ 	
}
‹‹ 
}›› Õ
ÜC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\ChangeApproval\SecuritySettingCommand.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
.0 1
ChangeApproval1 ?
{ 
[ 
EPiServerDataStore 
( #
AutomaticallyRemapStore /
=0 1
true2 6
)6 7
]7 8
public 

class "
SecuritySettingCommand '
:( )
ApprovalCommandBase* =
{ 
public		 
virtual		 
SecuritySaveType		 '
SecuritySaveType		( 8
{		9 :
get		; >
;		> ?
set		@ C
;		C D
}		E F
}

 
} ê
mC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\MenuProvider.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
{ 
[ 
MenuProvider 
] 
public 

class 
MenuProvider 
: 
IMenuProvider  -
{		 
public

 
IEnumerable

 
<

 
MenuItem

 #
>

# $
GetMenuItems

% 1
(

1 2
)

2 3
{ 	
var 
url 
= 
Paths 
. 

ToResource &
(& '
GetType' .
(. /
)/ 0
,0 1
$str2 =
)= >
;> ?
var 
link 
= 
new 
UrlMenuItem &
(& '
$str #
,# $
	MenuPaths 
. 
Global  
+! "
$str# 6
,6 7
url 
) 
{ 
	SortIndex 
= 
$num 
,  
AuthorizationPolicy #
=$ %
	Constants& /
./ 0

PolicyName0 :
} 
; 
return 
new 
List 
< 
MenuItem $
>$ %
{ 
link 
} 
; 
} 	
} 
} ‰]
tC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Cms\NotificationHandler.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Cms- 0
{ 
public 

	interface  
INotificationHandler )
{ 
Task 
< 
ContentTask 
> 
GetNotifications *
(* +
string+ 1
id2 4
,4 5
ContentTask6 A

customTaskB L
,L M
boolN R
isContentQueryS a
)a b
;b c
} 
public 

class 
NotificationHandler $
:% & 
INotificationHandler' ;
{ 
private 
readonly '
IUserNotificationRepository 4'
_userNotificationRepository5 P
;P Q
private 
readonly "
IAsyncDatabaseExecutor /
_databaseExecutor0 A
;A B
public 
NotificationHandler "
(" #'
IUserNotificationRepository# >&
userNotificationRepository? Y
,Y Z"
IAsyncDatabaseExecutor[ q
databaseExecutor	r Ç
)
Ç É
{ 	'
_userNotificationRepository '
=( )&
userNotificationRepository* D
;D E
_databaseExecutor 
= 
databaseExecutor  0
;0 1
} 	
public 
async 
Task 
< 
ContentTask %
>% &
GetNotifications' 7
(7 8
string8 >
id? A
,A B
ContentTaskC N

customTaskO Y
,Y Z
bool[ _
isContentQuery` n
)n o
{ 	
if 
( 
PrincipalAccessor !
.! "
Current" )
.) *
Identity* 2
!=3 5
null6 :
&&; =
!> ?
string? E
.E F
IsNullOrEmptyF S
(S T
PrincipalAccessorT e
.e f
Currentf m
.m n
Identityn v
.v w
Namew {
){ |
)| }
{   
var!! 
notifications!! !
=!!" #
await!!$ )
GetNotifications!!* :
(!!: ;
PrincipalAccessor!!; L
.!!L M
Current!!M T
.!!T U
Identity!!U ]
.!!] ^
Name!!^ b
,!!b c
id!!d f
,!!f g
isContentQuery!!h v
)!!v w
;!!w x
if## 
(## 
notifications## !
?##! "
.##" #
PagedResult### .
!=##/ 1
null##2 6
&&##7 9
notifications##: G
.##G H
PagedResult##H S
.##S T
Any##T W
(##W X
)##X Y
)##Y Z
{$$ 
foreach&& 
(&& 
var&&  
notification&&! -
in&&. 0
notifications&&1 >
.&&> ?
PagedResult&&? J
)&&J K
{'' 
await(( '
_userNotificationRepository(( 9
.((9 :+
MarkUserNotificationAsReadAsync((: Y
(((Y Z
new((Z ]
NotificationUser((^ n
(((n o
PrincipalAccessor	((o Ä
.
((Ä Å
Current
((Å à
.
((à â
Identity
((â ë
.
((ë í
Name
((í ñ
)
((ñ ó
,
((ó ò
notification
((ô •
.
((• ¶
ID
((¶ ®
)
((® ©
;
((© ™
})) 

customTask++ 
.++ 
NotificationUnread++ 1
=++2 3
true++4 8
;++8 9
},, 
else-- 
{.. 

customTask// 
.// 
NotificationUnread// 1
=//2 3
false//4 9
;//9 :
}00 
}11 
return33 

customTask33 
;33 
}44 	
private66 
async66 
Task66 
<66 2
&PagedInternalNotificationMessageResult66 A
>66A B
GetNotifications66C S
(66S T
string66T Z
user66[ _
,66_ `
string66a g
	contentId66h q
,66q r
bool66s w
isContentQuery	66x Ü
=
66á à
true
66â ç
)
66ç é
{77 	
return88 
new88 2
&PagedInternalNotificationMessageResult88 =
(88= >
await88> C
_databaseExecutor88D U
.88U V
ExecuteAsync88V b
(88b c
async88c h
(88i j
)88j k
=>88l n
{99 
var:: 
entries:: 
=:: 
new:: !
List::" &
<::& ''
InternalNotificationMessage::' B
>::B C
(::C D
)::D E
;::E F
var;; 
query;; 
=;; 
$str	;; ≠
+
;;Æ Ø
$"<< 
$str<< 1
{<<1 2
user<<2 6
}<<6 7
$str<<7 8
"<<8 9
;<<9 :
if>> 
(>> 
isContentQuery>> "
)>>" #
{?? 
query@@ 
=@@ 
query@@ !
+@@" #
$"@@$ &
$str@@& K
{@@K L
	contentId@@L U
}@@U V
$str@@V Z
"@@Z [
+@@\ ]
$strAA >
+AA? @
$strBB ;
;BB; <
}CC 
elseDD 
{EE 
queryFF 
=FF 
queryFF !
+FF" #
$"FF$ &
$strFF& I
{FFI J
	contentIdFFJ S
}FFS T
$strFFT X
"FFX Y
+FFZ [
$strGG A
;GGA B
}HH 
queryJJ 
=JJ 
queryJJ 
+JJ 
$strJJ  5
+JJ6 7
$strKK -
;KK- .
varMM 
commandMM 
=MM 
_databaseExecutorMM /
.MM/ 0
CreateCommandMM0 =
(MM= >
)MM> ?
;MM? @
commandNN 
.NN 
CommandTextNN #
=NN$ %
queryNN& +
;NN+ ,
commandOO 
.OO 
CommandTypeOO #
=OO$ %
CommandTypeOO& 1
.OO1 2
TextOO2 6
;OO6 7
awaitQQ 
usingQQ 
(QQ 
varQQ  
readerQQ! '
=QQ( )
awaitQQ* /
commandQQ0 7
.QQ7 8
ExecuteReaderAsyncQQ8 J
(QQJ K
)QQK L
.QQL M
ConfigureAwaitQQM [
(QQ[ \
falseQQ\ a
)QQa b
)QQb c
{RR 
whileSS 
(SS 
awaitSS  
readerSS! '
.SS' (
	ReadAsyncSS( 1
(SS1 2
)SS2 3
)SS3 4
{TT 
entriesUU 
.UU  
AddUU  #
(UU# $
CreateUU$ *
(UU* +
readerUU+ 1
)UU1 2
)UU2 3
;UU3 4
}VV 
}WW 
returnXX 
(XX 
IListXX 
<XX '
InternalNotificationMessageXX 9
>XX9 :
)XX: ;
entriesXX; B
;XXB C
}YY 
)YY 
.YY 
ConfigureAwaitYY 
(YY 
falseYY #
)YY# $
,YY$ %
$numYY& (
)YY( )
;YY) *
}ZZ 	
private]] 
static]] '
InternalNotificationMessage]] 2
Create]]3 9
(]]9 :
DbDataReader]]: F
reader]]G M
)]]M N
{^^ 	
var__ 
notificationMessage__ #
=__$ %
new__& )'
InternalNotificationMessage__* E
(__E F
)__F G
{`` 
	Recipientaa 
=aa 
Convertaa #
.aa# $
ToStringaa$ ,
(aa, -
readeraa- 3
[aa3 4
$straa4 ?
]aa? @
)aa@ A
,aaA B
Senderbb 
=bb 
Convertbb  
.bb  !
ToStringbb! )
(bb) *
readerbb* 0
[bb0 1
$strbb1 9
]bb9 :
)bb: ;
,bb; <
ChannelNamecc 
=cc 
Convertcc %
.cc% &
ToStringcc& .
(cc. /
readercc/ 5
[cc5 6
$strcc6 ?
]cc? @
)cc@ A
,ccA B
TypeNamedd 
=dd 
Convertdd "
.dd" #
ToStringdd# +
(dd+ ,
readerdd, 2
[dd2 3
$strdd3 9
]dd9 :
)dd: ;
,dd; <
Subjectee 
=ee 
Convertee !
.ee! "
ToStringee" *
(ee* +
readeree+ 1
[ee1 2
$stree2 ;
]ee; <
)ee< =
,ee= >
Contentff 
=ff 
Convertff !
.ff! "
ToStringff" *
(ff* +
readerff+ 1
[ff1 2
$strff2 ;
]ff; <
)ff< =
,ff= >
IDgg 
=gg 
Convertgg 
.gg 
ToInt32gg $
(gg$ %
readergg% +
[gg+ ,
$strgg, 0
]gg0 1
)gg1 2
,gg2 3
Savedhh 
=hh 
Converthh 
.hh  

ToDateTimehh  *
(hh* +
readerhh+ 1
[hh1 2
$strhh2 9
]hh9 :
)hh: ;
.hh; <
ToLocalTimehh< G
(hhG H
)hhH I
}ii 
;ii 
varjj 
obj1jj 
=jj 
readerjj 
[jj 
$strjj $
]jj$ %
;jj% &
ifkk 
(kk 
obj1kk 
!=kk 
DBNullkk 
.kk 
Valuekk $
)kk$ %
notificationMessagell #
.ll# $
Sentll$ (
=ll) *
Convertll+ 2
.ll2 3

ToDateTimell3 =
(ll= >
obj1ll> B
)llB C
.llC D
ToLocalTimellD O
(llO P
)llP Q
;llQ R
varnn 
obj2nn 
=nn 
readernn 
[nn 
$strnn &
]nn& '
;nn' (
ifoo 
(oo 
obj2oo 
!=oo 
DBNulloo 
.oo 
Valueoo $
)oo$ %
notificationMessagepp #
.pp# $
SendAtpp$ *
=pp+ ,
Convertpp- 4
.pp4 5

ToDateTimepp5 ?
(pp? @
obj2pp@ D
)ppD E
.ppE F
ToLocalTimeppF Q
(ppQ R
)ppR S
;ppS T
varrr 
obj3rr 
=rr 
readerrr 
[rr 
$strrr $
]rr$ %
;rr% &
ifss 
(ss 
obj3ss 
!=ss 
DBNullss 
.ss 
Valuess $
)ss$ %
notificationMessagett #
.tt# $
Readtt$ (
=tt) *
Converttt+ 2
.tt2 3

ToDateTimett3 =
(tt= >
obj3tt> B
)ttB C
.ttC D
ToLocalTimettD O
(ttO P
)ttP Q
;ttQ R
varvv 
obj4vv 
=vv 
readervv 
[vv 
$strvv (
]vv( )
;vv) *
ifww 
(ww 
obj4ww 
!=ww 
DBNullww 
.ww 
Valueww $
)ww$ %
notificationMessagexx #
.xx# $
Categoryxx$ ,
=xx- .
newxx/ 2
Urixx3 6
(xx6 7
Convertxx7 >
.xx> ?
ToStringxx? G
(xxG H
obj4xxH L
)xxL M
??xxN P
stringxxQ W
.xxW X
EmptyxxX ]
)xx] ^
;xx^ _
returnzz 
notificationMessagezz &
;zz& '
}{{ 	
}|| 
}}} á
ÖC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Configuration\AdvancedTaskManagerOptions.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Configuration- :
{ 
public 

class &
AdvancedTaskManagerOptions +
{ 
public 
int 
WarningDays 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
$num/ 0
;0 1
public 
int 
PageSize 
{ 
get !
;! "
set# &
;& '
}( )
=* +
$num, .
;. /
public 
bool %
DeleteChangeApprovalTasks -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
=< =
true> B
;B C
public 
bool 1
%DeleteContentApprovalDeadlineProperty 9
{: ;
get< ?
;? @
setA D
;D E
}F G
=H I
falseJ O
;O P
public		 
bool		 .
"AddContentApprovalDeadlineProperty		 6
{		7 8
get		9 <
;		< =
set		> A
;		A B
}		C D
=		E F
false		G L
;		L M
public

 
string

 
DateTimeFormat

 $
{

% &
get

' *
;

* +
set

, /
;

/ 0
}

1 2
=

3 4
$str

5 G
;

G H
public 
string &
DateTimeFormatUserFriendly 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
=? @
$strA [
;[ \
} 
} ”6
ÜC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Configuration\ServiceCollectionExtensions.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Configuration- :
{ 
public 

static 
class '
ServiceCollectionExtensions 3
{ 
private 
static 
readonly 
Action  &
<& '&
AuthorizationPolicyBuilder' A
>A B
DefaultPolicyC P
=Q R
pS T
=>U W
pX Y
.Y Z
RequireRoleZ e
(e f
Rolesf k
.k l
Administratorsl z
,z {
Roles	| Å
.
Å Ç
	WebAdmins
Ç ã
,
ã å
Roles
ç í
.
í ì
	CmsAdmins
ì ú
)
ú ù
;
ù û
public 
static 
IServiceCollection (
AddAdvancedTask) 8
(8 9
this9 =
IServiceCollection> P
servicesQ Y
,Y Z
Action[ a
<a b&
AdvancedTaskManagerOptionsb |
>| }
setupAction	~ â
)
â ä
{ 	
return 
services 
. 
AddAdvancedTask +
(+ ,
setupAction, 7
,7 8
DefaultPolicy9 F
)F G
;G H
} 	
public 
static 
IServiceCollection (
AddAdvancedTask) 8
(8 9
this9 =
IServiceCollection> P
servicesQ Y
,Y Z
Action[ a
<a b&
AdvancedTaskManagerOptionsb |
>| }
setupAction	~ â
,
â ä
Action
ã ë
<
ë í(
AuthorizationPolicyBuilder
í ¨
>
¨ ≠
configurePolicy
Æ Ω
)
Ω æ
{ 	
services 
. 
AddTransient !
<! "
	IUIHelper" +
,+ ,
UIHelper- 5
>5 6
(6 7
)7 8
;8 9
services 
. 
AddTransient !
<! "
IChangeTaskHelper" 3
,3 4
ChangeTaskHelper5 E
>E F
(F G
)G H
;H I
services 
. 
AddTransient !
<! "$
IExpirationChangeDetails" :
,: ;#
ExpirationChangeDetails< S
>S T
(T U
)U V
;V W
services 
. 
AddTransient !
<! "&
ICommandMetaDataRepository" <
,< =,
 DefaultCommandMetaDataRepository> ^
>^ _
(_ `
)` a
;a b
services 
. 
AddTransient !
<! ""
ILanguageChangeDetails" 8
,8 9!
LanguageChangeDetails: O
>O P
(P Q
)Q R
;R S
services 
. 
AddTransient !
<! ""
IApprovalCommandMapper" 8
,8 9!
ApprovalCommandMapper: O
>O P
(P Q
)Q R
;R S
services   
.   
AddTransient   !
<  ! "
IMovingChangeDetail  " 5
,  5 6
MovingChangeDetail  7 I
>  I J
(  J K
)  K L
;  L M
services!! 
.!! 
AddTransient!! !
<!!! "!
ISecurityChangeDetail!!" 7
,!!7 8 
SecurityChangeDetail!!9 M
>!!M N
(!!N O
)!!O P
;!!P Q
services"" 
."" 
AddTransient"" !
<""! "#
IApprovalCommandService""" 9
,""9 :"
ApprovalCommandService""; Q
>""Q R
(""R S
)""S T
;""T U
services## 
.## 
AddTransient## !
<##! "*
IApprovalCommandRepositoryBase##" @
,##@ A)
ApprovalCommandRepositoryBase##B _
>##_ `
(##` a
)##a b
;##b c
services$$ 
.$$ 
AddTransient$$ !
<$$! " 
INotificationHandler$$" 6
,$$6 7
NotificationHandler$$8 K
>$$K L
($$L M
)$$M N
;$$N O
services&& 
.&& 
	Configure&& 
<&& "
ProtectedModuleOptions&& 5
>&&5 6
(&&6 7
pm'' 
=>'' 
{(( 
if)) 
()) 
!)) 
pm)) 
.)) 
Items)) !
.))! "
Any))" %
())% &
i))& '
=>))( *
i))+ ,
.)), -
Name))- 1
.))1 2
Equals))2 8
())8 9
	Constants))9 B
.))B C

ModuleName))C M
,))M N
StringComparison))O _
.))_ `
OrdinalIgnoreCase))` q
)))q r
)))r s
)))s t
{** 
pm++ 
.++ 
Items++  
.++  !
Add++! $
(++$ %
new++% (
(++( )
)++) *
{+++ ,
Name++- 1
=++2 3
	Constants++4 =
.++= >

ModuleName++> H
}++I J
)++J K
;++K L
},, 
}-- 
)-- 
;-- 
var// 
providerOptions// 
=//  !
new//" %&
AdvancedTaskManagerOptions//& @
(//@ A
)//A B
;//B C
setupAction00 
(00 
providerOptions00 '
)00' (
;00( )
services22 
.22 

AddOptions22 
<22  &
AdvancedTaskManagerOptions22  :
>22: ;
(22; <
)22< =
.22= >
	Configure22> G
<22G H
IConfiguration22H V
>22V W
(22W X
(22X Y
options22Y `
,22` a
configuration22b o
)22o p
=>22q s
{33 
setupAction44 
(44 
options44 #
)44# $
;44$ %
configuration55 
.55 

GetSection55 (
(55( )
$str55) >
)55> ?
.55? @
Bind55@ D
(55D E
options55E L
)55L M
;55M N
}66 
)66 
;66 
services88 
.88 
AddAuthorization88 %
(88% &
options88& -
=>88. 0
{99 
options:: 
.:: 
	AddPolicy:: !
(::! "
	Constants::" +
.::+ ,

PolicyName::, 6
,::6 7
configurePolicy::8 G
)::G H
;::H I
};; 
);; 
;;; 
return== 
services== 
;== 
}>> 	
}?? 
}@@ Ÿ
fC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Constants.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
{ 
public 

static 
class 
	Constants !
{ 
public 
const 
string 

ModuleName &
=' (
$str) >
;> ?
public 
const 
string 

PolicyName &
=' (
$str) 8
;8 9
} 
} ô/
{C:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Helpers\ApprovalCommandService.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Helpers- 4
{ 
public 

	interface #
IApprovalCommandService ,
{ 
ApprovalCommandBase 
GetCommandById *
(* +
Guid+ /
	commandId0 9
)9 :
;: ;
ApprovalCommandBase		 "
GetCommandByApprovalId		 2
(		2 3
int		3 6

approvalId		7 A
)		A B
;		B C
}

 
public 

class "
ApprovalCommandService '
:( )#
IApprovalCommandService* A
{ 
private 
readonly &
ICommandMetaDataRepository 3&
_commandMetaDataRepository4 N
;N O
private 
readonly *
IApprovalCommandRepositoryBase 7*
_approvalCommandRepositoryBase8 V
;V W
public "
ApprovalCommandService %
(% &&
ICommandMetaDataRepository& @
cmdRepositoryA N
,N O*
IApprovalCommandRepositoryBaseP n*
approvalCommandRepositoryBase	o å
)
å ç
{ 	&
_commandMetaDataRepository &
=' (
cmdRepository) 6
;6 7*
_approvalCommandRepositoryBase *
=+ ,)
approvalCommandRepositoryBase- J
;J K
} 	
public 
ApprovalCommandBase "
GetCommandById# 1
(1 2
Guid2 6
	commandId7 @
)@ A
{ 	
var 
byCommandId 
= &
_commandMetaDataRepository 8
.8 9
GetByCommandId9 G
(G H
	commandIdH Q
)Q R
;R S
return 
byCommandId 
== !
null" &
?' (
null) -
:. /
GetApprovalCommand0 B
(B C
byCommandIdC N
.N O
TypeO S
,S T
byCommandIdU `
.` a
	CommandIda j
)j k
;k l
} 	
public 
ApprovalCommandBase ""
GetCommandByApprovalId# 9
(9 :
int: =

approvalId> H
)H I
{ 	
var   
byApprovalId   
=   &
_commandMetaDataRepository   9
.  9 :
GetByApprovalId  : I
(  I J

approvalId  J T
)  T U
;  U V
return!! 
byApprovalId!! 
==!!  "
null!!# '
?!!( )
null!!* .
:!!/ 0
GetApprovalCommand!!1 C
(!!C D
byApprovalId!!D P
.!!P Q
Type!!Q U
,!!U V
byApprovalId!!W c
.!!c d
	CommandId!!d m
)!!m n
;!!n o
}"" 	
public%% 
CommandMetaData%% *
GetCommandMetaDataByApprovalId%% =
(%%= >
int%%> A

approvalId%%B L
)%%L M
{&& 	
var'' 
byApprovalId'' 
='' &
_commandMetaDataRepository'' 9
.''9 :
GetByApprovalId'': I
(''I J

approvalId''J T
)''T U
;''U V
return(( 
byApprovalId(( 
;((  
})) 	
private++ 
ApprovalCommandBase++ #
GetApprovalCommand++$ 6
(++6 7
string++7 =
commandTypeName++> M
,++M N
Guid++O S
	commandId++T ]
)++] ^
{,, 	
ApprovalCommandBase-- 
byCommandId--  +
=--, -
null--. 2
;--2 3
if// 
(// 
commandTypeName// 
.//  
EndsWith//  (
(//( )
$str//) ?
)//? @
)//@ A
{00 
byCommandId11 
=11 *
_approvalCommandRepositoryBase11 <
.11< =
GetByCommandId11= K
<11K L 
MovingContentCommand11L `
>11` a
(11a b
	commandId11b k
,11k l
commandTypeName11m |
)11| }
;11} ~
}22 
else33 
if33 
(33 
commandTypeName33 $
.33$ %
EndsWith33% -
(33- .
$str33. L
)33L M
)33M N
{44 
byCommandId55 
=55 *
_approvalCommandRepositoryBase55 <
.55< =
GetByCommandId55= K
<55K L(
ExpirationDateSettingCommand55L h
>55h i
(55i j
	commandId55j s
,55s t
commandTypeName	55u Ñ
)
55Ñ Ö
;
55Ö Ü
}66 
else77 
if77 
(77 
commandTypeName77 $
.77$ %
EndsWith77% -
(77- .
$str77. F
)77F G
)77G H
{88 
byCommandId99 
=99 *
_approvalCommandRepositoryBase99 <
.99< =
GetByCommandId99= K
<99K L"
LanguageSettingCommand99L b
>99b c
(99c d
	commandId99d m
,99m n
commandTypeName99o ~
)99~ 
;	99 Ä
}:: 
else;; 
if;; 
(;; 
commandTypeName;; $
.;;$ %
EndsWith;;% -
(;;- .
$str;;. F
);;F G
);;G H
{<< 
byCommandId== 
=== *
_approvalCommandRepositoryBase== <
.==< =
GetByCommandId=== K
<==K L"
SecuritySettingCommand==L b
>==b c
(==c d
	commandId==d m
,==m n
commandTypeName==o ~
)==~ 
;	== Ä
}>> 
return@@ 
byCommandId@@ 
;@@ 
}AA 	
}CC 
}DD  $
ÇC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Helpers\ChangeApprovalReferenceHelper.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Helpers- 4
{ 
public 

static 
class )
ChangeApprovalReferenceHelper 5
{		 
public

 
static

 
Uri

 
GetUri

  
(

  !
ContentReference

! 1
contentLink

2 =
,

= >
bool

? C
ignoreVersion

D Q
)

Q R
{ 	
if 
( 
ContentReference  
.  !
IsNullOrEmpty! .
(. /
contentLink/ :
): ;
); <
return 
null 
; 
var 
	uriString 
= 
$" 
{ %
ChangeApprovalTypeFactory ,
., -
ChangeApprovalType- ?
}? @
$str@ A
{A B
contentLinkB M
.M N
ProviderNameN Z
??[ ]
$str^ `
}` a
$stra b
{b c
contentLinkc n
.n o
IDo q
}q r
$strr s
"s t
;t u
if 
( 
! 
ignoreVersion 
&& !
contentLink" -
.- .
WorkID. 4
!=5 7
$num8 9
)9 :
	uriString 
= 
	uriString %
+& '
contentLink( 3
.3 4
WorkID4 :
+; <
$str= @
;@ A
return 
new 
Uri 
( 
	uriString $
)$ %
;% &
} 	
public 
static 
ContentReference &
GetContentReference' :
(: ;
Uri; >
key? B
)B C
{ 	
if 
( 
key 
== 
null 
|| 
!  
key  #
.# $
Scheme$ *
.* +
Equals+ 1
(1 2%
ChangeApprovalTypeFactory2 K
.K L
ChangeApprovalTypeL ^
)^ _
)_ `
return 
null 
; 
var 
list 
= 
key 
. 
Segments #
.# $
Select$ *
(* +
x+ ,
=>- /
x0 1
.1 2
Replace2 9
(9 :
$str: =
,= >
$str? A
)A B
)B C
.C D
ToListD J
(J K
)K L
;L M
if 
( 
list 
. 
Count 
< 
$num 
|| !
list" &
.& '
Count' ,
>- .
$num/ 0
)0 1
return 
null 
; 
var 
providerName 
= 
string %
.% &
IsNullOrEmpty& 3
(3 4
list4 8
[8 9
$num9 :
]: ;
); <
?= >
null? C
:D E
listF J
[J K
$numK L
]L M
;M N
if 
( 
! 
int 
. 
TryParse 
( 
list "
[" #
$num# $
]$ %
,% &
out' *
var+ .
result1/ 6
)6 7
)7 8
return 
null 
; 
var 
result2 
= 
$num 
; 
return   
list   
.   
Count   
>   
$num    !
&&  " $
list  % )
[  ) *
$num  * +
]  + ,
!=  - /
string  0 6
.  6 7
Empty  7 <
&&  = ?
!  @ A
int  A D
.  D E
TryParse  E M
(  M N
list  N R
[  R S
$num  S T
]  T U
,  U V
out  W Z
result2  [ b
)  b c
?  d e
null  f j
:  k l
new  m p
ContentReference	  q Å
(
  Å Ç
result1
  Ç â
,
  â ä
result2
  ã í
,
  í ì
providerName
  î †
)
  † °
;
  ° ¢
}!! 	
}"" 
}## õ4
uC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Helpers\ChangeTaskHelper.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Helpers- 4
{ 
public		 

	interface		 
IChangeTaskHelper		 &
{

 
ChangeTaskDetail 
GetData  
(  !
int! $
id% '
)' (
;( )
} 
public 

class 
ChangeTaskHelper !
:" #
IChangeTaskHelper$ 5
{ 
private 
readonly #
IApprovalCommandService 0"
_generalCommandService1 G
;G H
private 
readonly "
IApprovalCommandMapper /"
_approvalCommandMapper0 F
;F G
private 
readonly "
ILanguageChangeDetails /"
_languageChangeDetails0 F
;F G
private 
readonly 
IMovingChangeDetail ,
_movingChangeDetail- @
;@ A
private 
readonly !
ISecurityChangeDetail .!
_securityChangeDetail/ D
;D E
private 
readonly $
IExpirationChangeDetails 1$
_expirationChangeDetails2 J
;J K
public 
ChangeTaskHelper 
(  #
IApprovalCommandService  7!
generalCommandService8 M
,M N"
IApprovalCommandMapperO e!
approvalCommandMapperf {
,{ |#
ILanguageChangeDetails	} ì#
languageChangeDetails
î ©
,
© ™!
IMovingChangeDetail
´ æ 
movingChangeDetail
ø —
,
— “#
ISecurityChangeDetail
” Ë"
securityChangeDetail
È ˝
,
˝ ˛&
IExpirationChangeDetails
ˇ ó%
expirationChangeDetails
ò Ø
)
Ø ∞
{ 	"
_generalCommandService "
=# $!
generalCommandService% :
;: ;"
_approvalCommandMapper "
=# $!
approvalCommandMapper% :
;: ;"
_languageChangeDetails "
=# $!
languageChangeDetails% :
;: ;
_movingChangeDetail 
=  !
movingChangeDetail" 4
;4 5!
_securityChangeDetail !
=" # 
securityChangeDetail$ 8
;8 9$
_expirationChangeDetails $
=% &#
expirationChangeDetails' >
;> ?
} 	
public"" 
ChangeTaskDetail"" 
GetData""  '
(""' (
int""( +
id"", .
)"". /
{## 	
var$$ 
commandByApprovalId$$ #
=$$$ %"
_generalCommandService$$& <
.$$< ="
GetCommandByApprovalId$$= S
($$S T
id$$T V
)$$V W
;$$W X
var%% 
taskDetails%% 
=%% 
commandByApprovalId%% 1
!=%%2 4
null%%5 9
?%%: ;"
_approvalCommandMapper%%< R
.%%R S
Map%%S V
(%%V W
commandByApprovalId%%W j
,%%j k
PrincipalAccessor%%l }
.%%} ~
Current	%%~ Ö
)
%%Ö Ü
:
%%á à
null
%%â ç
;
%%ç é
if&& 
(&& 
taskDetails&& 
!=&& 
null&& #
)&&# $
{'' 
var(( 

customTask(( 
=((  
new((! $
ChangeTaskDetail((% 5
(((5 6
)((6 7
;((7 8
if)) 
()) 
taskDetails)) 
.))  
TypeIdentifier))  .
.)). /
ToLower))/ 6
())6 7
)))7 8
.))8 9
EndsWith))9 A
())A B
$str))B X
)))X Y
)))Y Z
{** 

customTask++ 
.++ 
Type++ #
=++$ %
$str++& 6
;++6 7

customTask,, 
.,, 
Details,, &
=,,' (
_movingChangeDetail,,) <
.,,< ="
GetMovingChangeDetails,,= S
(,,S T
taskDetails,,T _
),,_ `
;,,` a
}-- 
else.. 
if.. 
(.. 
taskDetails.. $
...$ %
TypeIdentifier..% 3
...3 4
ToLower..4 ;
(..; <
)..< =
...= >
EndsWith..> F
(..F G
$str..G e
)..e f
)..f g
{// 

customTask00 
.00 
Type00 #
=00$ %
$str00& ?
;00? @

customTask11 
.11 
Details11 &
=11' ($
_expirationChangeDetails11) A
.11A B-
!GetExpirationCommandChangeDetails11B c
(11c d
taskDetails11d o
)11o p
;11p q
}22 
else33 
if33 
(33 
taskDetails33 $
.33$ %
TypeIdentifier33% 3
.333 4
ToLower334 ;
(33; <
)33< =
.33= >
EndsWith33> F
(33F G
$str33G _
)33_ `
)33` a
{44 

customTask55 
.55 
Type55 #
=55$ %
$str55& 8
;558 9

customTask66 
.66 
Details66 &
=66' ("
_languageChangeDetails66) ?
.66? @$
GetLanguageChangeDetails66@ X
(66X Y
taskDetails66Y d
)66d e
;66e f
}77 
else88 
if88 
(88 
taskDetails88 $
.88$ %
TypeIdentifier88% 3
.883 4
ToLower884 ;
(88; <
)88< =
.88= >
EndsWith88> F
(88F G
$str88G _
)88_ `
)88` a
{99 

customTask:: 
.:: 
Type:: #
=::$ %
$str::& 8
;::8 9

customTask;; 
.;; 
Details;; &
=;;' (!
_securityChangeDetail;;) >
.;;> ?$
GetSecurityChangeDetails;;? W
(;;W X
new;;X [
Guid;;\ `
(;;` a
taskDetails;;a l
.;;l m
Id;;m o
);;o p
);;p q
;;;q r
}<< 

customTask>> 
.>> 
Name>> 
=>>  !
taskDetails>>" -
.>>- .
Name>>. 2
;>>2 3
return@@ 

customTask@@ !
;@@! "
}AA 
returnCC 
nullCC 
;CC 
}DD 	
}FF 
}GG ü#
oC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Helpers\Extensions.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Helpers- 4
{		 
public

 

static

 
class

 

Extensions

 "
{ 
public 
static 
IEnumerable !
<! "
DateTime" *
>* +
GetDaysInRange, :
(: ;
this; ?
DateTime@ H
	startDateI R
,R S
DateTimeT \
endDate] d
)d e
{ 	
if 
( 
endDate 
< 
	startDate #
)# $
return 

Enumerable !
.! "
Empty" '
<' (
DateTime( 0
>0 1
(1 2
)2 3
;3 4
return 

Enumerable 
. 
Range #
(# $
$num$ %
,% &
$num' (
+) *
endDate+ 2
.2 3
Subtract3 ;
(; <
	startDate< E
)E F
.F G
DaysG K
)K L
. 
Select 
( 
offset 
=> !
	startDate" +
.+ ,
AddDays, 3
(3 4
offset4 :
): ;
); <
. 
ToArray 
( 
) 
; 
} 	
public 
static 
int 
CountDaysInRange *
(* +
this+ /
DateTime0 8
	startDate9 B
,B C
DateTimeD L
endDateM T
)T U
{ 	
var 
dates 
= 
	startDate !
.! "
GetDaysInRange" 0
(0 1
endDate1 8
)8 9
;9 :
return 
dates 
. 
Count 
( 
)  
;  !
} 	
public 
static 
T 
ToObject  
<  !
T! "
>" #
(# $
this$ (
string) /
value0 5
)5 6
where7 <
T= >
:? @
classA F
{ 	
if   
(   
string   
.   
IsNullOrEmpty   $
(  $ %
value  % *
)  * +
)  + ,
return!! 
default!! 
;!! 
return"" 
JsonConvert"" 
."" 
DeserializeObject"" 0
<""0 1
T""1 2
>""2 3
(""3 4
value""4 9
,""9 :
new""; >"
JsonSerializerSettings""? U
(""U V
)""V W
{## 
TypeNameHandling$$  
=$$! "
TypeNameHandling$$# 3
.$$3 4
Objects$$4 ;
}%% 
)%% 
;%% 
}&& 	
public(( 
static(( 
string(( 

GetEditUrl(( '
(((' (
this((( ,
ContentReference((- =
contentLink((> I
)((I J
{)) 	
return** 
$"** 
{** "
ModuleResourceResolver** ,
.**, -
Instance**- 5
.**5 6
ResolvePath**6 A
(**A B
$str**B G
,**G H
null**I M
)**M N
}**N O
$str**O o
{**o p
contentLink**p {
}**{ |
"**| }
;**} ~
}++ 	
public-- 
static-- 
string-- 

GetEditUrl-- '
(--' (
this--( ,
ContentReference--- =
contentLink--> I
,--I J
string--K Q
language--R Z
)--Z [
{.. 	
return// 
$"// 
{// "
ModuleResourceResolver// ,
.//, -
Instance//- 5
.//5 6
ResolvePath//6 A
(//A B
$str//B G
,//G H
null//I M
)//M N
.//N O
TrimEnd//O V
(//V W
$char//W Z
)//Z [
}//[ \
$str//\ g
{//g h
language//h p
}//p q
$str	//q ë
{
//ë í
contentLink
//í ù
}
//ù û
"
//û ü
;
//ü †
}00 	
}11 
}22 ≠
yC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Helpers\SettingCommandHelper.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Helpers- 4
{ 
public 

static 
class  
SettingCommandHelper ,
{ 
public 
static 
string 
Fade !
(! "
this" &
string' -
text. 2
)2 3
{ 	
return 
! 
string 
. 
IsNullOrEmpty (
(( )
text) -
)- .
?/ 0
$"1 3
$str3 Z
{Z [
text[ _
}_ `
$str` g
"g h
:i j
$strk m
;m n
} 	
public

 
static

 
string

 
Bold

 !
(

! "
this

" &
string

' -
text

. 2
)

2 3
{ 	
return 
! 
string 
. 
IsNullOrEmpty (
(( )
text) -
)- .
?/ 0
$"1 3
$str3 ;
{; <
text< @
}@ A
$strA J
"J K
:L M
$strN P
;P Q
} 	
public 
static 
string 
Strikethrough *
(* +
this+ /
string0 6
text7 ;
); <
{ 	
return 
! 
string 
. 
IsNullOrEmpty (
(( )
text) -
)- .
?/ 0
$"1 3
$str3 8
{8 9
text9 =
}= >
$str> D
"D E
:F G
$strH J
;J K
} 	
} 
} £/
mC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Helpers\UIHelper.cs
	namespace		 	
AdvancedTaskManager		
 
.		 
Infrastructure		 ,
.		, -
Helpers		- 4
{

 
public 

	interface 
	IUIHelper 
{ 
string !
GetDisplayNameForUser $
($ %
string% +
senderUsername, :
): ;
;; <
bool 
CanUserPublish 
< 
T 
> 
( 
T  
content! (
)( )
where* /
T0 1
:2 3
IContent4 <
;< =
Task 
< 
List 
< 
string 
> 
> 
GetUserRoles '
(' (
)( )
;) *
} 
public 

class 
UIHelper 
: 
	IUIHelper %
{ 
private 
readonly ,
 QueryableNotificationUserService 9-
!_queryableNotificationUserService: [
;[ \
private 
readonly "
SecurityEntityProvider /#
_securityEntityProvider0 G
;G H
public 
UIHelper 
( ,
 QueryableNotificationUserService 8,
 queryableNotificationUserService9 Y
,Y Z"
SecurityEntityProvider[ q#
securityEntityProvider	r à
)
à â
{ 	-
!_queryableNotificationUserService -
=. /,
 queryableNotificationUserService0 P
;P Q#
_securityEntityProvider #
=$ %"
securityEntityProvider& <
;< =
} 	
public 
string !
GetDisplayNameForUser +
(+ ,
string, 2
senderUsername3 A
)A B
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
senderUsername% 3
)3 4
)4 5
return 
null 
; 
var   
result   
=   -
!_queryableNotificationUserService   :
.  : ;
GetAsync  ; C
(  C D
senderUsername  D R
)  R S
.  S T
ConfigureAwait  T b
(  b c
false  c h
)  h i
.  i j

GetAwaiter  j t
(  t u
)  u v
.  v w
	GetResult	  w Ä
(
  Ä Å
)
  Å Ç
;
  Ç É
if"" 
("" 
result"" 
=="" 
null"" 
)"" 
return## 
null## 
;## 
if%% 
(%% 
PrincipalAccessor%% !
.%%! "
Current%%" )
.%%) *
Identity%%* 2
!=%%3 5
null%%6 :
)%%: ;
{&& 
var'' 
name'' 
='' 
PrincipalAccessor'' ,
.'', -
Current''- 4
.''4 5
Identity''5 =
.''= >
Name''> B
;''B C
if(( 
((( 
result(( 
.(( 
UserName(( #
.((# $
Equals(($ *
(((* +
name((+ /
,((/ 0
StringComparison((1 A
.((A B
OrdinalIgnoreCase((B S
)((S T
)((T U
return)) 
$str))  
;))  !
}** 
return,, 
!,, 
string,, 
.,, 
IsNullOrEmpty,, (
(,,( )
result,,) /
.,,/ 0
DisplayName,,0 ;
),,; <
?,,= >
result,,? E
.,,E F
DisplayName,,F Q
:,,R S
result,,T Z
.,,Z [
UserName,,[ c
;,,c d
}-- 	
public// 
async// 
Task// 
<// 
List// 
<// 
string// %
>//% &
>//& '
GetUserRoles//( 4
(//4 5
)//5 6
{00 	
if11 
(11 
PrincipalAccessor11 !
.11! "
Current11" )
.11) *
Identity11* 2
!=113 5
null116 :
)11: ;
{22 
var33 
name33 
=33 
PrincipalAccessor33 ,
.33, -
Current33- 4
.334 5
Identity335 =
.33= >
Name33> B
;33B C
var44 
roles44 
=44 
await44 !#
_securityEntityProvider44" 9
.449 : 
GetRolesForUserAsync44: N
(44N O
name44O S
)44S T
;44T U
return55 
roles55 
.55 
ToList55 #
(55# $
)55$ %
;55% &
}66 
return88 
new88 
List88 
<88 
string88 "
>88" #
(88# $
)88$ %
;88% &
}99 	
public<< 
bool<< 
CanUserPublish<< "
<<<" #
T<<# $
><<$ %
(<<% &
T<<& '
content<<( /
)<</ 0
where<<1 6
T<<7 8
:<<9 :
IContent<<; C
{== 	
if>> 
(>> 
content>> 
is>> 

ISecurable>> %
securedContent>>& 4
)>>4 5
{?? 
var@@ 

descriptor@@ 
=@@  
securedContent@@! /
.@@/ 0!
GetSecurityDescriptor@@0 E
(@@E F
)@@F G
;@@G H
returnBB 

descriptorBB !
.BB! "
	HasAccessBB" +
(BB+ ,
PrincipalAccessorBB, =
.BB= >
CurrentBB> E
,BBE F
AccessLevelBBG R
.BBR S
PublishBBS Z
)BBZ [
;BB[ \
}CC 
returnDD 
falseDD 
;DD 
}EE 	
}FF 
}GG ∫e
ÜC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Initialization\AdvancedTaskInitialization.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Initialization- ;
{ 
[ 
InitializableModule 
] 
[ 
ModuleDependency 
( 
typeof 
( 
	EPiServer &
.& '
Web' *
.* + 
InitializationModule+ ?
)? @
)@ A
]A B
public 

class &
AdvancedTaskInitialization +
:, - 
IInitializableModule. B
{ 
private 
const 
string /
#ContentApprovalDeadlinePropertyName @
=A B
$strC `
;` a
private 
static 
readonly 
object  &
Lock' +
=, -
new. 1
(1 2
)2 3
;3 4
private "
IContentTypeRepository &"
_contentTypeRepository' =
;= >
private $
ITabDefinitionRepository ($
_tabDefinitionRepository) A
;A B
private )
IPropertyDefinitionRepository -)
_propertyDefinitionRepository. K
;K L
private -
!IPropertyDefinitionTypeRepository 1-
!_propertyDefinitionTypeRepository2 S
;S T
public 
void 

Initialize 
(  
InitializationEngine 3
context4 ;
); <
{ 	"
_contentTypeRepository "
=# $
context% ,
., -
Locate- 3
.3 4
Advanced4 <
.< =
GetInstance= H
<H I"
IContentTypeRepositoryI _
>_ `
(` a
)a b
;b c$
_tabDefinitionRepository $
=% &
context' .
.. /
Locate/ 5
.5 6
Advanced6 >
.> ?
GetInstance? J
<J K$
ITabDefinitionRepositoryK c
>c d
(d e
)e f
;f g)
_propertyDefinitionRepository )
=* +
context, 3
.3 4
Locate4 :
.: ;
Advanced; C
.C D
GetInstanceD O
<O P)
IPropertyDefinitionRepositoryP m
>m n
(n o
)o p
;p q-
!_propertyDefinitionTypeRepository -
=. /
context0 7
.7 8
Locate8 >
.> ?
Advanced? G
.G H
GetInstanceH S
<S T-
!IPropertyDefinitionTypeRepositoryT u
>u v
(v w
)w x
;x y
var 
configuration 
= 
context  '
.' (
Locate( .
.. /
Advanced/ 7
.7 8
GetInstance8 C
<C D
IOptionsD L
<L M&
AdvancedTaskManagerOptionsM g
>g h
>h i
(i j
)j k
;k l
var!! 1
%deleteContentApprovalDeadlineProperty!! 5
=!!6 7
configuration!!8 E
.!!E F
Value!!F K
.!!K L1
%DeleteContentApprovalDeadlineProperty!!L q
;!!q r
if"" 
("" 1
%deleteContentApprovalDeadlineProperty"" 5
)""5 6
{## #
DeleteMappingProperties$$ '
($$' (
)$$( )
;$$) *
}%% 
else&& 
{'' 
var(( .
"addContentApprovalDeadlineProperty(( 6
=((7 8
configuration((9 F
.((F G
Value((G L
.((L M.
"AddContentApprovalDeadlineProperty((M o
;((o p"
SetupMappingProperties** &
(**& '.
"addContentApprovalDeadlineProperty**' I
)**I J
;**J K
}++ 
},, 	
private.. 
void.. "
SetupMappingProperties.. +
(..+ ,
bool.., 0.
"addContentApprovalDeadlineProperty..1 S
)..S T
{// 	
foreach00 
(00 
var00 
contentType00 $
in00% '"
_contentTypeRepository00( >
.00> ?
List00? C
(00C D
)00D E
.00E F
Where00F K
(00K L
x00L M
=>00N P
x00Q R
.00R S
IsAvailable00S ^
)00^ _
)00_ `*
CreateUpdatePropertyDefinition11 .
(11. /
contentType22 
,22  /
#ContentApprovalDeadlinePropertyName33 7
,337 8
$str44 R
,44R S
$str55 /
,55/ 0
typeof66 
(66 
PropertyDate66 '
)66' (
,66( )
SystemTabNames77 "
.77" #
Settings77# +
,77+ ,
$num77- 0
,770 1.
"addContentApprovalDeadlineProperty88 6
)886 7
;887 8
}99 	
private;; 
void;; #
DeleteMappingProperties;; ,
(;;, -
);;- .
{<< 	
foreach== 
(== 
var== 
contentType== $
in==% '"
_contentTypeRepository==( >
.==> ?
List==? C
(==C D
)==D E
.==E F
Where==F K
(==K L
x==L M
=>==N P
x==Q R
.==R S
IsAvailable==S ^
)==^ _
)==_ `$
DeletePropertyDefinition>> (
(>>( )
contentType?? 
,??  /
#ContentApprovalDeadlinePropertyName@@ 7
)@@7 8
;@@8 9
}AA 	
privateBB 
voidBB *
CreateUpdatePropertyDefinitionBB 3
(BB3 4
ContentTypeBB4 ?
contentTypeBB@ K
,BBK L
stringBBM S"
propertyDefinitionNameBBT j
,BBj k
stringBBl r

helperTextBBs }
,BB} ~
string	BB Ö
editCaption
BBÜ ë
,
BBë í
Type
BBì ó$
propertyDefinitionType
BBò Æ
,
BBÆ Ø
string
BB∞ ∂
tabName
BB∑ æ
,
BBæ ø
int
BB¿ √
?
BB√ ƒ
propertyOrder
BB≈ “
,
BB“ ”
bool
BB‘ ÿ0
"addContentApprovalDeadlineProperty
BBŸ ˚
)
BB˚ ¸
{CC 	
varDD 
propertyDefinitionDD "
=DD# $!
GetPropertyDefinitionDD% :
(DD: ;
contentTypeDD; F
,DDF G"
propertyDefinitionNameDDH ^
)DD^ _
;DD_ `
ifFF 
(FF 
propertyDefinitionFF "
==FF# %
nullFF& *
)FF* +
{GG 
ifHH 
(HH "
propertyDefinitionTypeHH *
==HH+ -
nullHH. 2
)HH2 3
returnII 
;II 
ifKK 
(KK 
!KK .
"addContentApprovalDeadlinePropertyKK 7
)KK7 8
returnLL 
;LL 
propertyDefinitionNN "
=NN# $
newNN% (
PropertyDefinitionNN) ;
(NN; <
)NN< =
;NN= >
}OO 
elsePP 
{QQ 
propertyDefinitionRR "
=RR# $
propertyDefinitionRR% 7
.RR7 8
CreateWritableCloneRR8 K
(RRK L
)RRL M
;RRM N
}SS 
propertyDefinitionUU 
.UU 
ContentTypeIDUU ,
=UU- .
contentTypeUU/ :
.UU: ;
IDUU; =
;UU= >
propertyDefinitionVV 
.VV 
DisplayEditUIVV ,
=VV- .
trueVV/ 3
;VV3 4
propertyDefinitionWW 
.WW 
DefaultValueTypeWW /
=WW0 1
DefaultValueTypeWW2 B
.WWB C
NoneWWC G
;WWG H
propertyDefinitionYY 
.YY 
DisplayEditUIYY ,
=YY- ..
"addContentApprovalDeadlinePropertyYY/ Q
;YYQ R
if[[ 
([[ 
![[ 
string[[ 
.[[ 
IsNullOrEmpty[[ %
([[% &"
propertyDefinitionName[[& <
)[[< =
)[[= >
propertyDefinition\\ "
.\\" #
Name\\# '
=\\( )"
propertyDefinitionName\\* @
;\\@ A
if^^ 
(^^ 
!^^ 
string^^ 
.^^ 
IsNullOrEmpty^^ %
(^^% &
editCaption^^& 1
)^^1 2
)^^2 3
propertyDefinition__ "
.__" #
EditCaption__# .
=__/ 0
editCaption__1 <
;__< =
ifaa 
(aa 
!aa 
stringaa 
.aa 
IsNullOrEmptyaa %
(aa% &

helperTextaa& 0
)aa0 1
)aa1 2
propertyDefinitionbb "
.bb" #
HelpTextbb# +
=bb, -

helperTextbb. 8
;bb8 9
ifdd 
(dd "
propertyDefinitionTypedd &
!=dd' )
nulldd* .
)dd. /
propertyDefinitionee "
.ee" #
Typeee# '
=ee( )-
!_propertyDefinitionTypeRepositoryee* K
.eeK L
LoadeeL P
(eeP Q"
propertyDefinitionTypeeeQ g
)eeg h
;eeh i
ifgg 
(gg 
!gg 
stringgg 
.gg 
IsNullOrEmptygg %
(gg% &
tabNamegg& -
)gg- .
)gg. /
{hh 
varii 
obj2ii 
=ii 
Lockii 
;ii  
lockjj 
(jj 
obj2jj 
)jj 
{kk 
propertyDefinitionll &
.ll& '
Tabll' *
=ll+ ,$
_tabDefinitionRepositoryll- E
.llE F
LoadllF J
(llJ K
tabNamellK R
)llR S
;llS T
}mm 
}nn 
ifpp 
(pp 
propertyOrderpp 
.pp 
HasValuepp &
)pp& '
propertyDefinitionqq "
.qq" #

FieldOrderqq# -
=qq. /
propertyOrderqq0 =
.qq= >
Valueqq> C
;qqC D)
_propertyDefinitionRepositoryss )
.ss) *
Savess* .
(ss. /
propertyDefinitionss/ A
)ssA B
;ssB C
}tt 	
privatevv 
voidvv $
DeletePropertyDefinitionvv -
(vv- .
ContentTypevv. 9
contentTypevv: E
,vvE F
stringvvG M"
propertyDefinitionNamevvN d
)vvd e
{ww 	
varxx 
propertyDefinitionxx "
=xx# $!
GetPropertyDefinitionxx% :
(xx: ;
contentTypexx; F
,xxF G"
propertyDefinitionNamexxH ^
)xx^ _
;xx_ `
ifzz 
(zz 
propertyDefinitionzz "
!=zz# %
nullzz& *
)zz* +)
_propertyDefinitionRepositoryzz, I
.zzI J
DeletezzJ P
(zzP Q
propertyDefinitionzzQ c
)zzc d
;zzd e
}{{ 	
private}} 
static}} 
PropertyDefinition}} )!
GetPropertyDefinition}}* ?
(}}? @
ContentType}}@ K
contentType}}L W
,}}W X
string}}Y _
propertyName}}` l
,}}l m
Type}}n r#
propertyDefinitionType	}}s â
=
}}ä ã
null
}}å ê
)
}}ê ë
{~~ 	
var 
source 
= 
from 
pd  
in! #
contentType$ /
./ 0
PropertyDefinitions0 C
where
ÄÄ 
pd
ÄÄ !
.
ÄÄ! "
Name
ÄÄ" &
.
ÄÄ& '
Equals
ÄÄ' -
(
ÄÄ- .
propertyName
ÄÄ. :
,
ÄÄ: ;
StringComparison
ÄÄ< L
.
ÄÄL M
OrdinalIgnoreCase
ÄÄM ^
)
ÄÄ^ _
select
ÅÅ 
pd
ÅÅ  "
;
ÅÅ" #
if
ÇÇ 
(
ÇÇ $
propertyDefinitionType
ÇÇ &
!=
ÇÇ' )
null
ÇÇ* .
)
ÇÇ. /
source
ÉÉ 
=
ÉÉ 
from
ÉÉ 
pd
ÉÉ  
in
ÉÉ! #
source
ÉÉ$ *
where
ÑÑ 
pd
ÑÑ !
.
ÑÑ! "
Type
ÑÑ" &
.
ÑÑ& '
DefinitionType
ÑÑ' 5
==
ÑÑ6 8$
propertyDefinitionType
ÑÑ9 O
select
ÖÖ 
pd
ÖÖ  "
;
ÖÖ" #
return
ÜÜ 
source
ÜÜ 
.
ÜÜ 
FirstOrDefault
ÜÜ (
(
ÜÜ( )
)
ÜÜ) *
;
ÜÜ* +
}
áá 	
public
ää 
void
ää 
Uninitialize
ää  
(
ää  !"
InitializationEngine
ää! 5
context
ää6 =
)
ää= >
{
ãã 	
}
çç 	
}
éé 
}èè ¢=
yC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Mapper\ApprovalCommandMapper.cs
	namespace

 	
AdvancedTaskManager


 
.

 
Infrastructure

 ,
.

, -
Mapper

- 3
{ 
public 

	interface "
IApprovalCommandMapper +
{ 
ChangeTaskViewModel 
Map 
(  
ApprovalCommandBase  3
approvalCommand4 C
,C D

IPrincipalE O
	principalP Y
)Y Z
;Z [
} 
public 

class !
ApprovalCommandMapper &
:' ("
IApprovalCommandMapper) ?
{ 
private 
readonly 
ViewModelMapper (
_mapper) 0
=1 2
new3 6
(6 7
)7 8
;8 9
private 
readonly 
IContentRepository +
_contentRepository, >
;> ?
private 
readonly 
	IUIHelper "
	_uiHelper# ,
;, -
public !
ApprovalCommandMapper $
($ %
IContentRepository% 7
contentRepository8 I
,I J
	IUIHelperK T
uiHelperU ]
)] ^
{ 	
_contentRepository 
=  
contentRepository! 2
;2 3
	_uiHelper 
= 
uiHelper  
;  !
_mapper 
. 
Add 
< "
SecuritySettingCommand .
,. /
ChangeTaskViewModel0 C
>C D
(D E
)E F
;F G
_mapper 
. 
Add 
< "
LanguageSettingCommand .
,. /
ChangeTaskViewModel0 C
>C D
(D E
)E F
;F G
_mapper 
. 
Add 
< (
ExpirationDateSettingCommand 4
,4 5
ChangeTaskViewModel6 I
>I J
(J K
)K L
;L M
_mapper 
. 
Add 
<  
MovingContentCommand ,
,, -
ChangeTaskViewModel. A
>A B
(B C
)C D
;D E
} 	
public!! 
ChangeTaskViewModel!! "
Map!!# &
(!!& '
ApprovalCommandBase!!' :
approvalCommand!!; J
,!!J K

IPrincipal!!L V
	principal!!W `
)!!` a
{"" 	
var## 
commandViewModel1## !
=##" #
_mapper##$ +
.##+ ,
Map##, /
(##/ 0
approvalCommand##0 ?
)##? @
as##A C
ChangeTaskViewModel##D W
;##W X
var$$ 
name1$$ 
=$$ 
approvalCommand$$ '
is$$( *+
ICultureSpecificApprovalCommand$$+ J#
specificApprovalCommand$$K b
?$$c d#
specificApprovalCommand$$e |
.$$| }$
AppliedOnLanguageBranch	$$} î
:
$$ï ñ
null
$$ó õ
;
$$õ ú
var%% 
cultureInfo%% 
=%% 
string%% $
.%%$ %
IsNullOrEmpty%%% 2
(%%2 3
name1%%3 8
)%%8 9
?%%: ;
null%%< @
:%%A B
new%%C F
CultureInfo%%G R
(%%R S
name1%%S X
)%%X Y
;%%Y Z
var&& 
commandViewModel2&& !
=&&" #
commandViewModel1&&$ 5
;&&5 6
var'' 
contentRepository'' !
=''" #
_contentRepository''$ 6
;''6 7
var((  
appliedOnContentLink(( $
=((% &
approvalCommand((' 6
.((6 7 
AppliedOnContentLink((7 K
;((K L
var)) 
settings)) 
=)) 
new)) 
LoaderOptions)) ,
{** 
new++  
LanguageLoaderOption++ (
{,, 
Language-- 
=-- 
cultureInfo-- *
,--* +
FallbackBehaviour--, =
=--> ?
LanguageBehaviour--@ Q
.--Q R
FallbackWithMaster--R d
}.. 
}// 
;// 
var11 
name211 
=11 
contentRepository11 )
.11) *
Get11* -
<11- .
IContent11. 6
>116 7
(117 8 
appliedOnContentLink118 L
,11L M
settings11N V
)11V W
?11W X
.11X Y
Name11Y ]
;11] ^
if33 
(33 
commandViewModel233 !
!=33" $
null33% )
)33) *
commandViewModel244 !
.44! "
Name44" &
=44' (
name244) .
;44. /
if66 
(66 
commandViewModel166 !
!=66" $
null66% )
)66) *
{77 
commandViewModel188 !
.88! "
Status88" (
=88) *
(88+ ,
int88, /
)88/ 0
approvalCommand880 ?
.88? @
CommandStatus88@ M
;88M N
commandViewModel199 !
.99! "

CanExecute99" ,
=99- .
approvalCommand99/ >
.99> ?
CommandStatus99? L
==99M O
CommandMetaData99P _
.99_ `$
ChangeTaskApprovalStatus99` x
.99x y
InReview	99y Å
;
99Å Ç
var:: 
fullName:: 
=:: 
approvalCommand:: .
.::. /
GetType::/ 6
(::6 7
)::7 8
.::8 9
FullName::9 A
;::A B
if;; 
(;; 
fullName;; 
!=;; 
null;;  $
);;$ %
commandViewModel1<< %
.<<% &
TypeIdentifier<<& 4
=<<5 6
fullName<<7 ?
.<<? @
ToLower<<@ G
(<<G H
)<<H I
;<<I J
commandViewModel1>> !
.>>! "
Id>>" $
=>>% &
approvalCommand>>' 6
.>>6 7
Id>>7 9
.>>9 :

ExternalId>>: D
.>>D E
ToString>>E M
(>>M N
)>>N O
;>>O P
commandViewModel1?? !
.??! "
IsCommandDataValid??" 4
=??5 6
approvalCommand??7 F
.??F G
IsValid??G N
(??N O
)??O P
;??P Q
commandViewModel1@@ !
.@@! "
	CreatedBy@@" +
=@@, -
	_uiHelper@@. 7
.@@7 8!
GetDisplayNameForUser@@8 M
(@@M N
commandViewModel1@@N _
.@@_ `
	CreatedBy@@` i
)@@i j
;@@j k
commandViewModel1AA !
.AA! "
	ChangedByAA" +
=AA, -
	_uiHelperAA. 7
.AA7 8!
GetDisplayNameForUserAA8 M
(AAM N
commandViewModel1AAN _
.AA_ `
	ChangedByAA` i
)AAi j
;AAj k
ifBB 
(BB 
	principalBB 
.BB 
IdentityBB &
!=BB' )
nullBB* .
)BB. /
commandViewModel1CC %
.CC% &%
CanUserActOnHisOwnChangesCC& ?
=CC@ A
!CCB C
stringCCC I
.CCI J
EqualsCCJ P
(CCP Q
approvalCommandCCQ `
.CC` a
	CreatedByCCa j
,CCj k
	principalCCl u
.CCu v
IdentityCCv ~
.CC~ 
Name	CC É
,
CCÉ Ñ
StringComparison
CCÖ ï
.
CCï ñ
OrdinalIgnoreCase
CCñ ß
)
CCß ®
;
CC® ©
returnDD 
commandViewModel1DD (
;DD( )
}EE 
returnGG 
nullGG 
;GG 
}HH 	
}II 
}JJ  9
sC:\Projects\adnanzameer\AdvancedTaskManager\net6.0\src\AdvancedTaskManager\Infrastructure\Mapper\ViewModelMapper.cs
	namespace 	
AdvancedTaskManager
 
. 
Infrastructure ,
., -
Mapper- 3
{ 
public 

class 
ViewModelMapper  
{ 
private		 
readonly		 
IDictionary		 $
<		$ %
Type		% )
,		) *
Mapping		+ 2
>		2 3
_typeMappings		4 A
=		B C
new		D G

Dictionary		H R
<		R S
Type		S W
,		W X
Mapping		Y `
>		` a
(		a b
)		b c
;		c d
public 
ViewModelMapper 
Add "
<" #
TSource# *
,* +
TModel, 2
>2 3
(3 4
)4 5
where
 
TSource 
: 
class 
where
 
TModel 
: 
class 
, 
new  #
(# $
)$ %
{ 	
return 
Add 
( 
( 
Action 
< 
TSource &
,& '
TModel( .
>. /
)/ 0
null0 4
)4 5
;5 6
} 	
private 
ViewModelMapper 
Add  #
<# $
TSource$ +
,+ ,
TModel- 3
>3 4
(4 5
Action5 ;
<; <
TSource< C
,C D
TModelE K
>K L
afterMapActionM [
)[ \
where] b
TSourcec j
:k l
classm r
wheres x
TModely 
:
Ä Å
class
Ç á
,
á à
new
â å
(
å ç
)
ç é
{ 	
_typeMappings 
. 
Add 
( 
typeof $
($ %
TSource% ,
), -
,- .
new/ 2
Mapping3 :
<: ;
TSource; B
,B C
TModelD J
>J K
(K L
)L M
{ 
AfterMapAction 
=  
afterMapAction! /
} 
) 
; 
return 
this 
; 
} 	
public 
object 
Map 
< 
TSource !
>! "
(" #
TSource# *
source+ 1
)1 2
{ 	
var 
type 
= 
source 
. 
GetType %
(% &
)& '
;' (
var 
mapping 
= 

GetMapping $
($ %
type% )
)) *
;* +
if 
( 
mapping 
== 
null 
)  
return   
null   
;   
var"" 
instance"" 
="" 
mapping"" "
.""" #
CreateInstance""# 1
(""1 2
)""2 3
;""3 4
var## 

dictionary## 
=## 
instance## %
.##% &
GetType##& -
(##- .
)##. /
.##/ 0
GetProperties##0 =
(##= >
)##> ?
.##? @
ToDictionary##@ L
(##L M
p##M N
=>##O Q
p##R S
.##S T
Name##T X
,##X Y
StringComparer##Z h
.##h i
OrdinalIgnoreCase##i z
)##z {
;##{ |
foreach$$ 
($$ 
var$$ 
property$$ !
in$$" $
type$$% )
.$$) *
GetProperties$$* 7
($$7 8
)$$8 9
)$$9 :
if%% 
(%% 

dictionary%% 
.%% 
TryGetValue%% *
(%%* +
property%%+ 3
.%%3 4
Name%%4 8
,%%8 9
out%%: =
var%%> A
propertyInfo%%B N
)%%N O
&&%%P R
propertyInfo%%S _
.%%_ `
CanWrite%%` h
&&%%i k
property%%l t
.%%t u
PropertyType	%%u Å
==
%%Ç Ñ
propertyInfo
%%Ö ë
.
%%ë í
PropertyType
%%í û
)
%%û ü
propertyInfo&&  
.&&  !
SetValue&&! )
(&&) *
instance&&* 2
,&&2 3
property&&4 <
.&&< =
GetValue&&= E
(&&E F
source&&F L
)&&L M
)&&M N
;&&N O
mapping'' 
.'' %
ExecuteAfterMappingAction'' -
(''- .
source''. 4
,''4 5
instance''6 >
)''> ?
;''? @
return(( 
instance(( 
;(( 
})) 	
private++ 
Mapping++ 

GetMapping++ "
(++" #
Type++# '

sourceType++( 2
)++2 3
{,, 	
return-- 
!-- 
_typeMappings-- !
.--! "
TryGetValue--" -
(--- .

sourceType--. 8
,--8 9
out--: =
var--> A
mapping--B I
)--I J
?--K L
null--M Q
:--R S
mapping--T [
;--[ \
}.. 	
private00 
abstract00 
class00 
Mapping00 &
{11 	
public22 
abstract22 
object22 "
CreateInstance22# 1
(221 2
)222 3
;223 4
public44 
abstract44 
void44  %
ExecuteAfterMappingAction44! :
(44: ;
object44; A
source44B H
,44H I
object44J P
model44Q V
)44V W
;44W X
}55 	
private77 
class77 
Mapping77 
<77 
TSource77 %
,77% &
TModel77' -
>77- .
:77/ 0
Mapping771 8
where88
 
TSource88 
:88 
class88 
where99
 
TModel99 
:99 
class99 
,99 
new99  #
(99# $
)99$ %
{:: 	
public;; 
Action;; 
<;; 
TSource;; !
,;;! "
TModel;;# )
>;;) *
AfterMapAction;;+ 9
{;;: ;
get;;< ?
;;;? @
set;;A D
;;;D E
};;F G
public== 
override== 
object== "
CreateInstance==# 1
(==1 2
)==2 3
{>> 
return?? 
new?? 
TModel?? !
(??! "
)??" #
;??# $
}@@ 
publicBB 
overrideBB 
voidBB  %
ExecuteAfterMappingActionBB! :
(BB: ;
objectBB; A
sourceBBB H
,BBH I
objectBBJ P
modelBBQ V
)BBV W
{CC 
AfterMapActionDD 
?DD 
.DD  
InvokeDD  &
(DD& '
(DD' (
TSourceDD( /
)DD/ 0
sourceDD0 6
,DD6 7
(DD8 9
TModelDD9 ?
)DD? @
modelDD@ E
)DDE F
;DDF G
}EE 
}FF 	
}GG 
}HH 